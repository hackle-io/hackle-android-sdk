!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Hackle={})}(this,(function(t){"use strict";var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},e(t,r)};function r(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},n.apply(this,arguments)};function i(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}u((n=n.apply(t,e||[])).next())}))}function o(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(i=s.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){s.label=o[1];break}if(6===o[0]&&s.label<i[1]){s.label=i[1],i=o;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(o);break}i[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function s(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}var a=function(){function t(){}return t.isNotNullOrUndefined=function(t){return null!=t},t.isNullOrUndefined=function(t){return null==t},t.requiredNotNullOrUndefined=function(t,e){if(void 0===e&&(e=function(){return"Required value is null or undefined"}),this.isNullOrUndefined(t))throw new Error(e());return t},t.fromMap=function(t){var e={};return t.forEach((function(t,r){e[r]=t})),e},t}(),u=function(){function t(){}return t.mapNotNullOrUndefined=function(t,e){for(var r=Array(),n=0,i=t;n<i.length;n++){var o=e(i[n]);a.isNotNullOrUndefined(o)&&r.push(o)}return r},t.associateTo=function(t,e,r){for(var n=0,i=t;n<i.length;n++){var o=r(i[n]);e.set(o[0],o[1])}return e},t.associate=function(t,e){return this.associateTo(t,new Map,e)},t.associateBy=function(t,e){return this.associate(t,(function(t){return[e(t),t]}))},t.chunked=function(t,e){for(var r=[],n=t.slice();n.length;)r.push(n.splice(0,e));return r},t}(),c={DISABLE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},f=function(){function t(){}return t.setLogLevel=function(t){void 0===t&&(t=c.INFO),this.logLevel=t},t.initCounter=function(t){this.counters=u.associate(Object.keys(c),(function(e){return[e,t(e)]}))},t._log=function(t,e){var r;switch(t){case"WARN":r="orange";break;case"ERROR":r="red";break;default:r="#AAAAAA"}if(e instanceof Error)p.log(t,r,e.message,e);else try{p.log(t,r,e)}catch(t){}},t.increment=function(e){var r,n;null===(n=null===(r=t.counters)||void 0===r?void 0:r.get(e))||void 0===n||n.increment()},t.logLevel=c.INFO,t.log={error:function(e){t.logLevel>=c.ERROR&&(t._log("ERROR",e),t.increment("ERROR"))},warn:function(e){t.logLevel>=c.WARN&&(t._log("WARN",e),t.increment("WARN"))},info:function(e){t.logLevel>=c.INFO&&(t._log("INFO",e),t.increment("INFO"))},debug:function(e){t.logLevel>=c.DEBUG&&(t._log("DEBUG",e),t.increment("DEBUG"))}},t}(),p=function(){function t(){}return t.log=function(t,e,r,n){try{console.log("%c[".concat(t,"] Hackle: ").concat(r),"color: ".concat(e))}catch(t){}},t}(),l="X-HACKLE-SDK-KEY",h="X-HACKLE-SDK-NAME",d="X-HACKLE-SDK-VERSION",v="X-HACKLE-SDK-TIME",y=3e3,m=[0,8,16,32,64,128,256,512],g="_hackle_hid",E="_hackle_id",w="_hackle_session_id",T="_hackle_last_event_ts",N="_hackle_uid",O="_hackle_did",I=f.log;function _(t,e){for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])}var b={getRequest:function(t,e){return{abort:function(){},responsePromise:new Promise((function(r,n){var i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){if(i.readyState===i.DONE){if(0===i.status)return void n(new Error("Request error"));r({statusCode:i.status,body:i.responseText})}},i.onerror=function(){n()},i.setRequestHeader("content-type","application/json"),_(i,e),i.send()}))}},postRequest:function(t,e,r,n,i){var o=JSON.stringify(e),s=new XMLHttpRequest;s.open("POST",t),s.onreadystatechange=function(){s.readyState===s.DONE&&(s.status>=200&&s.status<400?n({statusCode:s.status}):i&&i({statusCode:s.status}))},s.setRequestHeader("content-type","application/json"),_(s,r),s.send(o)},sendBeacon:function(t,e,r,n,i){var o=!1;if("undefined"!=typeof window&&(o=window&&window.navigator&&window.navigator.sendBeacon&&!0),o){var s=JSON.stringify(e),a=new URLSearchParams;if(a.append("sdkName",r[h]),a.append("sdkVersion",r[d]),a.append("sdkKey",r[l]),a.append("data",s),!window.navigator.sendBeacon(t,a))return I.error("sendBeacon failed to queue request."),void i();n()}else I.error("Does not support sendBeacon"),i()}},A=f.log,R=function(){function t(){}return t.isEquals=function(t,e){if(null==e)return!1;var r=Object.keys(t);return r.length===Object.keys(e).length&&r.every((function(r){return t[r]===e[r]}))},t.sanitize=function(t){var e={};if(a.isNullOrUndefined(t))return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(this.isValidType(o)){var u=this.sanitizeValue(s);a.isNullOrUndefined(u)?A.debug("Invalid identifier value. The identifier type value be a string of 512 characters or less. [".concat(o,"]")):e[o]=u}else A.debug("Invalid identifier type. The identifier type must be a string of 128 characters or less. [".concat(o,"]"))}return e},t.isValidType=function(t){return!a.isNullOrUndefined(t)&&("string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_TYPE_LENGTH)},t.sanitizeValue=function(t){return"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_VALUE_LENGTH?t:"number"==typeof t?t.toString():null},t.MAX_IDENTIFIER_TYPE_LENGTH=128,t.MAX_IDENTIFIER_VALUE_LENGTH=512,t}(),S=f.log,M=function(){function t(){}return t.sanitize=function(t){var e={};if(a.isNullOrUndefined(t))return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(Object.keys(e).length>=this.MAX_PROPERTIES_COUNT){S.debug("The number of properties cannot exceed 128. Drops excess properties. [".concat(o,", ").concat(s,"]"));break}if(this.isValidKey(o)){var u=this.sanitizeValue(o,s);a.isNullOrUndefined(u)?S.debug("Invalid property value. The property value mus be 'string(..1024)', 'number', 'boolean', or 'array' type. [".concat(s,"]")):e[o]=u}else S.debug("Invalid property key. The property key must be a string of 128 characters or less. [".concat(o,"]"))}return e},t.isValidProperty=function(t,e){return this.isValidKey(t)&&this.isValidValue(e)},t.isValidKey=function(t){return a.isNotNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_PROPERTY_KEY_LENGTH},t.sanitizeValue=function(t,e){var r=this;return"string"==typeof t&&t.startsWith(this.SYSTEM_PROPERTY_KEY_PREFIX)?e:this.isValidValue(e)?Array.isArray(e)?e.filter((function(t){return r.isValidElement(t)})):e:null},t.isValidValue=function(t){return!a.isNullOrUndefined(t)&&("string"==typeof t?t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t?!isNaN(t)&&isFinite(t):"boolean"==typeof t||Array.isArray(t))},t.isValidElement=function(t){return!a.isNullOrUndefined(t)&&("string"==typeof t?t.length>0&&t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t)},t.SYSTEM_PROPERTY_KEY_PREFIX="$",t.MAX_PROPERTIES_COUNT=128,t.MAX_PROPERTY_KEY_LENGTH=128,t.MAX_PROPERTY_VALUE_LENGTH=1024,t}(),C=f.log;function x(t,e){var r=t.find((function(t){return t===e}));return r||C.debug("Unsupported type [".concat(e,"]. Please use the latest version of sdk.")),r}var k=function(){function t(t,e){this.value=t,this.reason=e}return t.of=function(e,r){return new t(e,r)},t}(),U=function(t,e){this.value=t,this.reason=e},P=function(){function t(t,e,r){this.variation=t,this.reason=e,this.config=r}return t.of=function(e,r,n){return void 0===n&&(n=new F),new t(e,r,n)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),D=function(){function t(t,e,r){this.isOn=t,this.reason=e,this.config=r}return t.on=function(e,r){return void 0===r&&(r=new F),new t(!0,e,r)},t.off=function(e,r){return void 0===r&&(r=new F),new t(!1,e,r)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),L=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),F=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),V=function(){function t(){}return t.SDK_NOT_READY="SDK_NOT_READY",t.EXCEPTION="EXCEPTION",t.INVALID_INPUT="INVALID_INPUT",t.EXPERIMENT_NOT_FOUND="EXPERIMENT_NOT_FOUND",t.EXPERIMENT_DRAFT="EXPERIMENT_DRAFT",t.EXPERIMENT_PAUSED="EXPERIMENT_PAUSED",t.EXPERIMENT_COMPLETED="EXPERIMENT_COMPLETED",t.OVERRIDDEN="OVERRIDDEN",t.TRAFFIC_NOT_ALLOCATED="TRAFFIC_NOT_ALLOCATED",t.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT="NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT",t.IDENTIFIER_NOT_FOUND="IDENTIFIER_NOT_FOUND",t.VARIATION_DROPPED="VARIATION_DROPPED",t.TRAFFIC_ALLOCATED="TRAFFIC_ALLOCATED",t.TRAFFIC_ALLOCATED_BY_TARGETING="TRAFFIC_ALLOCATED_BY_TARGETING",t.NOT_IN_EXPERIMENT_TARGET="NOT_IN_EXPERIMENT_TARGET",t.FEATURE_FLAG_NOT_FOUND="FEATURE_FLAG_NOT_FOUND",t.FEATURE_FLAG_INACTIVE="FEATURE_FLAG_INACTIVE",t.INDIVIDUAL_TARGET_MATCH="INDIVIDUAL_TARGET_MATCH",t.TARGET_RULE_MATCH="TARGET_RULE_MATCH",t.DEFAULT_RULE="DEFAULT_RULE",t.REMOTE_CONFIG_PARAMETER_NOT_FOUND="REMOTE_CONFIG_PARAMETER_NOT_FOUND",t.IN_APP_MESSAGE_NOT_FOUND="IN_APP_MESSAGE_NOT_FOUND",t.TYPE_MISMATCH="TYPE_MISMATCH",t}(),j=function(){function t(t,e,r,n,i,o,s,a,u,c,f,p,l,h){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.status=i,this.version=o,this.variations=s,this.userOverrides=a,this.segmentOverrides=u,this.targetAudiences=c,this.targetRules=f,this.defaultRule=p,this.containerId=l,this._winnerVariationId=h}return t.fromJSON=function(e,r){var n=t.experimentStatusOrNull(r.execution.status),i=r.variations.map((function(t){return new G(t.id,t.key,"DROPPED"===t.status,t.parameterConfigurationId)})),o=u.associate(r.execution.userOverrides,(function(t){return[t.userId,t.variationId]})),s=u.mapNotNullOrUndefined(r.execution.segmentOverrides,(function(t){return Z.fromJSON(t,mt.IDENTIFIER)})),a=u.mapNotNullOrUndefined(r.execution.targetAudiences,(function(t){return J.fromJSON(t,mt.PROPERTY)})),c=u.mapNotNullOrUndefined(r.execution.targetRules,(function(t){return Z.fromJSON(t,mt.PROPERTY)})),f=Q.fromJSON(r.execution.defaultRule);return n&&f&&new t(r.id,r.key,e,r.identifierType,n,r.version,i,o,s,a,c,f,r.containerId,r.winnerVariationId)},t.experimentStatusOrNull=function(t){switch(t){case"READY":return"DRAFT";case"RUNNING":return"RUNNING";case"PAUSED":return"PAUSED";case"STOPPED":return"COMPLETED";default:return void C.debug("Unsupported status [".concat(t,"]"))}},t.prototype._winnerVariationOrNull=function(){if(this._winnerVariationId)return this._getVariationByIdOrNull(this._winnerVariationId)},t.prototype._getVariationByIdOrNull=function(t){return this.variations.find((function(e){return e.id===t}))},t.prototype._getVariationByKeyOrNull=function(t){return this.variations.find((function(e){return e.key===t}))},t}(),G=function(t,e,r,n){this.id=t,this.key=e,this.isDropped=r,this.parameterConfigurationId=n},H=function(){function t(t,e,r){this.seed=t,this.slotSize=e,this.slots=r}return t.fromJSON=function(e){return new t(e.seed,e.slotSize,e.slots.map((function(t){var e=t.startInclusive,r=t.endExclusive,n=t.variationId;return new B(e,r,n)})))},t}(),B=function(){function t(t,e,r){this.startInclusive=t,this.endExclusive=e,this.variationId=r}return t.prototype.contains=function(t){return this.startInclusive<=t&&t<this.endExclusive},t}(),K=function(t,e){this.id=t,this.key=e},z=function(){function t(){}return t.ID="$id",t.USER="$userId",t.DEVICE="$deviceId",t.SESSION="$sessionId",t.HACKLE_DEVICE="$hackleDeviceId",t}(),q=function(){function t(){this.identifiers={}}return t.prototype.addIdentifiers=function(t){for(var e in t)this.add(e,t[e]);return this},t.prototype.add=function(t,e){var r=R.sanitizeValue(e);return R.isValidType(t)&&r?this.identifiers[t]=e:C.warn("Invalid user identifier [type=".concat(t,", value=").concat(e,"]")),this},t.prototype.build=function(){return this.identifiers},t}(),Y=function(t){var e,r,n,i={};return i.id=null!==(e=R.sanitizeValue(t.id))&&void 0!==e?e:void 0,i.userId=null!==(r=R.sanitizeValue(t.userId))&&void 0!==r?r:void 0,i.deviceId=null!==(n=R.sanitizeValue(t.deviceId))&&void 0!==n?n:void 0,"object"==typeof t.properties&&(i.properties=M.sanitize(t.properties)),"object"==typeof t.identifiers&&(i.identifiers=R.sanitize(t.identifiers)),function(t){return Boolean(t.id||t.userId||t.deviceId||t.identifiers&&Object.keys(t.identifiers).length>0)}(i)?i:null},J=function(){function t(t){this.conditions=t}return t.fromJSON=function(e,r){return new t(u.mapNotNullOrUndefined(e.conditions,(function(t){return X.fromJSON(t,r)})))},t.prototype.toJSON=function(){return{conditions:this.conditions.map((function(t){return t.toJSON()}))}},t}(),X=function(){function t(t,e){this.key=t,this.match=e}return t.fromJSON=function(e,r){var n=W.fromJSON(e.key);if(n&&r.supports(n.type)){var i=$.fromJSON(e.match);return i&&new t(n,i)}},t.prototype.toJSON=function(){return{key:this.key.toJSON(),match:this.match.toJSON()}},t}(),W=function(){function t(t,e){this.type=t,this.name=e}return t.fromJSON=function(e){var r=x(vt,e.type);return r&&new t(r,e.name)},t.prototype.toJSON=function(){return{type:this.type,name:this.name}},t}(),$=function(){function t(t,e,r,n){this.type=t,this.operator=e,this.valueType=r,this.values=n}return t.fromJSON=function(e){var r=x(pt,e.type),n=x(ht,e.operator),i=x(lt,e.valueType);return r&&n&&i&&new t(r,n,i,e.values)},t.prototype.toJSON=function(){return{operator:this.operator,type:this.type,valueType:this.valueType,values:this.values}},t}(),Q=function(){function t(t,e,r){this.type=t,this.variationId=e,this.bucketId=r}return t.fromJSON=function(e){var r=x(dt,e.type);return r&&new t(r,e.variationId,e.bucketId)},t}(),Z=function(){function t(t,e){this.target=t,this.action=e}return t.fromJSON=function(e,r){var n=J.fromJSON(e.target,r),i=Q.fromJSON(e.action);return n&&i&&new t(n,i)},t}(),tt=function(){function t(t,e,r,n){this.id=t,this.key=e,this.type=r,this.targets=n}return t.fromJSON=function(e){var r=x(yt,e.type);return r&&new t(e.id,e.key,r,u.mapNotNullOrUndefined(e.targets,(function(t){return J.fromJSON(t,mt.SEGMENT)})))},t}(),et=function(){function t(t,e,r){this.id=t,this.bucketId=e,this.groups=r}return t.fromJSON=function(e){return new t(e.id,e.bucketId,e.groups.map((function(t){return rt.fromJSON(t)})))},t.prototype.getGroupOrNull=function(t){return this.groups.find((function(e){return e.id===t}))},t}(),rt=function(){function t(t,e){this.id=t,this.experiments=e}return t.fromJSON=function(e){return new t(e.id,e.experiments)},t}(),nt=function(){function t(t,e){this.id=t,this.parameters=e}return t.fromJSON=function(e){return new t(e.id,u.associate(e.parameters,(function(t){return[t.key,t.value]})))},t.prototype.get=function(t,e){var r=this.parameters.get(t);return a.isNullOrUndefined(r)?e:a.isNullOrUndefined(e)||typeof r==typeof e?r:e},t}(),it=function(){function t(t,e,r,n,i,o){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.targetRules=i,this.defaultValue=o}return t.fromJSON=function(e){var r=x(lt,e.type),n=u.mapNotNullOrUndefined(e.targetRules,(function(t){return ot.fromJSON(t,mt.PROPERTY)})),i=st.fromJSON(e.defaultValue);return r&&new t(e.id,e.key,r,e.identifierType,n,i)},t}(),ot=function(){function t(t,e,r,n,i){this.key=t,this.name=e,this.target=r,this.bucketId=n,this.value=i}return t.fromJSON=function(e,r){var n=J.fromJSON(e.target,r);return n&&new t(e.key,e.name,n,e.bucketId,st.fromJSON(e.value))},t}(),st=function(){function t(t,e){this.id=t,this.rawValue=e}return t.fromJSON=function(e){return new t(e.id,e.value)},t}();function at(t,e){return t-e}var ut=function(){function t(t,e,r){this.coreVersion=t,this.prerelease=e,this.build=r}return t.tryParse=function(e){var r=t.regExp.exec(e);if(r){r[0];var n=r[1],i=r[2],o=void 0===i?"0":i,s=r[3],a=void 0===s?"0":s,u=r[4],c=r[5];return new t(new ct(parseInt(n,10),parseInt(o,10),parseInt(a,10)),ft.parse(u),ft.parse(c))}},t.prototype.compareTo=function(t){return this.coreVersion.compareTo(t.coreVersion)||this.prerelease.compareTo(t.prerelease)},t.prototype.isEqualTo=function(t){return 0===this.compareTo(t)},t.prototype.isGreaterThan=function(t){return this.compareTo(t)>0},t.prototype.isGreaterThanOrEqualTo=function(t){return this.compareTo(t)>=0},t.prototype.isLessThan=function(t){return this.compareTo(t)<0},t.prototype.isLessThanOrEqualTo=function(t){return this.compareTo(t)<=0},t.regExp=/^(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?(?:\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,t}(),ct=function(){function t(t,e,r){this.major=t,this.minor=e,this.patch=r}return t.prototype.compareTo=function(t){return at(this.major,t.major)||at(this.minor,t.minor)||at(this.patch,t.patch)},t}(),ft=function(){function t(t){this.identifiers=t}return t.parse=function(e){return e?new t(e.split(".")):t.EMPTY},t.prototype.isEmpty=function(){return 0===this.identifiers.length},t.prototype.isNotEmpty=function(){return!this.isEmpty()},t.prototype.compareTo=function(t){return this.isEmpty()&&t.isEmpty()?0:this.isEmpty()&&t.isNotEmpty()?1:this.isNotEmpty()&&t.isEmpty()?-1:this.compareIdentifiers(t)},t.prototype.compareIdentifiers=function(e){for(var r=Math.min(this.identifiers.length,e.identifiers.length),n=0;n<r;n++){var i=t.compareIdentifiers(this.identifiers[n],e.identifiers[n]);if(0!==i)return i}return at(this.identifiers.length,e.identifiers.length)},t.compareIdentifiers=function(e,r){return t.numericIdentifierRegExp.test(e)&&t.numericIdentifierRegExp.test(r)?at(+e,+r):e===r?0:e<r?-1:1},t.EMPTY=new t([]),t.numericIdentifierRegExp=/^(0|[1-9]\d*)$/,t}(),pt=["MATCH","NOT_MATCH"],lt=["STRING","NUMBER","BOOLEAN","VERSION","JSON","NULL","UNKNOWN"],ht=["IN","CONTAINS","STARTS_WITH","ENDS_WITH","GT","GTE","LT","LTE"],dt=["VARIATION","BUCKET"],vt=["USER_ID","USER_PROPERTY","HACKLE_PROPERTY","SEGMENT","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY"],yt=["USER_ID","USER_PROPERTY"],mt=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.supportedKeyTypes=t}return t.prototype.supports=function(t){return this.supportedKeyTypes.includes(t)},t.IDENTIFIER=new t("SEGMENT"),t.PROPERTY=new t("SEGMENT","USER_PROPERTY","HACKLE_PROPERTY","AB_TEST","FEATURE_FLAG"),t.SEGMENT=new t("USER_ID","USER_PROPERTY","HACKLE_PROPERTY"),t.IAM=new t("EVENT_PROPERTY","USER_PROPERTY","HACKLE_PROPERTY"),t}(),gt=function(){function t(t,e,r){this.timeUnit=t,this.startDateTime=e,this.endDateTime=r}return t.fromJSON=function(e){return new t(e.timeUnit,null===e.startEpochTime?e.startEpochTime:1e3*e.startEpochTime,null===e.endEpochTime?e.endEpochTime:1e3*e.endEpochTime)},t.prototype.within=function(t){return"IMMEDIATE"===this.timeUnit||(null===this.startDateTime?null===this.endDateTime||t<=this.endDateTime:null===this.endDateTime?this.startDateTime<=t:this.startDateTime<=t&&t<=this.endDateTime)},t.prototype.toJSON=function(){return{timeUnit:this.timeUnit,startEpochTime:null===this.startDateTime?this.startDateTime:this.startDateTime/1e3,endEpochTime:null===this.endDateTime?this.endDateTime:this.endDateTime/1e3}},t}(),Et=function(){function t(t,e,r){void 0===r&&(r=0),this.eventKey=t,this.targets=e,this.priority=r}return t.fromJSON=function(e){return new t(e.eventKey,u.mapNotNullOrUndefined(e.targets,(function(t){return J.fromJSON(t,mt.IAM)})),e.priority)},t.prototype.toJSON=function(){return{eventKey:this.eventKey,targets:this.targets.map((function(t){return t.toJSON()})),priority:this.priority}},t}(),wt=function(){function t(t,e){this.identifierType=t,this.identifiers=e}return t.fromJSON=function(e){return new t(e.identifierType,e.identifiers)},t.prototype.toTarget=function(){return new J([new X(new W("USER_ID",this.identifierType),new $("MATCH","IN","STRING",this.identifiers))])},t.prototype.toJSON=function(){return{identifierType:this.identifierType,identifiers:this.identifiers}},t}(),Tt=function(){function t(t,e){this.targets=t,this.overrides=e}return t.fromJSON=function(e){return new t(u.mapNotNullOrUndefined(e.targets,(function(t){return J.fromJSON(t,mt.PROPERTY)})),u.mapNotNullOrUndefined(e.overrides,(function(t){return wt.fromJSON(t)})))},t.prototype.toJSON=function(){return{targets:this.targets.map((function(t){return t.toJSON()})),overrides:this.overrides.map((function(t){return t.toJSON()}))}},t}(),Nt=function(){function t(t,e,r,n){this.defaultLang=t,this.messages=e,this.platformTypes=r,this.exposure=n}return t.fromJSON=function(e){return new t(e.defaultLang,e.messages,e.platformTypes,e.exposure)},t.prototype.getDefaultMessage=function(){var t=this;return this.messages.find((function(e){return e.lang===t.defaultLang}))||this.messages[0]},t.prototype.supportsWeb=function(){return this.platformTypes.includes("WEB")},t.prototype.getMessageForLang=function(t){return this.messages.find((function(e){return e.lang===t}))},t.prototype.toJSON=function(){return{defaultLang:this.defaultLang,messages:this.messages,platformTypes:this.platformTypes,exposure:this.exposure}},t}(),Ot=function(){function t(t,e,r,n,i,o){this.key=t,this.status=e,this.dateRange=r,this.eventTriggerRules=n,this.targetContext=i,this.messageContext=o}return t.fromJSON=function(e){return new t(e.key,e.status,gt.fromJSON(e),e.eventTriggerRules.map((function(t){return Et.fromJSON(t)})),Tt.fromJSON(e.targetContext),Nt.fromJSON(e.messageContext))},t.prototype.isActive=function(){return"ACTIVE"===this.status},t.prototype.supportsWeb=function(){return this.messageContext.supportsWeb()},t.prototype.toJSON=function(){return n(n({key:this.key,status:this.status},this.dateRange.toJSON()),{eventTriggerRules:this.eventTriggerRules.map((function(t){return t.toJSON()})),targetContext:this.targetContext.toJSON(),messageContext:this.messageContext.toJSON()})},t}(),It=function(){function t(){}return t.nanosToUnit=function(e,r){switch(r){case"microseconds":return e/(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C0);case"seconds":return e/(t.C3/t.C0);default:return e}},t.microsToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C1);case"seconds":return e/(t.C3/t.C1);default:return e}},t.millisToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C2/t.C0);case"microseconds":return e*(t.C2/t.C1);case"seconds":return e/(t.C3/t.C2);default:return e}},t.secondsToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C3/t.C0);case"microseconds":return e*(t.C3/t.C1);case"milliseconds":return e*(t.C3/t.C2);default:return e}},t.C0=1,t.C1=1e3*t.C0,t.C2=1e3*t.C1,t.C3=1e3*t.C2,t.converter={nanoseconds:t.nanosToUnit,microseconds:t.microsToUnit,milliseconds:t.millisToUnit,seconds:t.secondsToUnit},t}(),_t=function(){function t(){}return t.prototype.tick=function(){return 1e3*Date.now()},t.prototype.currentMillis=function(){return Date.now()},t.instance=new t,t}(),bt=function(){function t(t){this.name=t,this._tags={},this.name=t}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e._tags[r]=n})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerTimer({name:this.name,tags:this._tags,type:"TIMER"})},t}(),At=function(){function t(t){this._clock=t,this.startTime=this._clock.tick()}return t.start=function(e){return void 0===e&&(e=t.defaultClock),new t(e)},t.prototype.stop=function(t){var e=this._clock.tick()-this.startTime;t.record(e,"microseconds")},t.defaultClock=new _t,t}();var Rt=function(){function t(t){this.name=t,this._tags={}}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e._tags[r]=n})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerCounter({name:this.name,tags:this._tags,type:"COUNTER"})},t}();var St=function(){function t(t,e){this.valueSupplier=e,this.field=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.valueSupplier()},enumerable:!1,configurable:!0}),t}();function Mt(t,e){return t.name===e.name&&R.isEquals(t.tags,e.tags)}var Ct,xt=function(){function t(t){this.counterValue=0,this.id=t}return t.prototype.count=function(){return this.counterValue},t.prototype.increment=function(t){this.counterValue+=null!=t?t:1},t.prototype.measure=function(){return[new St("count",this.count.bind(this))]},t}(),kt=function(){function t(t){this.id=t,this.currentCounter=new xt(t)}return t.prototype.flush=function(){var t=this.currentCounter;return this.currentCounter=new xt(this.id),t},t.prototype.count=function(){return this.currentCounter.count()},t.prototype.increment=function(t){this.currentCounter.increment(t)},t.prototype.measure=function(){return[new St("count",this.count.bind(this))]},t}(),Ut=new Uint8Array(16);function Pt(){if(!Ct&&!(Ct="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ct(Ut)}var Dt=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Lt(t){return"string"==typeof t&&Dt.test(t)}for(var Ft=[],Vt=0;Vt<256;++Vt)Ft.push((Vt+256).toString(16).substr(1));function jt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(Ft[t[e+0]]+Ft[t[e+1]]+Ft[t[e+2]]+Ft[t[e+3]]+"-"+Ft[t[e+4]]+Ft[t[e+5]]+"-"+Ft[t[e+6]]+Ft[t[e+7]]+"-"+Ft[t[e+8]]+Ft[t[e+9]]+"-"+Ft[t[e+10]]+Ft[t[e+11]]+Ft[t[e+12]]+Ft[t[e+13]]+Ft[t[e+14]]+Ft[t[e+15]]).toLowerCase();if(!Lt(r))throw TypeError("Stringified UUID is invalid");return r}function Gt(t,e,r){function n(t,n,i,o){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}(t)),"string"==typeof n&&(n=function(t){if(!Lt(t))throw TypeError("Invalid UUID");var e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=255&e,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=255&e,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=255&e,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=255&e,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=255&e,r}(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+t.length);if(s.set(n),s.set(t,n.length),(s=r(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,i){o=o||0;for(var a=0;a<16;++a)i[o+a]=s[a];return i}return jt(s)}try{n.name=t}catch(t){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function Ht(t){return 14+(t+64>>>9<<4)+1}function Bt(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function Kt(t,e,r,n,i,o){return Bt((s=Bt(Bt(e,t),Bt(n,o)))<<(a=i)|s>>>32-a,r);var s,a}function zt(t,e,r,n,i,o,s){return Kt(e&r|~e&n,t,e,i,o,s)}function qt(t,e,r,n,i,o,s){return Kt(e&n|r&~n,t,e,i,o,s)}function Yt(t,e,r,n,i,o,s){return Kt(e^r^n,t,e,i,o,s)}function Jt(t,e,r,n,i,o,s){return Kt(r^(e|~n),t,e,i,o,s)}function Xt(t,e,r){var n=(t=t||{}).random||(t.rng||Pt)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return jt(n)}function Wt(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:case 3:return e^r^n;case 2:return e&r^e&n^r&n}}function $t(t,e){return t<<e|t>>>32-e}Gt("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return function(t){for(var e=[],r=32*t.length,n="0123456789abcdef",i=0;i<r;i+=8){var o=t[i>>5]>>>i%32&255,s=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);e.push(s)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[Ht(e)-1]=e;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var a=r,u=n,c=i,f=o;r=zt(r,n,i,o,t[s],7,-680876936),o=zt(o,r,n,i,t[s+1],12,-389564586),i=zt(i,o,r,n,t[s+2],17,606105819),n=zt(n,i,o,r,t[s+3],22,-1044525330),r=zt(r,n,i,o,t[s+4],7,-176418897),o=zt(o,r,n,i,t[s+5],12,1200080426),i=zt(i,o,r,n,t[s+6],17,-1473231341),n=zt(n,i,o,r,t[s+7],22,-45705983),r=zt(r,n,i,o,t[s+8],7,1770035416),o=zt(o,r,n,i,t[s+9],12,-1958414417),i=zt(i,o,r,n,t[s+10],17,-42063),n=zt(n,i,o,r,t[s+11],22,-1990404162),r=zt(r,n,i,o,t[s+12],7,1804603682),o=zt(o,r,n,i,t[s+13],12,-40341101),i=zt(i,o,r,n,t[s+14],17,-1502002290),r=qt(r,n=zt(n,i,o,r,t[s+15],22,1236535329),i,o,t[s+1],5,-165796510),o=qt(o,r,n,i,t[s+6],9,-1069501632),i=qt(i,o,r,n,t[s+11],14,643717713),n=qt(n,i,o,r,t[s],20,-373897302),r=qt(r,n,i,o,t[s+5],5,-701558691),o=qt(o,r,n,i,t[s+10],9,38016083),i=qt(i,o,r,n,t[s+15],14,-660478335),n=qt(n,i,o,r,t[s+4],20,-405537848),r=qt(r,n,i,o,t[s+9],5,568446438),o=qt(o,r,n,i,t[s+14],9,-1019803690),i=qt(i,o,r,n,t[s+3],14,-187363961),n=qt(n,i,o,r,t[s+8],20,1163531501),r=qt(r,n,i,o,t[s+13],5,-1444681467),o=qt(o,r,n,i,t[s+2],9,-51403784),i=qt(i,o,r,n,t[s+7],14,1735328473),r=Yt(r,n=qt(n,i,o,r,t[s+12],20,-1926607734),i,o,t[s+5],4,-378558),o=Yt(o,r,n,i,t[s+8],11,-2022574463),i=Yt(i,o,r,n,t[s+11],16,1839030562),n=Yt(n,i,o,r,t[s+14],23,-35309556),r=Yt(r,n,i,o,t[s+1],4,-1530992060),o=Yt(o,r,n,i,t[s+4],11,1272893353),i=Yt(i,o,r,n,t[s+7],16,-155497632),n=Yt(n,i,o,r,t[s+10],23,-1094730640),r=Yt(r,n,i,o,t[s+13],4,681279174),o=Yt(o,r,n,i,t[s],11,-358537222),i=Yt(i,o,r,n,t[s+3],16,-722521979),n=Yt(n,i,o,r,t[s+6],23,76029189),r=Yt(r,n,i,o,t[s+9],4,-640364487),o=Yt(o,r,n,i,t[s+12],11,-421815835),i=Yt(i,o,r,n,t[s+15],16,530742520),r=Jt(r,n=Yt(n,i,o,r,t[s+2],23,-995338651),i,o,t[s],6,-198630844),o=Jt(o,r,n,i,t[s+7],10,1126891415),i=Jt(i,o,r,n,t[s+14],15,-1416354905),n=Jt(n,i,o,r,t[s+5],21,-57434055),r=Jt(r,n,i,o,t[s+12],6,1700485571),o=Jt(o,r,n,i,t[s+3],10,-1894986606),i=Jt(i,o,r,n,t[s+10],15,-1051523),n=Jt(n,i,o,r,t[s+1],21,-2054922799),r=Jt(r,n,i,o,t[s+8],6,1873313359),o=Jt(o,r,n,i,t[s+15],10,-30611744),i=Jt(i,o,r,n,t[s+6],15,-1560198380),n=Jt(n,i,o,r,t[s+13],21,1309151649),r=Jt(r,n,i,o,t[s+4],6,-145523070),o=Jt(o,r,n,i,t[s+11],10,-1120210379),i=Jt(i,o,r,n,t[s+2],15,718787259),n=Jt(n,i,o,r,t[s+9],21,-343485551),r=Bt(r,a),n=Bt(n,u),i=Bt(i,c),o=Bt(o,f)}return[r,n,i,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,r=new Uint32Array(Ht(e)),n=0;n<e;n+=8)r[n>>5]|=(255&t[n/8])<<n%32;return r}(t),8*t.length))})),Gt("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var n=unescape(encodeURIComponent(t));t=[];for(var i=0;i<n.length;++i)t.push(n.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),a=new Array(s),u=0;u<s;++u){for(var c=new Uint32Array(16),f=0;f<16;++f)c[f]=t[64*u+4*f]<<24|t[64*u+4*f+1]<<16|t[64*u+4*f+2]<<8|t[64*u+4*f+3];a[u]=c}a[s-1][14]=8*(t.length-1)/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=8*(t.length-1)&4294967295;for(var p=0;p<s;++p){for(var l=new Uint32Array(80),h=0;h<16;++h)l[h]=a[p][h];for(var d=16;d<80;++d)l[d]=$t(l[d-3]^l[d-8]^l[d-14]^l[d-16],1);for(var v=r[0],y=r[1],m=r[2],g=r[3],E=r[4],w=0;w<80;++w){var T=Math.floor(w/20),N=$t(v,5)+Wt(T,y,m,g)+E+e[T]+l[w]>>>0;E=g,g=m,m=$t(y,30)>>>0,y=v,v=N}r[0]=r[0]+v>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+m>>>0,r[3]=r[3]+g>>>0,r[4]=r[4]+E>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}));var Qt=function(){function t(t){this.compareFn=t,this.data=new Map,this.compareFn=t,this.data=new Map}return t.prototype.values=function(){return Array.from(this.data.values())},t.prototype.keys=function(){return Array.from(this.data.keys())},t.prototype.get=function(t){var e=this,r=this.keys().find((function(r){return e.compareFn(r,t)}));return r?this.data.get(r):void 0},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.add=function(t,e){var r=e;return r||(r=t),this.data.set(t,r),this},t.prototype.delete=function(t){if(this.has(t)){var e=this.get(t);return this.data.delete(t),e}},t.prototype.forEach=function(t){this.data.forEach(t)},t.prototype.entries=function(){return Array.from(this.data.entries())},t}(),Zt=function(){function t(){this.id=Xt(),this.name="MetricRegistry",this._metrics=new Qt(Mt)}return Object.defineProperty(t.prototype,"metrics",{get:function(){return Array.from(this._metrics.values())},enumerable:!1,configurable:!0}),t.prototype.registerCounter=function(t){return this.registerMetricIfNecessary(t,this.createCounter.bind(this))},t.prototype.registerTimer=function(t){return this.registerMetricIfNecessary(t,this.createTimer.bind(this))},t.prototype.counter=function(t,e){return void 0===e&&(e={}),new Rt(t).tags(e).register(this)},t.prototype.timer=function(t,e){return void 0===e&&(e={}),new bt(t).tags(e).register(this)},t.prototype.registerMetricIfNecessary=function(t,e){return this.getOrCreateMetric(t,e)},t.prototype.getOrCreateMetric=function(t,e){var r,n=this._metrics.get(t);return n?r=n:(r=e(t),this._metrics.add(t,r)),r},t.prototype.close=function(){},t}(),te=function(t){function e(e){var r=t.call(this)||this;return r.pushIntervalMillis=e,r.currentIntervalId=void 0,r.pushIntervalMillis=e,r}return r(e,t),e.prototype.start=function(){var t=this;void 0===this.currentIntervalId&&(this.currentIntervalId=setInterval((function(){t.publish()}),this.pushIntervalMillis),f.log.debug("PushMetricRegistry started. Publish metrics every ".concat(this.pushIntervalMillis,"ms.")))},e.prototype.stop=function(){void 0!==this.currentIntervalId&&(clearInterval(this.currentIntervalId),this.currentIntervalId=void 0,this.publish(),f.log.debug("PushMetricRegistry stopped."))},e.prototype.close=function(){this.stop()},e}(Zt);var ee=function(){function t(t){this._count=0,this._total=0,this._max=0,this.id=t}return t.prototype.count=function(){return this._count},t.prototype.totalTime=function(t){return It.nanosToUnit(this._total,t)},t.prototype.max=function(t){return It.nanosToUnit(this._max,t)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.record=function(t,e){if(!(t<0)){var r=It.converter[e](t,"nanoseconds");this._count=this.count()+1,this._total+=r,this._max=Math.max(r,this._max)}},t.prototype.measure=function(){var t=this;return[new St("count",this.count.bind(this)),new St("total",(function(){return t.totalTime("milliseconds")})),new St("max",(function(){return t.max("milliseconds")})),new St("mean",(function(){return t.mean("milliseconds")}))]},t}(),re=function(){function t(t){this.id=t,this.currentTimer=new ee(t)}return t.prototype.flush=function(){var t=this.currentTimer;return this.currentTimer=new ee(this.id),t},t.prototype.count=function(){return this.currentTimer.count()},t.prototype.totalTime=function(t){return this.currentTimer.totalTime(t)},t.prototype.max=function(t){return this.currentTimer.max(t)},t.prototype.record=function(t,e){this.currentTimer.record(t,e)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.measure=function(){var t=this;return[new St("count",this.count.bind(this)),new St("total",(function(){return t.totalTime("milliseconds")})),new St("max",(function(){return t.max("milliseconds")})),new St("mean",(function(){return t.mean("milliseconds")}))]},t}(),ne=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.createCounter=function(t){return new kt(t)},e.prototype.createTimer=function(t){return new re(t)},e.prototype.publish=function(){var t=this.metrics.reduce((function(t,e){return function(t){return void 0!==t.flush&&"function"==typeof t.flush}(e)?t.concat(e.flush()):t}),[]);this.flushMetrics(t)},e.prototype.close=function(){t.prototype.close.call(this)},e}(te),ie=function(){function t(t){this.id=t}return t.prototype.count=function(){return 0},t.prototype.increment=function(t){},t.prototype.measure=function(){return[new St("count",this.count.bind(this))]},t}(),oe=function(){function t(t){this._counters=new Qt((function(t,e){return t.id===e.id})),this.id=t,this.noopCounter=new ie(t)}return Object.defineProperty(t.prototype,"counters",{get:function(){return Array.from(this._counters.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._counters.add(t,t.registerCounter(this.id))},t.prototype.count=function(){return(this.counters[0]||this.noopCounter).count()},t.prototype.increment=function(t){this.counters.forEach((function(e){e.increment(t)}))},t.prototype.measure=function(){return[new St("count",this.count.bind(this))]},t}();var se,ae=function(){function t(t){this.id=t}return t.prototype.measure=function(){var t=this;return[new St("count",this.count.bind(this)),new St("total",(function(){return t.totalTime("milliseconds")})),new St("max",(function(){return t.max("milliseconds")})),new St("mean",(function(){return t.mean("milliseconds")}))]},t.prototype.count=function(){return 0},t.prototype.totalTime=function(t){return 0},t.prototype.max=function(t){return 0},t.prototype.mean=function(t){return 0},t.prototype.record=function(t,e){},t}(),ue=function(){function t(t){this._timers=new Qt((function(t,e){return t.id===e.id})),this.id=t,this.noopTimer=new ae(t)}return Object.defineProperty(t.prototype,"firstTimer",{get:function(){return this.timers[0]||this.noopTimer},enumerable:!1,configurable:!0}),t.prototype.totalTime=function(t){return this.firstTimer.totalTime(t)},t.prototype.max=function(t){return this.firstTimer.max(t)},t.prototype.mean=function(t){return this.firstTimer.mean(t)},t.prototype.record=function(t,e){this.timers.forEach((function(r){r.record(t,e)}))},Object.defineProperty(t.prototype,"timers",{get:function(){return Array.from(this._timers.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._timers.add(t,t.registerTimer(this.id))},t.prototype.count=function(){return this.firstTimer.count()},t.prototype.measure=function(){var t=this;return[new St("count",this.count.bind(this)),new St("total",(function(){return t.totalTime("milliseconds")})),new St("max",(function(){return t.max("milliseconds")})),new St("mean",(function(){return t.mean("milliseconds")}))]},t}(),ce=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registries=new Qt((function(t,e){return t.id===e.id})),e}return r(e,t),e.prototype.createCounter=function(t){var e=new oe(t);return this.addRegistry(e),e},e.prototype.createTimer=function(t){var e=new ue(t);return this.addRegistry(e),e},e.prototype.addRegistry=function(t){this.registries.forEach((function(e){return t.add(e)}))},e.prototype.add=function(t){t instanceof e||this.registries.has(t)||(this.registries.add(t),this.metrics.forEach((function(e){(function(t){return void 0!==t.add&&"function"==typeof t.add})(e)&&e.add(t)})))},e.prototype.close=function(){this.registries.forEach((function(t){t.close()}))},e}(Zt),fe=function(){function t(){}return t.counter=function(e,r){return t.globalRegistry.counter(e,r)},t.timer=function(e,r){return t.globalRegistry.timer(e,r)},t.addRegistry=function(e){t.globalRegistry.add(e),f.log.debug("MetricRegistry added ".concat(e.name))},t.globalRegistry=new ce,t}(),pe=function(t){function e(e,r,n,i,o){var s=t.call(this,r)||this;return s.monitoringBaseUrl=e,s.httpClient=n,s.httpHeader=i,s.useBeacon=o,s.monitoringEndPoint="".concat(s.monitoringBaseUrl,"/metrics"),s.shouldUseBeacon=!1,s.start(),s.monitoringBaseUrl=e,s}return r(e,t),e.prototype.flushMetrics=function(t){var e=this;u.chunked(t.filter(this.isDispatchTarget.bind(this)),100).forEach((function(t){e.dispatch(t)}))},e.prototype.isDispatchTarget=function(t){return!(!function(t){return"COUNTER"===t.id.type}(t)&&!function(t){return"TIMER"===t.id.type}(t))&&t.count()>0},e.prototype.dispatch=function(t){this.useBeacon&&this.shouldUseBeacon?this.httpClient.sendBeacon(this.monitoringEndPoint,this.batch(t),this.httpHeader,(function(){f.log.debug("Beacon called.")})):this.httpClient.postRequest(this.monitoringEndPoint,this.batch(t),this.httpHeader,(function(){}),(function(){f.log.debug("Failed to flushing metrics.")}))},e.prototype.batch=function(t){return{metrics:t.map((function(t){return{name:t.id.name,type:t.id.type,tags:t.id.tags,measurements:a.fromMap(u.associate(t.measure(),(function(t){return[t.field,t.value]})))}}))}},e.prototype.createCounter=function(t){return new kt(t)},e.prototype.createTimer=function(t){return new re(t)},e.prototype.close=function(){this.shouldUseBeacon=!0,t.prototype.close.call(this)},e}(ne),le=function(){function t(){}return t.experiment=function(t,e,r){var n=fe.timer("experiment.decision",{key:String(e),variation:r.variation,reason:String(r.reason)});t.stop(n)},t.featureFlag=function(t,e,r){var n=fe.timer("feature.flag.decision",{key:String(e),on:String(r.isOn),reason:String(r.reason)});t.stop(n)},t.remoteConfig=function(t,e,r){var n=fe.timer("remote.config.decision",{key:String(e),reason:String(r.reason)});t.stop(n)},t}(),he=function(){function t(){}return t.record=function(t,e,r){var n=fe.timer("api.call",{operation:t,success:String(r)});e.stop(n)},t}(),de=function(){function t(){}return t.decide=function(t,e,r,n){if(a.isNullOrUndefined(r))return this.decision(t,e,"NULL",r,n);switch(typeof r){case"string":return this.decision(t,e,"STRING",r,n);case"number":return this.decision(t,e,"NUMBER",r,n);case"boolean":return this.decision(t,e,"BOOLEAN",r,n);default:return this.decision(t,e,"UNKNOWN",r,n)}},t.decision=function(t,e,r,n,i){return a.isNullOrUndefined(e)?k.of(n,V.INVALID_INPUT):t.remoteConfig(e,i,r,n)},t}(),ve=f.log,ye=function(){function t(t,e,r,n){this.core=t,this.userManager=e,this.hackleUserResolver=r,this.user=n}return t.prototype.get=function(t,e){var r,n=At.start();try{r=this.decide(t,e)}catch(n){ve.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(n)),r=k.of(e,V.EXCEPTION)}return le.remoteConfig(n,t,r),r.value},t.prototype.decide=function(t,e){var r=this.userManager.resolveCurrentOrNull(this.user);if(!r)return ve.warn("invalid user"),k.of(e,V.INVALID_INPUT);var n=this.hackleUserResolver.resolve(r);return de.decide(this.core,t,e,n)},t}(),me=function(){function t(){this._properties=new Map,this.MAX_PROPERTIES_COUNT=128,this.MAX_PROPERTY_KEY_LENGTH=128}return t.prototype.contains=function(t){return this._properties.has(t)},t.prototype.remove=function(t){var e=this;return t instanceof Map&&t.forEach((function(t,r){e.remove(r)})),"string"==typeof t&&this._properties.delete(t),this},t.prototype.compute=function(t,e){var r=this._properties.get(t),n=e(r);null!==n?this.add(t,n):(null!==r||this.contains(t))&&this.remove(t)},t.prototype.add=function(t,e,r){if(void 0===r&&(r=!1),r&&this.contains(t))return this;if(this._properties.size>=this.MAX_PROPERTIES_COUNT)return this;if("string"==typeof t&&t.length>this.MAX_PROPERTY_KEY_LENGTH)return this;var n=M.sanitizeValue(t,e);return n?(this._properties.set(t,n),this):this},t.prototype.addProperties=function(t,e){var r=this;return void 0===e&&(e=!1),t.forEach((function(t,n){r.add(n,t,e)})),this},t.prototype.build=function(){return this._properties},t}();!function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.UNSET="$unset",t.INCREMENT="$increment",t.APPEND="$append",t.APPEND_ONCE="$appendOnce",t.PREPEND="$prepend",t.PREPEND_ONCE="$prependOnce",t.REMOVE="$remove",t.CLEAR_ALL="$clearAll"}(se||(se={}));var ge=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new me).addProperties(t).addProperties(e).build()},t}(),Ee=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new me).addProperties(t).addProperties(e,!0).build()},t}(),we=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?new Map:0===e.size?t:(new me).addProperties(t).remove(e).build()},t}(),Te=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new me;return n.addProperties(t),e.forEach((function(t,e){n.compute(e,(function(e){return r.increment(e,t)}))})),n.build()},t.prototype.increment=function(t,e){return"number"!=typeof e?t:"number"!=typeof t?null==t?e:t:t+e},t}(),Ne=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new me;return n.addProperties(t),e.forEach((function(t,e){n.compute(e,(function(e){return r.compute(e,t)}))})),n.build()},t.prototype.compute=function(t,e){var r=this.toArray(t),n=this.toArray(e);return this.operateArray(r,n)},t.prototype.toArray=function(t){return null==t?[]:Array.isArray(t)?t:[t]},t.prototype.contains=function(t,e){return t.includes(e)},t.prototype.prepend=function(t,e,r){return void 0===r&&(r=!1),r&&this.contains(e,t)?e:s([t],e,!0)},t.prototype.append=function(t,e,r){return void 0===r&&(r=!1),r&&this.contains(t,e)?t:s(s([],t,!0),[e],!1)},t}(),Oe=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduce((function(t,e){return r.append.bind(r)(t,e)}),t)},e}(Ne),Ie=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.appendOnce.bind(this),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e}(Ne),_e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduceRight((function(t,e){return r.prepend.bind(r)(e,t)}),t)},e}(Ne),be=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.operateArray=function(t,e){var r=this;return e.reduce(this.appendOnce.bind(this),[]).reduceRight((function(t,e){return r.prependOnce.bind(r)(e,t)}),t)},e.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},e.prototype.prependOnce=function(t,e){return this.prepend(t,e,!0)},e}(Ne),Ae=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.operateArray=function(t,e){return e.reduce(this.remove.bind(this),t)},e.prototype.remove=function(t,e){return t.filter((function(t){return t!==e}))},e}(Ne),Re=function(){function t(){}return t.prototype.operate=function(t,e){return new Map},t}(),Se=function(){function t(){}return t.get=function(t){switch(t){case se.SET:return new ge;case se.SET_ONCE:return new Ee;case se.UNSET:return new we;case se.INCREMENT:return new Te;case se.APPEND:return new Oe;case se.APPEND_ONCE:return new Ie;case se.PREPEND:return new _e;case se.PREPEND_ONCE:return new be;case se.CLEAR_ALL:return new Re;case se.REMOVE:return new Ae}},t}(),Me=function(){function t(){this.operations=new Map}return t.prototype.set=function(t,e){return this.add(se.SET,t,e)},t.prototype.setOnce=function(t,e){return this.add(se.SET_ONCE,t,e)},t.prototype.unset=function(t){return this.add(se.UNSET,t,"-")},t.prototype.increment=function(t,e){return this.add(se.INCREMENT,t,e)},t.prototype.append=function(t,e){return this.add(se.APPEND,t,e)},t.prototype.appendOnce=function(t,e){return this.add(se.APPEND_ONCE,t,e)},t.prototype.prepend=function(t,e){return this.add(se.PREPEND,t,e)},t.prototype.prependOnce=function(t,e){return this.add(se.PREPEND_ONCE,t,e)},t.prototype.remove=function(t,e){return this.add(se.REMOVE,t,e)},t.prototype.clearAll=function(){return this.add(se.CLEAR_ALL,"clearAll","-")},t.prototype.build=function(){var t=Array.from(this.operations.entries()).map((function(t){return[t[0],t[1].build()]}));return new Ce(new Map(t))},t.prototype.containsKey=function(t){return Array.from(this.operations.entries()).some((function(e){return e[0],e[1].contains(t)}))},t.prototype.add=function(t,e,r){if(this.containsKey(e))return this;this.operations.has(t)||this.operations.set(t,new me);var n=this.operations.get(t);return null==n||n.add(e,r),this},t}(),Ce=function(){function t(t){this.operations=null!=t?t:new Map}return t.prototype.operate=function(t){var e=t;return this.operations.forEach((function(t,r){e=Se.get(r).operate(e,t)})),e},t.prototype.toEvent=function(){var t={key:"$properties"};return this.operations.forEach((function(e,r){var i,o;t.properties=n(n({},t.properties),((i={})[r]=n(n({},null===(o=t.properties)||void 0===o?void 0:o[r]),M.sanitize(a.fromMap(e))),i))})),t},t}(),xe=f.log,ke=function(){function t(t,e,r,n,i){this.core=t,this.hackleUserResolver=e,this.sessionManager=r,this.userManager=n,this.devTools=i}return t.prototype.getSessionId=function(){return this.sessionManager.sessionId},t.prototype.getUser=function(){return this.userManager.currentUser},t.prototype.setUser=function(t){try{var e=Y(t);if(!e)return void xe.warn("invalid user");this.userManager.setUser(e)}catch(t){xe.error("Unexpected exception while set user: ".concat(t))}},t.prototype.setUserId=function(t){try{void 0===t&&this.userManager.setUserId(void 0);var e=R.sanitizeValue(t);if(!e)return void xe.warn("Invalid userId. [userId=".concat(t,"]"));this.userManager.setUserId(e)}catch(t){xe.error("Unexpected exception while set userId: ".concat(t))}},t.prototype.setDeviceId=function(t){try{if(!R.sanitizeValue(t))return void xe.warn("Invalid deviceId. [deviceId=".concat(t,"]"));this.userManager.setDeviceId(t)}catch(t){xe.error("Unexpected exception while set deviceId: ".concat(t))}},t.prototype.setUserProperty=function(t,e){var r=(new Me).set(t,e).build();this.updateUserProperties(r)},t.prototype.setUserProperties=function(t){try{var e=M.sanitize(t),r=new Me;Object.entries(e).forEach((function(t){var e=t[0],n=t[1];r.set(e,n)})),this.updateUserProperties(r.build())}catch(t){xe.error("Unexpected exception while set userProperties: ".concat(t))}},t.prototype.updateUserProperties=function(t){try{var e=t.toEvent();this.track(e),this.userManager.updateUserProperties(t)}catch(t){xe.error("Unexpected exception while update userProperties: ".concat(t))}},t.prototype.resetUser=function(){try{this.userManager.resetUser();var t=(new Me).clearAll().build();this.track(t.toEvent())}catch(t){xe.error("Unexpected exception while reset user: ".concat(t))}},t.prototype.variation=function(t,e,r){return this.variationDetail(t,e,r).variation},t.prototype.variationDetail=function(t,e,r){var n=r||"A",i=At.start(),o=function(r){try{var i=r.userManager.resolveCurrentOrNull(e);if(!i)return xe.warn("invalid user"),P.of(n,V.INVALID_INPUT);var o=r.hackleUserResolver.resolve(i);return r.core.experiment(t,o,n)}catch(e){return xe.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(n,"] : ").concat(e)),P.of(n,V.EXCEPTION)}}(this);return le.experiment(i,t,o),o},t.prototype.isFeatureOn=function(t,e){return this.featureFlagDetail(t,e).isOn},t.prototype.featureFlagDetail=function(t,e){var r=At.start(),n=function(r){try{var n=r.userManager.resolveCurrentOrNull(e);if(!n)return xe.warn("invalid user"),D.off(V.INVALID_INPUT);var i=r.hackleUserResolver.resolve(n);return r.core.featureFlag(t,i)}catch(e){return xe.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),D.off(V.EXCEPTION)}}(this);return le.featureFlag(r,t,n),n},t.prototype.track=function(t,e){try{xe.debug("track event : ".concat(JSON.stringify(t)));var r=this._convertEvent(t),n=this.userManager.resolveCurrentOrNull(e);if(!n)return void xe.warn("invalid user");var i=this.hackleUserResolver.resolve(n);this.core.track(r,i)}catch(t){xe.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(t){xe.debug("tracking page view");var e=this.hackleUserResolver.resolve(this.userManager.currentUser);this.core.track({key:"$page_view"},e)},t.prototype.remoteConfig=function(t){return new ye(this.core,this.userManager,this.hackleUserResolver,t)},t.prototype.onReady=function(t,e){void 0===e&&(e=y),this.core.onReady(t,e)},t.prototype.onInitialized=function(t){return this.core.onInitialized({timeout:null==t?void 0:t.timeout})},t.prototype.close=function(){xe.debug("Hackle Client is closing"),this.core.close()},t.prototype._convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.showUserExplorer=function(){var t;(null===(t=this.devTools)||void 0===t?void 0:t.userExplorer)?(xe.debug("UserExplorer opened."),fe.counter("user.explorer.show",{}).increment(),this.devTools.manager.userExplorer(this.devTools.userExplorer)):xe.error("UserExplorer is not provided")},t.prototype.hideUserExplorer=function(){this.devTools?this.devTools.manager.close():xe.warn("There is no active HackleDevtools.")},t}(),Ue=function(){function t(t,e,r){void 0===r&&(r=Xt()),this.timestamp=t,this.user=e,this.insertId=r}return t.exposure=function(t,e,r,n){return new Pe(n,t,e.experiment,e.variationId,e.variationKey,e.reason,r)},t.track=function(t,e,r,n){return new De(n,r,t,e)},t.remoteConfig=function(t,e,r,n){return new Le(n,t,e.parameter,e.valueId,e.reason,r)},t.isExposure=function(t){return void 0!==t.experiment},t.isTrack=function(t){return void 0!==t.eventType},t.isRemoteConfig=function(t){return void 0!==t.parameter},t.isExposureDto=function(t){return"experimentId"in t&&void 0!==t.experimentId},t.isTrackDto=function(t){return"eventTypeId"in t&&void 0!==t.eventTypeId},t.isRemoteConfigDto=function(t){return"parameterId"in t&&void 0!==t.parameterId},t.prototype.toDto=function(){return{insertId:this.insertId,timestamp:this.timestamp,userId:this.user.identifiers[z.ID],identifiers:this.user.identifiers,userProperties:M.sanitize(this.user.properties),hackleProperties:M.sanitize(this.user.hackleProperties)}},t}(),Pe=function(t){function e(e,r,n,i,o,s,a,u){var c=t.call(this,e,r,u)||this;return c.experiment=n,c.variationId=i,c.variationKey=o,c.decisionReason=s,c.properties=a,c}return r(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.experiment,this.variationId,this.variationKey,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return n(n({},t.prototype.toDto.call(this)),{experimentId:this.experiment.id,experimentKey:this.experiment.key,experimentType:this.experiment.type,experimentVersion:this.experiment.version,variationId:this.variationId,variationKey:this.variationKey,decisionReason:this.decisionReason.toString(),properties:this.properties})},e}(Ue),De=function(t){function e(e,r,n,i,o){var s=t.call(this,e,r,o)||this;return s.eventType=n,s.event=i,s}return r(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.eventType,this.event,this.insertId)},e.prototype.toDto=function(){return n(n({},t.prototype.toDto.call(this)),{eventTypeId:this.eventType.id,eventTypeKey:this.eventType.key,value:this.event.value||0,properties:M.sanitize(this.event.properties)})},e}(Ue),Le=function(t){function e(e,r,n,i,o,s,a){var u=t.call(this,e,r,a)||this;return u.parameter=n,u.valueId=i,u.decisionReason=o,u.properties=s,u}return r(e,t),e.prototype.copyWithUser=function(t){return new e(this.timestamp,t,this.parameter,this.valueId,this.decisionReason,this.properties,this.insertId)},e.prototype.toDto=function(){return n(n({},t.prototype.toDto.call(this)),{parameterId:this.parameter.id,parameterKey:this.parameter.key,parameterType:this.parameter.type,valueId:this.valueId,decisionReason:this.decisionReason.toString(),properties:M.sanitize(this.properties)})},e}(Ue);function Fe(t){var e=new Array,r=new Array,n=new Array;return t.forEach((function(t){t instanceof Ue?Ue.isExposure(t)?e.push(t.toDto()):Ue.isTrack(t)?r.push(t.toDto()):Ue.isRemoteConfig(t)&&n.push(t.toDto()):Ue.isExposureDto(t)?e.push(t):Ue.isTrackDto(t)?r.push(t):Ue.isRemoteConfigDto(t)&&n.push(t)})),{exposureEvents:e,trackEvents:r,remoteConfigEvents:n}}var Ve=function(){function t(t,e,r){this.sdkKey=t,this.httpRequest=e,this.headers=r.headers,this.dispatchUrl=r.dispatchUrl,this.beaconDispatchUrl=r.beaconDispatchUrl||"",this.useBeacon=r.useBeacon||!1}return t.prototype.dispatch=function(t,e,r){var n={};n[l]=this.sdkKey,n[h]=this.headers[h],n[d]=this.headers[d],n[v]=(new Date).getTime().toString();var i=Fe(t),o=At.start();this.httpRequest.postRequest(this.dispatchUrl,i,n,(function(t){e(t),he.record("post.events",o,!0)}),(function(t){null==r||r(t),he.record("post.events",o,!1)}))},t.prototype.dispatchXhrOrBeacon=function(t,e,r){if(this.useBeacon){var n={};n[l]=this.sdkKey,n[h]=this.headers[h],n[d]=this.headers[d],n[v]=(new Date).getTime().toString();var i=Fe(t),o=At.start();this.httpRequest.sendBeacon(this.beaconDispatchUrl,i,n,(function(t){e(t),he.record("post.events",o,!0)}),(function(t){null==r||r(t),he.record("post.events",o,!1)}))}else this.dispatch(t,e,r)},t}(),je=function(){function t(t,e,r,n,i,o,s,a,u){this.experiments=t,this.featureFlags=e,this.buckets=r,this.eventTypes=n,this.segments=i,this.containers=o,this.parameterConfigurations=s,this.remoteConfigParameters=a,this.inAppMessages=u}return t.prototype.getInAppMessages=function(){return this.inAppMessages},t.prototype.getExperiments=function(){return Array.from(this.experiments.values())},t.prototype.getExperimentOrNull=function(t){return this.experiments.get(t)},t.prototype.getFeatureFlags=function(){return Array.from(this.featureFlags.values())},t.prototype.getFeatureFlagOrNull=function(t){return this.featureFlags.get(t)},t.prototype.getBucketOrNull=function(t){return this.buckets.get(t)},t.prototype.getEventTypeOrNull=function(t){return this.eventTypes.get(t)},t.prototype.getSegmentOrNull=function(t){return this.segments.get(t)},t.prototype.getContainerOrNull=function(t){return this.containers.get(t)},t.prototype.getParameterConfigurationOrNull=function(t){return this.parameterConfigurations.get(t)},t.prototype.getRemoteConfigParameterOrNull=function(t){return this.remoteConfigParameters.get(t)},t.prototype.getInAppMessageOrNull=function(t){return this.inAppMessages.find((function(e){return e.key===t}))},t.from=function(e){var r=u.associate(e.buckets,(function(t){return[t.id,H.fromJSON(t)]}));return new t(u.associateBy(u.mapNotNullOrUndefined(e.experiments,(function(t){return j.fromJSON("AB_TEST",t)})),(function(t){return t.key})),u.associateBy(u.mapNotNullOrUndefined(e.featureFlags,(function(t){return j.fromJSON("FEATURE_FLAG",t)})),(function(t){return t.key})),r,u.associate(e.events,(function(t){return[t.key,new K(t.id,t.key)]})),u.associateBy(u.mapNotNullOrUndefined(e.segments,(function(t){return tt.fromJSON(t)})),(function(t){return t.key})),u.associate(e.containers,(function(t){return[t.id,et.fromJSON(t)]})),u.associate(e.parameterConfigurations,(function(t){return[t.id,nt.fromJSON(t)]})),u.associateBy(u.mapNotNullOrUndefined(e.remoteConfigParameters,(function(t){return it.fromJSON(t)})),(function(t){return t.key})),u.mapNotNullOrUndefined(e.inAppMessages,(function(t){return Ot.fromJSON(t)})))},t}(),Ge=function(){function t(t,e,r){var n=this;this.workspace=null,this.sdkKey=t,this.httpRequest=e,this.isStarted=!1,this.updateInterval=r.updateInterval,this.fetchUrl=r.fetchUrl,this.headers=r.headers,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise((function(t,e){n.readyPromiseResolver=t,n.readyPromiseRejecter=e})),this.currentTimeout=null,this.errorRetryController=new He,this.currentRequest=null,this.syncOnCurrentRequestComplete=!1,this.isReadyPromiseSettled=!1}return t.prototype.onReady=function(){return this.readyPromise},t.prototype.start=function(){this.isStarted||(this.isStarted=!0,this.errorRetryController.reset(),this.fetch())},t.prototype.stop=function(){return this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},t.prototype.get=function(){return this.workspace},t.prototype.scheduleNextUpdate=function(){var t=this,e=this.errorRetryController.getDelay(),r=Math.max(e,this.updateInterval);this.currentTimeout=setTimeout((function(){t.currentRequest?t.syncOnCurrentRequestComplete=!0:t.fetch()}),r)},t.prototype.fetch=function(){var t,e,r=this,n=((t={})[l]=this.sdkKey,t[v]=(new Date).getTime().toString(),t[h]=this.headers[h],t[d]=this.headers[d],t),i=At.start();this.currentRequest=this.httpRequest.getRequest(this.fetchUrl,n);var o=function(t){var e=t.isSuccess;he.record("get.workspace",i,e)},s=function(){r.onRequestComplete()};null===(e=this.currentRequest)||void 0===e||e.responsePromise.then((function(t){r.onRequestResolved(t,o)}),(function(t){r.onRequestRejected(t,o)})).then(s,s),this.updateInterval>0&&this.scheduleNextUpdate()},t.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.syncOnCurrentRequestComplete&&this.fetch(),this.syncOnCurrentRequestComplete=!1)},t.prototype.onRequestResolved=function(t,e){if(this.isStarted){if(void 0!==t.statusCode&&t.statusCode>=200&&t.statusCode<400)this.errorRetryController.reset(),e({isSuccess:!0});else{if(e({isSuccess:!1}),401===t.statusCode||403===t.statusCode)return void this.readyPromiseRejecter(new Error("Invalid key provided."));this.errorRetryController.countError()}if(t.body){var r=JSON.parse(t.body);this.workspace=je.from(r),this.readyPromiseResolver()}}},t.prototype.onRequestRejected=function(t,e){this.isStarted&&(e({isSuccess:!1}),this.errorRetryController.countError(),console.error("Error fetching data",t))},t.prototype.close=function(){this.stop()},t}(),He=function(){function t(){this.errorCount=0}return t.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*m[Math.min(m.length-1,this.errorCount)]+Math.round(1e3*Math.random())},t.prototype.countError=function(){this.errorCount<m.length-1&&this.errorCount++},t.prototype.reset=function(){this.errorCount=0},t}(),Be="model",Ke="name",ze="type",qe="vendor",Ye="version",Je="architecture",Xe="console",We="mobile",$e="tablet",Qe="smarttv",Ze="wearable",tr=function(){function t(){}return t.parse=function(e){return{browser:t.getBrowser(e),cpu:t.getCPU(e),device:t.getDevice(e),engine:t.getEngine(e),os:t.getOS(e)}},t.getBrowser=function(e){var r={name:void 0,version:void 0,major:void 0};return t.mapper.rgx.call(r,e,t.regexes.browser),r.major=t.util.major(r.version),r},t.getCPU=function(e){var r={architecture:void 0};return t.mapper.rgx.call(r,e,t.regexes.cpu),r},t.getDevice=function(e){var r={model:void 0,type:void 0,vendor:void 0};return t.mapper.rgx.call(r,e,t.regexes.device),r},t.getEngine=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.getOS=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.util={extend:function(t,e){var r={};for(var n in t)e[n]&&e[n].length%2==0?r[n]=e[n].concat(t[n]):r[n]=t[n];return r},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},t.mapper={rgx:function(t,e){for(var r,n,i,o,s,a,u=0;u<e.length&&!s;){var c=e[u],f=e[u+1];for(r=n=0;r<c.length&&!s;)if(s=c[r++].exec(t))for(i=0;i<f.length;i++)a=s[++n],"object"==typeof(o=f[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,a):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=a?a.replace(o[1],o[2]):void 0:this[o[0]]=a?o[1].call(this,a,o[2]):void 0:4==o.length&&(this[o[0]]=a?o[3].call(this,a.replace(o[1],o[2])):void 0):this[o]=a||void 0;u+=2}},str:function(e,r){for(var n in r)if("object"==typeof r[n]&&r[n].length>0){for(var i=0;i<r[n].length;i++)if(t.util.has(r[n][i],e))return"?"===n?void 0:n}else if(t.util.has(r[n],e))return"?"===n?void 0:n;return e}},t.maps={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},t.regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[Ke,Ye],[/(opios)[\/\s]+([\w\.]+)/i],[[Ke,"Opera Mini"],Ye],[/\s(opr)\/([\w\.]+)/i],[[Ke,"Opera"],Ye],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[Ke,Ye],[/(konqueror)\/([\w\.]+)/i],[[Ke,"Konqueror"],Ye],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[Ke,"IE"],Ye],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[Ke,"Edge"],Ye],[/(yabrowser)\/([\w\.]+)/i],[[Ke,"Yandex"],Ye],[/(Avast)\/([\w\.]+)/i],[[Ke,"Avast Secure Browser"],Ye],[/(AVG)\/([\w\.]+)/i],[[Ke,"AVG Secure Browser"],Ye],[/(puffin)\/([\w\.]+)/i],[[Ke,"Puffin"],Ye],[/(focus)\/([\w\.]+)/i],[[Ke,"Firefox Focus"],Ye],[/(opt)\/([\w\.]+)/i],[[Ke,"Opera Touch"],Ye],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[Ke,"UCBrowser"],Ye],[/(comodo_dragon)\/([\w\.]+)/i],[[Ke,/_/g," "],Ye],[/(windowswechat qbcore)\/([\w\.]+)/i],[[Ke,"WeChat(Win) Desktop"],Ye],[/(micromessenger)\/([\w\.]+)/i],[[Ke,"WeChat"],Ye],[/(brave)\/([\w\.]+)/i],[[Ke,"Brave"],Ye],[/(whale)\/([\w\.]+)/i],[[Ke,"Whale"],Ye],[/(qqbrowserlite)\/([\w\.]+)/i],[Ke,Ye],[/(QQ)\/([\d\.]+)/i],[Ke,Ye],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[Ke,Ye],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[Ke,Ye],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[Ke,Ye],[/(MetaSr)[\/\s]?([\w\.]+)/i],[Ke],[/(LBBROWSER)/i],[Ke],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[Ye,[Ke,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[Ye,[Ke,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[Ke,Ye],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[Ye,[Ke,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[Ke,/(.+)/,"$1 WebView"],Ye],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[Ke,/(.+(?:g|us))(.+)/,"$1 $2"],Ye],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[Ke,"Chrome Mobile"],Ye],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[Ye,[Ke,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[Ke,"Sailfish Browser"],Ye],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[Ke,Ye],[/(dolfin)\/([\w\.]+)/i],[[Ke,"Dolphin"],Ye],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[Ke,"360 Browser"]],[/(coast)\/([\w\.]+)/i],[[Ke,"Opera Coast"],Ye],[/fxios\/([\w\.-]+)/i],[Ye,[Ke,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[Ye,[Ke,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[Ye,Ke],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[Ke,"GSA"],Ye],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[Ke,[Ye,t.mapper.str,t.maps.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[Ke,Ye],[/(navigator|netscape)\/([\w\.-]+)/i],[[Ke,"Netscape"],Ye],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[Ke,Ye]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[Je,"amd64"]],[/(ia32(?=;))/i],[[Je,t.util.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[Je,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[Je,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[Je,/ower/,"",t.util.lowerize]],[/(sun4\w)[;\)]/i],[[Je,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[Je,t.util.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[Be,qe,[ze,$e]],[/applecoremedia\/[\w\.]+ \((ipad)/],[Be,[qe,"Apple"],[ze,$e]],[/(apple\s{0,1}tv)/i],[[Be,"Apple TV"],[qe,"Apple"],[ze,Qe]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[qe,Be,[ze,$e]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[Be,[qe,"Amazon"],[ze,$e]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[Be,t.mapper.str,t.maps.device.amazon.model],[qe,"Amazon"],[ze,We]],[/android.+aft([bms])\sbuild/i],[Be,[qe,"Amazon"],[ze,Qe]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[Be,qe,[ze,We]],[/\((ip[honed|\s\w*]+);/i],[Be,[qe,"Apple"],[ze,We]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[qe,Be,[ze,We]],[/\(bb10;\s(\w+)/i],[Be,[qe,"BlackBerry"],[ze,We]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[Be,[qe,"Asus"],[ze,$e]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[qe,"Sony"],[Be,"Xperia Tablet"],[ze,$e]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[Be,[qe,"Sony"],[ze,We]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[qe,Be,[ze,Xe]],[/android.+;\s(shield)\sbuild/i],[Be,[qe,"Nvidia"],[ze,Xe]],[/(playstation\s[34portablevi]+)/i],[Be,[qe,"Sony"],[ze,Xe]],[/(sprint\s(\w+))/i],[[qe,t.mapper.str,t.maps.device.sprint.vendor],[Be,t.mapper.str,t.maps.device.sprint.model],[ze,We]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[qe,[Be,/_/g," "],[ze,We]],[/(nexus\s9)/i],[Be,[qe,"HTC"],[ze,$e]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[Be,[qe,"Huawei"],[ze,We]],[/android.+(bah2?-a?[lw]\d{2})/i],[Be,[qe,"Huawei"],[ze,$e]],[/(microsoft);\s(lumia[\s\w]+)/i],[qe,Be,[ze,We]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[Be,[qe,"Microsoft"],[ze,Xe]],[/(kin\.[onetw]{3})/i],[[Be,/\./g," "],[qe,"Microsoft"],[ze,We]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[Be,[qe,"Motorola"],[ze,We]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[Be,[qe,"Motorola"],[ze,$e]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[qe,t.util.trim],[Be,t.util.trim],[ze,Qe]],[/hbbtv.+maple;(\d+)/i],[[Be,/^/,"SmartTV"],[qe,"Samsung"],[ze,Qe]],[/\(dtv[\);].+(aquos)/i],[Be,[qe,"Sharp"],[ze,Qe]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[qe,"Samsung"],Be,[ze,$e]],[/smart-tv.+(samsung)/i],[qe,[ze,Qe],Be],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[qe,"Samsung"],Be,[ze,We]],[/sie-(\w*)/i],[Be,[qe,"Siemens"],[ze,We]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[qe,"Nokia"],Be,[ze,We]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[Be,[qe,"Acer"],[ze,$e]],[/android.+([vl]k\-?\d{3})\s+build/i],[Be,[qe,"LG"],[ze,$e]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[qe,"LG"],Be,[ze,$e]],[/(lg) netcast\.tv/i],[qe,Be,[ze,Qe]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[Be,[qe,"LG"],[ze,We]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[qe,Be,[ze,$e]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[Be,[qe,"Lenovo"],[ze,$e]],[/(lenovo)[_\s-]?([\w-]+)/i],[qe,Be,[ze,We]],[/linux;.+((jolla));/i],[qe,Be,[ze,We]],[/((pebble))app\/[\d\.]+\s/i],[qe,Be,[ze,Ze]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[qe,Be,[ze,We]],[/crkey/i],[[Be,"Chromecast"],[qe,"Google"],[ze,Qe]],[/android.+;\s(glass)\s\d/i],[Be,[qe,"Google"],[ze,Ze]],[/android.+;\s(pixel c)[\s)]/i],[Be,[qe,"Google"],[ze,$e]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[Be,[qe,"Google"],[ze,We]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[Be,/_/g," "],[qe,"Xiaomi"],[ze,We]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[Be,/_/g," "],[qe,"Xiaomi"],[ze,$e]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[Be,[qe,"Meizu"],[ze,We]],[/(mz)-([\w-]{2,})/i],[[qe,"Meizu"],Be,[ze,We]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[Be,[qe,"OnePlus"],[ze,We]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[Be,[qe,"RCA"],[ze,$e]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[Be,[qe,"Dell"],[ze,$e]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[Be,[qe,"Verizon"],[ze,$e]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[qe,"Barnes & Noble"],Be,[ze,$e]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[Be,[qe,"NuVision"],[ze,$e]],[/android.+;\s(k88)\sbuild/i],[Be,[qe,"ZTE"],[ze,$e]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[Be,[qe,"Swiss"],[ze,We]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[Be,[qe,"Swiss"],[ze,$e]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[Be,[qe,"Zeki"],[ze,$e]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[qe,"Dragon Touch"],Be,[ze,$e]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[Be,[qe,"Insignia"],[ze,$e]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[Be,[qe,"NextBook"],[ze,$e]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[qe,"Voice"],Be,[ze,We]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[qe,"LvTel"],Be,[ze,We]],[/android.+;\s(PH-1)\s/i],[Be,[qe,"Essential"],[ze,We]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[Be,[qe,"Envizen"],[ze,$e]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[qe,Be,[ze,$e]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[Be,[qe,"MachSpeed"],[ze,$e]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[qe,Be,[ze,$e]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[Be,[qe,"Rotor"],[ze,$e]],[/android.+(KS(.+))\s+build/i],[Be,[qe,"Amazon"],[ze,$e]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[qe,Be,[ze,$e]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[ze,t.util.lowerize],qe,Be],[/[\s\/\(](smart-?tv)[;\)]/i],[[ze,Qe]],[/(android[\w\.\s\-]{0,9});.+build/i],[Be,[qe,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[Ye,[Ke,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[Ye,[Ke,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[Ke,Ye],[/rv\:([\w\.]{1,9}).+(gecko)/i],[Ye,Ke]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[Ke,Ye],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[Ke,t.mapper.str,t.maps.os.windows],[Ye,t.mapper.str,t.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[Ke,"Windows"],[Ye,t.mapper.str,t.maps.os.windows.version]],[/\((bb)(10);/i],[[Ke,"BlackBerry"],Ye],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[Ke,Ye],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[Ke,"Symbian"],Ye],[/\((series40);/i],[Ke],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[Ke,"Firefox OS"],Ye],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[Ke,"Linux"],Ye],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[Ke,"Chromium OS"],Ye],[/(sunos)\s?([\w\.\d]*)/i],[[Ke,"Solaris"],Ye],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[Ke,"Linux"],Ye],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[Ke,"iPhone"],[Ye,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[Ke,"iPad"],[Ye,/_/g,"."]],[/(haiku)\s(\w+)/i],[Ke,Ye],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[Ye,/_/g,"."],[Ke,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[Ke,"Mac"],[Ye,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[Ke,Ye]]},t}(),er=function(){function t(){}return t.generate=function(t){var e,r;if(void 0===t){var n={hostname:"",pathname:"",host:"",search:"",protocol:""};r={navigator:{userAgent:"",vendor:"",languages:[]},document:{location:n,title:""},location:n,screen:{width:"",height:""}}}else r=t;var i=tr.parse(r.navigator.userAgent),o=i.browser,s=i.os,a=i.device,u=a.type?"mobile"===a.type?"Mobile":"ETC":"Web",c=(r.location.protocol||"").replace(":",""),f=r.screen,p="";try{p=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){}return{platform:u||"",browserName:o.name||"",browserMajorVersion:o.major||"",browserVersion:o.version||"",osName:s.name||"",osVersion:s.version||"",deviceModel:a.model||"",deviceType:a.type||"",deviceVendor:a.vendor||"",language:(null===(e=r.navigator.languages)||void 0===e?void 0:e[0])||"",userAgent:r.navigator.userAgent||"",pagePath:r.location.pathname||"",pageTitle:r.document.title||"",host:r.location.host||"",protocol:c,referrer:r.document.referrer||"",queryParameter:r.location.search||"",screenWidth:f.width||"",screenHeight:f.height||"",timeZone:p||""}},t}(),rr=function(){function t(t){void 0===t&&(t={days:0,isCrossSubdomain:!1,isSecure:!1,isCrossSite:!1}),this.options=t}return t.extractDomain=function(t){var e=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);var i=t.match(e);return i?i[0]:""},t.prototype.getItem=function(t){for(var e=t+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return decodeURIComponent(i.substring(e.length,i.length))}return null},t.prototype.getAllItem=function(t){var e=document.cookie.split("; ").map((function(t){return t.split("=")})),r=null==t?void 0:t.keyPrefix;return r?e.filter((function(t){var e=t[0];return t[1],e.startsWith(r)})):e},t.prototype.setItem=function(e,r,i){var o=n(n({},this.options),i),s=o.isSecure,a="",u="",c="";if(o.isCrossSubdomain){var f=t.extractDomain(document.location.hostname);a=f?"; domain=."+f:""}if(o.days){var p=new Date;p.setTime(p.getTime()+24*o.days*60*60*1e3),u="; expires="+p.toUTCString()}o.isCrossSite&&(s=!0,c="; SameSite=None"),s&&(c+="; secure");var l=e+"="+encodeURIComponent(r)+u+"; path=/"+a+c;return document.cookie=l,l},t.prototype.removeItem=function(t,e){this.setItem(t,"",n(n({},e),{days:-1}))},t}(),nr=new rr({days:3650,isCrossSubdomain:!0}),ir=function(){function t(t){this.search=t}return t.prototype.getQueryParam=function(t){return this.getQueryParams((function(){return!0}))[t]||""},t.prototype.getQueryParams=function(t){for(var e={},r=0,n=this.search.substring(1).split("&");r<n.length;r++){var i=n[r].split("="),o=i[0],s=i[1];t(o,s)&&(e[o]=decodeURIComponent(s))}return e},t}(),or=function(){function t(t){this.userManager=t,sr.initialize()}return t.prototype.resolve=function(t){var e=ar(),r=(new q).addIdentifiers(t.identifiers||{}).add(z.ID,t.id||e).add(z.DEVICE,t.deviceId||e).add(z.HACKLE_DEVICE,e);return a.isNotNullOrUndefined(t.userId)&&r.add(z.USER,t.userId),{identifiers:r.build(),properties:this._userProperties(t.properties),hackleProperties:this._getHackleProperties()}},t.prototype.resolveCurrentUser=function(){return this.resolve(this.userManager.currentUser)},t.prototype._userProperties=function(t){void 0===t&&(t={});var e={};if("undefined"!=typeof window){var r=new ir(window.location.search);e=n(n({},r.getQueryParams((function(t){return t.startsWith("utm_")}))),r.getQueryParams((function(t){return["gclid","fbclid"].includes(t)})))}return n(n({},e),t)},t.prototype._getHackleProperties=function(){var t;return"undefined"!=typeof window&&(t=er.generate(window)),t||{}},t}(),sr=function(){function t(){}return t.initialize=function(){nr.getItem(g)||fr()},t.reInitialize=function(){fr()},t}();function ar(){var t=nr.getItem(E);if(t)return t;var e=nr.getItem(g);return e||fr()}function ur(t){nr.setItem(E,t)}function cr(){nr.removeItem(E)}function fr(){var t=Xt();return nr.setItem(g,t),t}var pr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},lr=function(t){return t&&t.Math==Math&&t},hr=lr("object"==typeof globalThis&&globalThis)||lr("object"==typeof window&&window)||lr("object"==typeof self&&self)||lr("object"==typeof pr&&pr)||function(){return this}()||Function("return this")(),dr={},vr=function(t){try{return!!t()}catch(t){return!0}},yr=!vr((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),mr=!vr((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),gr=mr,Er=Function.prototype.call,wr=gr?Er.bind(Er):function(){return Er.apply(Er,arguments)},Tr={},Nr={}.propertyIsEnumerable,Or=Object.getOwnPropertyDescriptor,Ir=Or&&!Nr.call({1:2},1);Tr.f=Ir?function(t){var e=Or(this,t);return!!e&&e.enumerable}:Nr;var _r,br,Ar=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},Rr=mr,Sr=Function.prototype,Mr=Sr.bind,Cr=Sr.call,xr=Rr&&Mr.bind(Cr,Cr),kr=Rr?function(t){return t&&xr(t)}:function(t){return t&&function(){return Cr.apply(t,arguments)}},Ur=kr,Pr=Ur({}.toString),Dr=Ur("".slice),Lr=function(t){return Dr(Pr(t),8,-1)},Fr=vr,Vr=Lr,jr=Object,Gr=kr("".split),Hr=Fr((function(){return!jr("z").propertyIsEnumerable(0)}))?function(t){return"String"==Vr(t)?Gr(t,""):jr(t)}:jr,Br=TypeError,Kr=function(t){if(null==t)throw Br("Can't call method on "+t);return t},zr=Hr,qr=Kr,Yr=function(t){return zr(qr(t))},Jr=function(t){return"function"==typeof t},Xr=Jr,Wr=function(t){return"object"==typeof t?null!==t:Xr(t)},$r=hr,Qr=Jr,Zr=function(t){return Qr(t)?t:void 0},tn=function(t,e){return arguments.length<2?Zr($r[t]):$r[t]&&$r[t][e]},en=kr({}.isPrototypeOf),rn=tn("navigator","userAgent")||"",nn=hr,on=rn,sn=nn.process,an=nn.Deno,un=sn&&sn.versions||an&&an.version,cn=un&&un.v8;cn&&(br=(_r=cn.split("."))[0]>0&&_r[0]<4?1:+(_r[0]+_r[1])),!br&&on&&(!(_r=on.match(/Edge\/(\d+)/))||_r[1]>=74)&&(_r=on.match(/Chrome\/(\d+)/))&&(br=+_r[1]);var fn=br,pn=fn,ln=vr,hn=!!Object.getOwnPropertySymbols&&!ln((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&pn&&pn<41})),dn=hn&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,vn=tn,yn=Jr,mn=en,gn=Object,En=dn?function(t){return"symbol"==typeof t}:function(t){var e=vn("Symbol");return yn(e)&&mn(e.prototype,gn(t))},wn=String,Tn=function(t){try{return wn(t)}catch(t){return"Object"}},Nn=Jr,On=Tn,In=TypeError,_n=function(t){if(Nn(t))return t;throw In(On(t)+" is not a function")},bn=_n,An=function(t,e){var r=t[e];return null==r?void 0:bn(r)},Rn=wr,Sn=Jr,Mn=Wr,Cn=TypeError,xn={exports:{}},kn=hr,Un=Object.defineProperty,Pn=function(t,e){try{Un(kn,t,{value:e,configurable:!0,writable:!0})}catch(r){kn[t]=e}return e},Dn=Pn,Ln="__core-js_shared__",Fn=hr[Ln]||Dn(Ln,{}),Vn=Fn;(xn.exports=function(t,e){return Vn[t]||(Vn[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.24.1",mode:"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"});var jn=Kr,Gn=Object,Hn=function(t){return Gn(jn(t))},Bn=Hn,Kn=kr({}.hasOwnProperty),zn=Object.hasOwn||function(t,e){return Kn(Bn(t),e)},qn=kr,Yn=0,Jn=Math.random(),Xn=qn(1..toString),Wn=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Xn(++Yn+Jn,36)},$n=hr,Qn=xn.exports,Zn=zn,ti=Wn,ei=hn,ri=dn,ni=Qn("wks"),ii=$n.Symbol,oi=ii&&ii.for,si=ri?ii:ii&&ii.withoutSetter||ti,ai=function(t){if(!Zn(ni,t)||!ei&&"string"!=typeof ni[t]){var e="Symbol."+t;ei&&Zn(ii,t)?ni[t]=ii[t]:ni[t]=ri&&oi?oi(e):si(e)}return ni[t]},ui=wr,ci=Wr,fi=En,pi=An,li=function(t,e){var r,n;if("string"===e&&Sn(r=t.toString)&&!Mn(n=Rn(r,t)))return n;if(Sn(r=t.valueOf)&&!Mn(n=Rn(r,t)))return n;if("string"!==e&&Sn(r=t.toString)&&!Mn(n=Rn(r,t)))return n;throw Cn("Can't convert object to primitive value")},hi=TypeError,di=ai("toPrimitive"),vi=function(t,e){if(!ci(t)||fi(t))return t;var r,n=pi(t,di);if(n){if(void 0===e&&(e="default"),r=ui(n,t,e),!ci(r)||fi(r))return r;throw hi("Can't convert object to primitive value")}return void 0===e&&(e="number"),li(t,e)},yi=En,mi=function(t){var e=vi(t,"string");return yi(e)?e:e+""},gi=Wr,Ei=hr.document,wi=gi(Ei)&&gi(Ei.createElement),Ti=function(t){return wi?Ei.createElement(t):{}},Ni=Ti,Oi=!yr&&!vr((function(){return 7!=Object.defineProperty(Ni("div"),"a",{get:function(){return 7}}).a})),Ii=yr,_i=wr,bi=Tr,Ai=Ar,Ri=Yr,Si=mi,Mi=zn,Ci=Oi,xi=Object.getOwnPropertyDescriptor;dr.f=Ii?xi:function(t,e){if(t=Ri(t),e=Si(e),Ci)try{return xi(t,e)}catch(t){}if(Mi(t,e))return Ai(!_i(bi.f,t,e),t[e])};var ki={},Ui=yr&&vr((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),Pi=Wr,Di=String,Li=TypeError,Fi=function(t){if(Pi(t))return t;throw Li(Di(t)+" is not an object")},Vi=yr,ji=Oi,Gi=Ui,Hi=Fi,Bi=mi,Ki=TypeError,zi=Object.defineProperty,qi=Object.getOwnPropertyDescriptor,Yi="enumerable",Ji="configurable",Xi="writable";ki.f=Vi?Gi?function(t,e,r){if(Hi(t),e=Bi(e),Hi(r),"function"==typeof t&&"prototype"===e&&"value"in r&&Xi in r&&!r.writable){var n=qi(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:Ji in r?r.configurable:n.configurable,enumerable:Yi in r?r.enumerable:n.enumerable,writable:!1})}return zi(t,e,r)}:zi:function(t,e,r){if(Hi(t),e=Bi(e),Hi(r),ji)try{return zi(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Ki("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var Wi=ki,$i=Ar,Qi=yr?function(t,e,r){return Wi.f(t,e,$i(1,r))}:function(t,e,r){return t[e]=r,t},Zi={exports:{}},to=yr,eo=zn,ro=Function.prototype,no=to&&Object.getOwnPropertyDescriptor,io=eo(ro,"name"),oo={EXISTS:io,PROPER:io&&"something"===function(){}.name,CONFIGURABLE:io&&(!to||to&&no(ro,"name").configurable)},so=Jr,ao=Fn,uo=kr(Function.toString);so(ao.inspectSource)||(ao.inspectSource=function(t){return uo(t)});var co,fo,po,lo=ao.inspectSource,ho=Jr,vo=lo,yo=hr.WeakMap,mo=ho(yo)&&/native code/.test(vo(yo)),go=xn.exports,Eo=Wn,wo=go("keys"),To=function(t){return wo[t]||(wo[t]=Eo(t))},No={},Oo=mo,Io=hr,_o=kr,bo=Wr,Ao=Qi,Ro=zn,So=Fn,Mo=To,Co=No,xo="Object already initialized",ko=Io.TypeError,Uo=Io.WeakMap;if(Oo||So.state){var Po=So.state||(So.state=new Uo),Do=_o(Po.get),Lo=_o(Po.has),Fo=_o(Po.set);co=function(t,e){if(Lo(Po,t))throw new ko(xo);return e.facade=t,Fo(Po,t,e),e},fo=function(t){return Do(Po,t)||{}},po=function(t){return Lo(Po,t)}}else{var Vo=Mo("state");Co[Vo]=!0,co=function(t,e){if(Ro(t,Vo))throw new ko(xo);return e.facade=t,Ao(t,Vo,e),e},fo=function(t){return Ro(t,Vo)?t[Vo]:{}},po=function(t){return Ro(t,Vo)}}var jo={set:co,get:fo,has:po,enforce:function(t){return po(t)?fo(t):co(t,{})},getterFor:function(t){return function(e){var r;if(!bo(e)||(r=fo(e)).type!==t)throw ko("Incompatible receiver, "+t+" required");return r}}},Go=vr,Ho=Jr,Bo=zn,Ko=yr,zo=oo.CONFIGURABLE,qo=lo,Yo=jo.enforce,Jo=jo.get,Xo=Object.defineProperty,Wo=Ko&&!Go((function(){return 8!==Xo((function(){}),"length",{value:8}).length})),$o=String(String).split("String"),Qo=Zi.exports=function(t,e,r){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Bo(t,"name")||zo&&t.name!==e)&&(Ko?Xo(t,"name",{value:e,configurable:!0}):t.name=e),Wo&&r&&Bo(r,"arity")&&t.length!==r.arity&&Xo(t,"length",{value:r.arity});try{r&&Bo(r,"constructor")&&r.constructor?Ko&&Xo(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=Yo(t);return Bo(n,"source")||(n.source=$o.join("string"==typeof e?e:"")),t};Function.prototype.toString=Qo((function(){return Ho(this)&&Jo(this).source||qo(this)}),"toString");var Zo=Jr,ts=ki,es=Zi.exports,rs=Pn,ns=function(t,e,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:e;if(Zo(r)&&es(r,o,n),n.global)i?t[e]=r:rs(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch(t){}i?t[e]=r:ts.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},is={},os=Math.ceil,ss=Math.floor,as=Math.trunc||function(t){var e=+t;return(e>0?ss:os)(e)},us=function(t){var e=+t;return e!=e||0===e?0:as(e)},cs=us,fs=Math.max,ps=Math.min,ls=function(t,e){var r=cs(t);return r<0?fs(r+e,0):ps(r,e)},hs=us,ds=Math.min,vs=function(t){return t>0?ds(hs(t),9007199254740991):0},ys=function(t){return vs(t.length)},ms=Yr,gs=ls,Es=ys,ws=function(t){return function(e,r,n){var i,o=ms(e),s=Es(o),a=gs(n,s);if(t&&r!=r){for(;s>a;)if((i=o[a++])!=i)return!0}else for(;s>a;a++)if((t||a in o)&&o[a]===r)return t||a||0;return!t&&-1}},Ts={includes:ws(!0),indexOf:ws(!1)},Ns=zn,Os=Yr,Is=Ts.indexOf,_s=No,bs=kr([].push),As=function(t,e){var r,n=Os(t),i=0,o=[];for(r in n)!Ns(_s,r)&&Ns(n,r)&&bs(o,r);for(;e.length>i;)Ns(n,r=e[i++])&&(~Is(o,r)||bs(o,r));return o},Rs=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ss=As,Ms=Rs.concat("length","prototype");is.f=Object.getOwnPropertyNames||function(t){return Ss(t,Ms)};var Cs={};Cs.f=Object.getOwnPropertySymbols;var xs=tn,ks=is,Us=Cs,Ps=Fi,Ds=kr([].concat),Ls=xs("Reflect","ownKeys")||function(t){var e=ks.f(Ps(t)),r=Us.f;return r?Ds(e,r(t)):e},Fs=zn,Vs=Ls,js=dr,Gs=ki,Hs=function(t,e,r){for(var n=Vs(e),i=Gs.f,o=js.f,s=0;s<n.length;s++){var a=n[s];Fs(t,a)||r&&Fs(r,a)||i(t,a,o(e,a))}},Bs=vr,Ks=Jr,zs=/#|\.prototype\./,qs=function(t,e){var r=Js[Ys(t)];return r==Ws||r!=Xs&&(Ks(e)?Bs(e):!!e)},Ys=qs.normalize=function(t){return String(t).replace(zs,".").toLowerCase()},Js=qs.data={},Xs=qs.NATIVE="N",Ws=qs.POLYFILL="P",$s=qs,Qs=hr,Zs=dr.f,ta=Qi,ea=ns,ra=Pn,na=Hs,ia=$s,oa=function(t,e){var r,n,i,o,s,a=t.target,u=t.global,c=t.stat;if(r=u?Qs:c?Qs[a]||ra(a,{}):(Qs[a]||{}).prototype)for(n in e){if(o=e[n],i=t.dontCallGetSet?(s=Zs(r,n))&&s.value:r[n],!ia(u?n:a+(c?".":"#")+n,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;na(o,i)}(t.sham||i&&i.sham)&&ta(o,"sham",!0),ea(r,n,o,t)}},sa=!vr((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),aa=zn,ua=Jr,ca=Hn,fa=sa,pa=To("IE_PROTO"),la=Object,ha=la.prototype,da=fa?la.getPrototypeOf:function(t){var e=ca(t);if(aa(e,pa))return e[pa];var r=e.constructor;return ua(r)&&e instanceof r?r.prototype:e instanceof la?ha:null},va=Jr,ya=String,ma=TypeError,ga=kr,Ea=Fi,wa=function(t){if("object"==typeof t||va(t))return t;throw ma("Can't set "+ya(t)+" as a prototype")},Ta=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=ga(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return Ea(r),wa(n),e?t(r,n):r.__proto__=n,r}}():void 0),Na={},Oa=As,Ia=Rs,_a=Object.keys||function(t){return Oa(t,Ia)},ba=yr,Aa=Ui,Ra=ki,Sa=Fi,Ma=Yr,Ca=_a;Na.f=ba&&!Aa?Object.defineProperties:function(t,e){Sa(t);for(var r,n=Ma(e),i=Ca(e),o=i.length,s=0;o>s;)Ra.f(t,r=i[s++],n[r]);return t};var xa,ka=tn("document","documentElement"),Ua=Fi,Pa=Na,Da=Rs,La=No,Fa=ka,Va=Ti,ja=To("IE_PROTO"),Ga=function(){},Ha=function(t){return"<script>"+t+"</"+"script>"},Ba=function(t){t.write(Ha("")),t.close();var e=t.parentWindow.Object;return t=null,e},Ka=function(){try{xa=new ActiveXObject("htmlfile")}catch(t){}var t,e;Ka="undefined"!=typeof document?document.domain&&xa?Ba(xa):((e=Va("iframe")).style.display="none",Fa.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(Ha("document.F=Object")),t.close(),t.F):Ba(xa);for(var r=Da.length;r--;)delete Ka.prototype[Da[r]];return Ka()};La[ja]=!0;var za=Object.create||function(t,e){var r;return null!==t?(Ga.prototype=Ua(t),r=new Ga,Ga.prototype=null,r[ja]=t):r=Ka(),void 0===e?r:Pa.f(r,e)},qa=Error,Ya=kr("".replace),Ja=String(qa("zxcasd").stack),Xa=/\n\s*at [^:]*:[^\n]*/,Wa=Xa.test(Ja),$a=Wr,Qa=Qi,Za=_n,tu=mr,eu=kr(kr.bind),ru=function(t,e){return Za(t),void 0===e?t:tu?eu(t,e):function(){return t.apply(e,arguments)}},nu={},iu=nu,ou=ai("iterator"),su=Array.prototype,au=function(t){return void 0!==t&&(iu.Array===t||su[ou]===t)},uu={};uu[ai("toStringTag")]="z";var cu="[object z]"===String(uu),fu=cu,pu=Jr,lu=Lr,hu=ai("toStringTag"),du=Object,vu="Arguments"==lu(function(){return arguments}()),yu=fu?lu:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=du(t),hu))?r:vu?lu(e):"Object"==(n=lu(e))&&pu(e.callee)?"Arguments":n},mu=yu,gu=An,Eu=nu,wu=ai("iterator"),Tu=function(t){if(null!=t)return gu(t,wu)||gu(t,"@@iterator")||Eu[mu(t)]},Nu=wr,Ou=_n,Iu=Fi,_u=Tn,bu=Tu,Au=TypeError,Ru=function(t,e){var r=arguments.length<2?bu(t):e;if(Ou(r))return Iu(Nu(r,t));throw Au(_u(t)+" is not iterable")},Su=wr,Mu=Fi,Cu=An,xu=function(t,e,r){var n,i;Mu(t);try{if(!(n=Cu(t,"return"))){if("throw"===e)throw r;return r}n=Su(n,t)}catch(t){i=!0,n=t}if("throw"===e)throw r;if(i)throw n;return Mu(n),r},ku=ru,Uu=wr,Pu=Fi,Du=Tn,Lu=au,Fu=ys,Vu=en,ju=Ru,Gu=Tu,Hu=xu,Bu=TypeError,Ku=function(t,e){this.stopped=t,this.result=e},zu=Ku.prototype,qu=function(t,e,r){var n,i,o,s,a,u,c,f=r&&r.that,p=!(!r||!r.AS_ENTRIES),l=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),d=!(!r||!r.INTERRUPTED),v=ku(e,f),y=function(t){return n&&Hu(n,"normal",t),new Ku(!0,t)},m=function(t){return p?(Pu(t),d?v(t[0],t[1],y):v(t[0],t[1])):d?v(t,y):v(t)};if(l)n=t.iterator;else if(h)n=t;else{if(!(i=Gu(t)))throw Bu(Du(t)+" is not iterable");if(Lu(i)){for(o=0,s=Fu(t);s>o;o++)if((a=m(t[o]))&&Vu(zu,a))return a;return new Ku(!1)}n=ju(t,i)}for(u=l?t.next:n.next;!(c=Uu(u,n)).done;){try{a=m(c.value)}catch(t){Hu(n,"throw",t)}if("object"==typeof a&&a&&Vu(zu,a))return a}return new Ku(!1)},Yu=yu,Ju=String,Xu=function(t){if("Symbol"===Yu(t))throw TypeError("Cannot convert a Symbol value to a string");return Ju(t)},Wu=Xu,$u=Ar,Qu=!vr((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",$u(1,7)),7!==t.stack)})),Zu=oa,tc=en,ec=da,rc=Ta,nc=Hs,ic=za,oc=Qi,sc=Ar,ac=function(t,e){if(Wa&&"string"==typeof t&&!qa.prepareStackTrace)for(;e--;)t=Ya(t,Xa,"");return t},uc=function(t,e){$a(e)&&"cause"in e&&Qa(t,"cause",e.cause)},cc=qu,fc=function(t,e){return void 0===t?arguments.length<2?"":e:Wu(t)},pc=Qu,lc=ai("toStringTag"),hc=Error,dc=[].push,vc=function(t,e){var r,n=arguments.length>2?arguments[2]:void 0,i=tc(yc,this);rc?r=rc(new hc,i?ec(this):yc):(r=i?this:ic(yc),oc(r,lc,"Error")),void 0!==e&&oc(r,"message",fc(e)),pc&&oc(r,"stack",ac(r.stack,1)),uc(r,n);var o=[];return cc(t,dc,{that:o}),oc(r,"errors",o),r};rc?rc(vc,hc):nc(vc,hc,{name:!0});var yc=vc.prototype=ic(hc.prototype,{constructor:sc(1,vc),message:sc(1,""),name:sc(1,"AggregateError")});Zu({global:!0,constructor:!0,arity:2},{AggregateError:vc});var mc=ai,gc=za,Ec=ki.f,wc=mc("unscopables"),Tc=Array.prototype;null==Tc[wc]&&Ec(Tc,wc,{configurable:!0,value:gc(null)});var Nc,Oc,Ic,_c=function(t){Tc[wc][t]=!0},bc=vr,Ac=Jr,Rc=da,Sc=ns,Mc=ai("iterator"),Cc=!1;[].keys&&("next"in(Ic=[].keys())?(Oc=Rc(Rc(Ic)))!==Object.prototype&&(Nc=Oc):Cc=!0);var xc=null==Nc||bc((function(){var t={};return Nc[Mc].call(t)!==t}));xc&&(Nc={}),Ac(Nc[Mc])||Sc(Nc,Mc,(function(){return this}));var kc={IteratorPrototype:Nc,BUGGY_SAFARI_ITERATORS:Cc},Uc=ki.f,Pc=zn,Dc=ai("toStringTag"),Lc=function(t,e,r){t&&!r&&(t=t.prototype),t&&!Pc(t,Dc)&&Uc(t,Dc,{configurable:!0,value:e})},Fc=kc.IteratorPrototype,Vc=za,jc=Ar,Gc=Lc,Hc=nu,Bc=function(){return this},Kc=oa,zc=wr,qc=Jr,Yc=function(t,e,r,n){var i=e+" Iterator";return t.prototype=Vc(Fc,{next:jc(+!n,r)}),Gc(t,i,!1),Hc[i]=Bc,t},Jc=da,Xc=Ta,Wc=Lc,$c=Qi,Qc=ns,Zc=nu,tf=oo.PROPER,ef=oo.CONFIGURABLE,rf=kc.IteratorPrototype,nf=kc.BUGGY_SAFARI_ITERATORS,of=ai("iterator"),sf="keys",af="values",uf="entries",cf=function(){return this},ff=function(t,e,r,n,i,o,s){Yc(r,e,n);var a,u,c,f=function(t){if(t===i&&v)return v;if(!nf&&t in h)return h[t];switch(t){case sf:case af:case uf:return function(){return new r(this,t)}}return function(){return new r(this)}},p=e+" Iterator",l=!1,h=t.prototype,d=h[of]||h["@@iterator"]||i&&h[i],v=!nf&&d||f(i),y="Array"==e&&h.entries||d;if(y&&(a=Jc(y.call(new t)))!==Object.prototype&&a.next&&(Jc(a)!==rf&&(Xc?Xc(a,rf):qc(a[of])||Qc(a,of,cf)),Wc(a,p,!0)),tf&&i==af&&d&&d.name!==af&&(ef?$c(h,"name",af):(l=!0,v=function(){return zc(d,this)})),i)if(u={values:f(af),keys:o?v:f(sf),entries:f(uf)},s)for(c in u)(nf||l||!(c in h))&&Qc(h,c,u[c]);else Kc({target:e,proto:!0,forced:nf||l},u);return h[of]!==v&&Qc(h,of,v,{name:i}),Zc[e]=v,u},pf=Yr,lf=_c,hf=nu,df=jo,vf=ki.f,yf=ff,mf=yr,gf="Array Iterator",Ef=df.set,wf=df.getterFor(gf),Tf=yf(Array,"Array",(function(t,e){Ef(this,{type:gf,target:pf(t),index:0,kind:e})}),(function(){var t=wf(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),Nf=hf.Arguments=hf.Array;if(lf("keys"),lf("values"),lf("entries"),mf&&"values"!==Nf.name)try{vf(Nf,"name",{value:"values"})}catch(t){}var Of=yu,If=cu?{}.toString:function(){return"[object "+Of(this)+"]"};cu||ns(Object.prototype,"toString",If,{unsafe:!0});var _f="process"==Lr(hr.process),bf=tn,Af=ki,Rf=yr,Sf=ai("species"),Mf=function(t){var e=bf(t),r=Af.f;Rf&&e&&!e[Sf]&&r(e,Sf,{configurable:!0,get:function(){return this}})},Cf=en,xf=TypeError,kf=function(t,e){if(Cf(e,t))return t;throw xf("Incorrect invocation")},Uf=kr,Pf=vr,Df=Jr,Lf=yu,Ff=lo,Vf=function(){},jf=[],Gf=tn("Reflect","construct"),Hf=/^\s*(?:class|function)\b/,Bf=Uf(Hf.exec),Kf=!Hf.exec(Vf),zf=function(t){if(!Df(t))return!1;try{return Gf(Vf,jf,t),!0}catch(t){return!1}},qf=function(t){if(!Df(t))return!1;switch(Lf(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return Kf||!!Bf(Hf,Ff(t))}catch(t){return!0}};qf.sham=!0;var Yf,Jf,Xf,Wf,$f=!Gf||Pf((function(){var t;return zf(zf.call)||!zf(Object)||!zf((function(){t=!0}))||t}))?qf:zf,Qf=$f,Zf=Tn,tp=TypeError,ep=Fi,rp=function(t){if(Qf(t))return t;throw tp(Zf(t)+" is not a constructor")},np=ai("species"),ip=function(t,e){var r,n=ep(t).constructor;return void 0===n||null==(r=ep(n)[np])?e:rp(r)},op=mr,sp=Function.prototype,ap=sp.apply,up=sp.call,cp="object"==typeof Reflect&&Reflect.apply||(op?up.bind(ap):function(){return up.apply(ap,arguments)}),fp=kr([].slice),pp=TypeError,lp=/(?:ipad|iphone|ipod).*applewebkit/i.test(rn),hp=hr,dp=cp,vp=ru,yp=Jr,mp=zn,gp=vr,Ep=ka,wp=fp,Tp=Ti,Np=function(t,e){if(t<e)throw pp("Not enough arguments");return t},Op=lp,Ip=_f,_p=hp.setImmediate,bp=hp.clearImmediate,Ap=hp.process,Rp=hp.Dispatch,Sp=hp.Function,Mp=hp.MessageChannel,Cp=hp.String,xp=0,kp={},Up="onreadystatechange";try{Yf=hp.location}catch(t){}var Pp=function(t){if(mp(kp,t)){var e=kp[t];delete kp[t],e()}},Dp=function(t){return function(){Pp(t)}},Lp=function(t){Pp(t.data)},Fp=function(t){hp.postMessage(Cp(t),Yf.protocol+"//"+Yf.host)};_p&&bp||(_p=function(t){Np(arguments.length,1);var e=yp(t)?t:Sp(t),r=wp(arguments,1);return kp[++xp]=function(){dp(e,void 0,r)},Jf(xp),xp},bp=function(t){delete kp[t]},Ip?Jf=function(t){Ap.nextTick(Dp(t))}:Rp&&Rp.now?Jf=function(t){Rp.now(Dp(t))}:Mp&&!Op?(Wf=(Xf=new Mp).port2,Xf.port1.onmessage=Lp,Jf=vp(Wf.postMessage,Wf)):hp.addEventListener&&yp(hp.postMessage)&&!hp.importScripts&&Yf&&"file:"!==Yf.protocol&&!gp(Fp)?(Jf=Fp,hp.addEventListener("message",Lp,!1)):Jf=Up in Tp("script")?function(t){Ep.appendChild(Tp("script")).onreadystatechange=function(){Ep.removeChild(this),Pp(t)}}:function(t){setTimeout(Dp(t),0)});var Vp,jp,Gp,Hp,Bp,Kp,zp,qp,Yp={set:_p,clear:bp},Jp=hr,Xp=/ipad|iphone|ipod/i.test(rn)&&void 0!==Jp.Pebble,Wp=/web0s(?!.*chrome)/i.test(rn),$p=hr,Qp=ru,Zp=dr.f,tl=Yp.set,el=lp,rl=Xp,nl=Wp,il=_f,ol=$p.MutationObserver||$p.WebKitMutationObserver,sl=$p.document,al=$p.process,ul=$p.Promise,cl=Zp($p,"queueMicrotask"),fl=cl&&cl.value;fl||(Vp=function(){var t,e;for(il&&(t=al.domain)&&t.exit();jp;){e=jp.fn,jp=jp.next;try{e()}catch(t){throw jp?Hp():Gp=void 0,t}}Gp=void 0,t&&t.enter()},el||il||nl||!ol||!sl?!rl&&ul&&ul.resolve?((zp=ul.resolve(void 0)).constructor=ul,qp=Qp(zp.then,zp),Hp=function(){qp(Vp)}):il?Hp=function(){al.nextTick(Vp)}:(tl=Qp(tl,$p),Hp=function(){tl(Vp)}):(Bp=!0,Kp=sl.createTextNode(""),new ol(Vp).observe(Kp,{characterData:!0}),Hp=function(){Kp.data=Bp=!Bp}));var pl=fl||function(t){var e={fn:t,next:void 0};Gp&&(Gp.next=e),jp||(jp=e,Hp()),Gp=e},ll=hr,hl=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},dl=function(){this.head=null,this.tail=null};dl.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var vl=dl,yl=hr.Promise,ml="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,gl=!ml&&!_f&&"object"==typeof window&&"object"==typeof document,El=hr,wl=yl,Tl=Jr,Nl=$s,Ol=lo,Il=ai,_l=gl,bl=ml,Al=fn;wl&&wl.prototype;var Rl=Il("species"),Sl=!1,Ml=Tl(El.PromiseRejectionEvent),Cl=Nl("Promise",(function(){var t=Ol(wl),e=t!==String(wl);if(!e&&66===Al)return!0;if(!Al||Al<51||!/native code/.test(t)){var r=new wl((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[Rl]=n,!(Sl=r.then((function(){}))instanceof n))return!0}return!e&&(_l||bl)&&!Ml})),xl={CONSTRUCTOR:Cl,REJECTION_EVENT:Ml,SUBCLASSING:Sl},kl={},Ul=_n,Pl=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n})),this.resolve=Ul(e),this.reject=Ul(r)};kl.f=function(t){return new Pl(t)};var Dl,Ll,Fl,Vl=oa,jl=_f,Gl=hr,Hl=wr,Bl=ns,Kl=Ta,zl=Lc,ql=Mf,Yl=_n,Jl=Jr,Xl=Wr,Wl=kf,$l=ip,Ql=Yp.set,Zl=pl,th=function(t,e){var r=ll.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))},eh=hl,rh=vl,nh=jo,ih=yl,oh=kl,sh="Promise",ah=xl.CONSTRUCTOR,uh=xl.REJECTION_EVENT,ch=xl.SUBCLASSING,fh=nh.getterFor(sh),ph=nh.set,lh=ih&&ih.prototype,hh=ih,dh=lh,vh=Gl.TypeError,yh=Gl.document,mh=Gl.process,gh=oh.f,Eh=gh,wh=!!(yh&&yh.createEvent&&Gl.dispatchEvent),Th="unhandledrejection",Nh=function(t){var e;return!(!Xl(t)||!Jl(e=t.then))&&e},Oh=function(t,e){var r,n,i,o=e.value,s=1==e.state,a=s?t.ok:t.fail,u=t.resolve,c=t.reject,f=t.domain;try{a?(s||(2===e.rejection&&Rh(e),e.rejection=1),!0===a?r=o:(f&&f.enter(),r=a(o),f&&(f.exit(),i=!0)),r===t.promise?c(vh("Promise-chain cycle")):(n=Nh(r))?Hl(n,r,u,c):u(r)):c(o)}catch(t){f&&!i&&f.exit(),c(t)}},Ih=function(t,e){t.notified||(t.notified=!0,Zl((function(){for(var r,n=t.reactions;r=n.get();)Oh(r,t);t.notified=!1,e&&!t.rejection&&bh(t)})))},_h=function(t,e,r){var n,i;wh?((n=yh.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),Gl.dispatchEvent(n)):n={promise:e,reason:r},!uh&&(i=Gl["on"+t])?i(n):t===Th&&th("Unhandled promise rejection",r)},bh=function(t){Hl(Ql,Gl,(function(){var e,r=t.facade,n=t.value;if(Ah(t)&&(e=eh((function(){jl?mh.emit("unhandledRejection",n,r):_h(Th,r,n)})),t.rejection=jl||Ah(t)?2:1,e.error))throw e.value}))},Ah=function(t){return 1!==t.rejection&&!t.parent},Rh=function(t){Hl(Ql,Gl,(function(){var e=t.facade;jl?mh.emit("rejectionHandled",e):_h("rejectionhandled",e,t.value)}))},Sh=function(t,e,r){return function(n){t(e,n,r)}},Mh=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,Ih(t,!0))},Ch=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw vh("Promise can't be resolved itself");var n=Nh(e);n?Zl((function(){var r={done:!1};try{Hl(n,e,Sh(Ch,r,t),Sh(Mh,r,t))}catch(e){Mh(r,e,t)}})):(t.value=e,t.state=1,Ih(t,!1))}catch(e){Mh({done:!1},e,t)}}};if(ah&&(dh=(hh=function(t){Wl(this,dh),Yl(t),Hl(Dl,this);var e=fh(this);try{t(Sh(Ch,e),Sh(Mh,e))}catch(t){Mh(e,t)}}).prototype,(Dl=function(t){ph(this,{type:sh,done:!1,notified:!1,parent:!1,reactions:new rh,rejection:!1,state:0,value:void 0})}).prototype=Bl(dh,"then",(function(t,e){var r=fh(this),n=gh($l(this,hh));return r.parent=!0,n.ok=!Jl(t)||t,n.fail=Jl(e)&&e,n.domain=jl?mh.domain:void 0,0==r.state?r.reactions.add(n):Zl((function(){Oh(n,r)})),n.promise})),Ll=function(){var t=new Dl,e=fh(t);this.promise=t,this.resolve=Sh(Ch,e),this.reject=Sh(Mh,e)},oh.f=gh=function(t){return t===hh||undefined===t?new Ll(t):Eh(t)},Jl(ih)&&lh!==Object.prototype)){Fl=lh.then,ch||Bl(lh,"then",(function(t,e){var r=this;return new hh((function(t,e){Hl(Fl,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete lh.constructor}catch(t){}Kl&&Kl(lh,dh)}Vl({global:!0,constructor:!0,wrap:!0,forced:ah},{Promise:hh}),zl(hh,sh,!1),ql(sh);var xh=ai("iterator"),kh=!1;try{var Uh=0,Ph={next:function(){return{done:!!Uh++}},return:function(){kh=!0}};Ph[xh]=function(){return this},Array.from(Ph,(function(){throw 2}))}catch(t){}var Dh=function(t,e){if(!e&&!kh)return!1;var r=!1;try{var n={};n[xh]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},Lh=yl,Fh=xl.CONSTRUCTOR||!Dh((function(t){Lh.all(t).then(void 0,(function(){}))})),Vh=wr,jh=_n,Gh=kl,Hh=hl,Bh=qu;oa({target:"Promise",stat:!0,forced:Fh},{all:function(t){var e=this,r=Gh.f(e),n=r.resolve,i=r.reject,o=Hh((function(){var r=jh(e.resolve),o=[],s=0,a=1;Bh(t,(function(t){var u=s++,c=!1;a++,Vh(r,e,t).then((function(t){c||(c=!0,o[u]=t,--a||n(o))}),i)})),--a||n(o)}));return o.error&&i(o.value),r.promise}});var Kh=oa,zh=xl.CONSTRUCTOR,qh=yl,Yh=tn,Jh=Jr,Xh=ns,Wh=qh&&qh.prototype;if(Kh({target:"Promise",proto:!0,forced:zh,real:!0},{catch:function(t){return this.then(void 0,t)}}),Jh(qh)){var $h=Yh("Promise").prototype.catch;Wh.catch!==$h&&Xh(Wh,"catch",$h,{unsafe:!0})}var Qh=wr,Zh=_n,td=kl,ed=hl,rd=qu;oa({target:"Promise",stat:!0,forced:Fh},{race:function(t){var e=this,r=td.f(e),n=r.reject,i=ed((function(){var i=Zh(e.resolve);rd(t,(function(t){Qh(i,e,t).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var nd=wr,id=kl;oa({target:"Promise",stat:!0,forced:xl.CONSTRUCTOR},{reject:function(t){var e=id.f(this);return nd(e.reject,void 0,t),e.promise}});var od=Fi,sd=Wr,ad=kl,ud=function(t,e){if(od(t),sd(e)&&e.constructor===t)return e;var r=ad.f(t);return(0,r.resolve)(e),r.promise},cd=oa,fd=xl.CONSTRUCTOR,pd=ud;tn("Promise"),cd({target:"Promise",stat:!0,forced:fd},{resolve:function(t){return pd(this,t)}});var ld=wr,hd=_n,dd=kl,vd=hl,yd=qu;oa({target:"Promise",stat:!0},{allSettled:function(t){var e=this,r=dd.f(e),n=r.resolve,i=r.reject,o=vd((function(){var r=hd(e.resolve),i=[],o=0,s=1;yd(t,(function(t){var a=o++,u=!1;s++,ld(r,e,t).then((function(t){u||(u=!0,i[a]={status:"fulfilled",value:t},--s||n(i))}),(function(t){u||(u=!0,i[a]={status:"rejected",reason:t},--s||n(i))}))})),--s||n(i)}));return o.error&&i(o.value),r.promise}});var md=wr,gd=_n,Ed=tn,wd=kl,Td=hl,Nd=qu,Od="No one promise resolved";oa({target:"Promise",stat:!0},{any:function(t){var e=this,r=Ed("AggregateError"),n=wd.f(e),i=n.resolve,o=n.reject,s=Td((function(){var n=gd(e.resolve),s=[],a=0,u=1,c=!1;Nd(t,(function(t){var f=a++,p=!1;u++,md(n,e,t).then((function(t){p||c||(c=!0,i(t))}),(function(t){p||c||(p=!0,s[f]=t,--u||o(new r(s,Od)))}))})),--u||o(new r(s,Od))}));return s.error&&o(s.value),n.promise}});var Id=oa,_d=yl,bd=vr,Ad=tn,Rd=Jr,Sd=ip,Md=ud,Cd=ns,xd=_d&&_d.prototype;if(Id({target:"Promise",proto:!0,real:!0,forced:!!_d&&bd((function(){xd.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=Sd(this,Ad("Promise")),r=Rd(t);return this.then(r?function(r){return Md(e,t()).then((function(){return r}))}:t,r?function(r){return Md(e,t()).then((function(){throw r}))}:t)}}),Rd(_d)){var kd=Ad("Promise").prototype.finally;xd.finally!==kd&&Cd(xd,"finally",kd,{unsafe:!0})}var Ud=kr,Pd=us,Dd=Xu,Ld=Kr,Fd=Ud("".charAt),Vd=Ud("".charCodeAt),jd=Ud("".slice),Gd=function(t){return function(e,r){var n,i,o=Dd(Ld(e)),s=Pd(r),a=o.length;return s<0||s>=a?t?"":void 0:(n=Vd(o,s))<55296||n>56319||s+1===a||(i=Vd(o,s+1))<56320||i>57343?t?Fd(o,s):n:t?jd(o,s,s+2):i-56320+(n-55296<<10)+65536}},Hd={codeAt:Gd(!1),charAt:Gd(!0)}.charAt,Bd=Xu,Kd=jo,zd=ff,qd="String Iterator",Yd=Kd.set,Jd=Kd.getterFor(qd);zd(String,"String",(function(t){Yd(this,{type:qd,string:Bd(t),index:0})}),(function(){var t,e=Jd(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=Hd(r,n),e.index+=t.length,{value:t,done:!1})}));var Xd=hr,Wd=Xd.Promise,$d=Ti("span").classList,Qd=$d&&$d.constructor&&$d.constructor.prototype,Zd=Qd===Object.prototype?void 0:Qd,tv=hr,ev={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},rv=Zd,nv=Tf,iv=Qi,ov=ai,sv=ov("iterator"),av=ov("toStringTag"),uv=nv.values,cv=function(t,e){if(t){if(t[sv]!==uv)try{iv(t,sv,uv)}catch(e){t[sv]=uv}if(t[av]||iv(t,av,e),ev[e])for(var r in nv)if(t[r]!==nv[r])try{iv(t,r,nv[r])}catch(e){t[r]=nv[r]}}};for(var fv in ev)cv(tv[fv]&&tv[fv].prototype,fv);cv(rv,"DOMTokenList");var pv=Wd,lv=kl,hv=hl;oa({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=lv.f(this),r=hv(t);return(r.error?e.reject:e.resolve)(r.value),e.promise}});var dv=pv;!function(t){t.exports=dv}({exports:{}});var vv=Fi,yv=xu,mv=mi,gv=ki,Ev=Ar,wv=function(t,e,r){var n=mv(e);n in t?gv.f(t,n,Ev(0,r)):t[n]=r},Tv=ru,Nv=wr,Ov=Hn,Iv=function(t,e,r,n){try{return n?e(vv(r)[0],r[1]):e(r)}catch(e){yv(t,"throw",e)}},_v=au,bv=$f,Av=ys,Rv=wv,Sv=Ru,Mv=Tu,Cv=Array,xv=function(t){var e=Ov(t),r=bv(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=Tv(i,n>2?arguments[2]:void 0));var s,a,u,c,f,p,l=Mv(e),h=0;if(!l||this===Cv&&_v(l))for(s=Av(e),a=r?new this(s):Cv(s);s>h;h++)p=o?i(e[h],h):e[h],Rv(a,h,p);else for(f=(c=Sv(e,l)).next,a=r?new this:[];!(u=Nv(f,c)).done;h++)p=o?Iv(c,i,[u.value,h],!0):u.value,Rv(a,h,p);return a.length=h,a};oa({target:"Array",stat:!0,forced:!Dh((function(t){Array.from(t)}))},{from:xv});var kv=Lr,Uv=Array.isArray||function(t){return"Array"==kv(t)};oa({target:"Array",stat:!0},{isArray:Uv});var Pv=$f,Dv=wv,Lv=Array;oa({target:"Array",stat:!0,forced:vr((function(){function t(){}return!(Lv.of.call(t)instanceof t)}))},{of:function(){for(var t=0,e=arguments.length,r=new(Pv(this)?this:Lv)(e);e>t;)Dv(r,t,arguments[t++]);return r.length=e,r}});var Fv=Hn,Vv=ys,jv=us,Gv=_c;oa({target:"Array",proto:!0},{at:function(t){var e=Fv(this),r=Vv(e),n=jv(t),i=n>=0?n:r+n;return i<0||i>=r?void 0:e[i]}}),Gv("at");var Hv=TypeError,Bv=function(t){if(t>9007199254740991)throw Hv("Maximum allowed index exceeded");return t},Kv=Uv,zv=$f,qv=Wr,Yv=ai("species"),Jv=Array,Xv=function(t){var e;return Kv(t)&&(e=t.constructor,(zv(e)&&(e===Jv||Kv(e.prototype))||qv(e)&&null===(e=e[Yv]))&&(e=void 0)),void 0===e?Jv:e},Wv=function(t,e){return new(Xv(t))(0===e?0:e)},$v=vr,Qv=fn,Zv=ai("species"),ty=function(t){return Qv>=51||!$v((function(){var e=[];return(e.constructor={})[Zv]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},ey=oa,ry=vr,ny=Uv,iy=Wr,oy=Hn,sy=ys,ay=Bv,uy=wv,cy=Wv,fy=ty,py=fn,ly=ai("isConcatSpreadable"),hy=py>=51||!ry((function(){var t=[];return t[ly]=!1,t.concat()[0]!==t})),dy=fy("concat"),vy=function(t){if(!iy(t))return!1;var e=t[ly];return void 0!==e?!!e:ny(t)};ey({target:"Array",proto:!0,arity:1,forced:!hy||!dy},{concat:function(t){var e,r,n,i,o,s=oy(this),a=cy(s,0),u=0;for(e=-1,n=arguments.length;e<n;e++)if(vy(o=-1===e?s:arguments[e]))for(i=sy(o),ay(u+i),r=0;r<i;r++,u++)r in o&&uy(a,u,o[r]);else ay(u+1),uy(a,u++,o);return a.length=u,a}});var yy=Tn,my=TypeError,gy=function(t,e){if(!delete t[e])throw my("Cannot delete property "+yy(e)+" of "+yy(t))},Ey=Hn,wy=ls,Ty=ys,Ny=gy,Oy=Math.min,Iy=[].copyWithin||function(t,e){var r=Ey(this),n=Ty(r),i=wy(t,n),o=wy(e,n),s=arguments.length>2?arguments[2]:void 0,a=Oy((void 0===s?n:wy(s,n))-o,n-i),u=1;for(o<i&&i<o+a&&(u=-1,o+=a-1,i+=a-1);a-- >0;)o in r?r[i]=r[o]:Ny(r,i),i+=u,o+=u;return r},_y=_c;oa({target:"Array",proto:!0},{copyWithin:Iy}),_y("copyWithin");var by=ru,Ay=Hr,Ry=Hn,Sy=ys,My=Wv,Cy=kr([].push),xy=function(t){var e=1==t,r=2==t,n=3==t,i=4==t,o=6==t,s=7==t,a=5==t||o;return function(u,c,f,p){for(var l,h,d=Ry(u),v=Ay(d),y=by(c,f),m=Sy(v),g=0,E=p||My,w=e?E(u,m):r||s?E(u,0):void 0;m>g;g++)if((a||g in v)&&(h=y(l=v[g],g,d),t))if(e)w[g]=h;else if(h)switch(t){case 3:return!0;case 5:return l;case 6:return g;case 2:Cy(w,l)}else switch(t){case 4:return!1;case 7:Cy(w,l)}return o?-1:n||i?i:w}},ky={forEach:xy(0),map:xy(1),filter:xy(2),some:xy(3),every:xy(4),find:xy(5),findIndex:xy(6),filterReject:xy(7)},Uy=vr,Py=function(t,e){var r=[][t];return!!r&&Uy((function(){r.call(null,e||function(){return 1},1)}))},Dy=ky.every;oa({target:"Array",proto:!0,forced:!Py("every")},{every:function(t){return Dy(this,t,arguments.length>1?arguments[1]:void 0)}});var Ly=Hn,Fy=ls,Vy=ys,jy=function(t){for(var e=Ly(this),r=Vy(e),n=arguments.length,i=Fy(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,s=void 0===o?r:Fy(o,r);s>i;)e[i++]=t;return e},Gy=_c;oa({target:"Array",proto:!0},{fill:jy}),Gy("fill");var Hy=ky.filter;oa({target:"Array",proto:!0,forced:!ty("filter")},{filter:function(t){return Hy(this,t,arguments.length>1?arguments[1]:void 0)}});var By=oa,Ky=ky.find,zy=_c,qy="find",Yy=!0;qy in[]&&Array(1).find((function(){Yy=!1})),By({target:"Array",proto:!0,forced:Yy},{find:function(t){return Ky(this,t,arguments.length>1?arguments[1]:void 0)}}),zy(qy);var Jy=oa,Xy=ky.findIndex,Wy=_c,$y="findIndex",Qy=!0;$y in[]&&Array(1).findIndex((function(){Qy=!1})),Jy({target:"Array",proto:!0,forced:Qy},{findIndex:function(t){return Xy(this,t,arguments.length>1?arguments[1]:void 0)}}),Wy($y);var Zy=ru,tm=Hr,em=Hn,rm=ys,nm=function(t){var e=1==t;return function(r,n,i){for(var o,s=em(r),a=tm(s),u=Zy(n,i),c=rm(a);c-- >0;)if(u(o=a[c],c,s))switch(t){case 0:return o;case 1:return c}return e?-1:void 0}},im={findLast:nm(0),findLastIndex:nm(1)},om=im.findLast,sm=_c;oa({target:"Array",proto:!0},{findLast:function(t){return om(this,t,arguments.length>1?arguments[1]:void 0)}}),sm("findLast");var am=im.findLastIndex,um=_c;oa({target:"Array",proto:!0},{findLastIndex:function(t){return am(this,t,arguments.length>1?arguments[1]:void 0)}}),um("findLastIndex");var cm=Uv,fm=ys,pm=Bv,lm=ru,hm=function(t,e,r,n,i,o,s,a){for(var u,c,f=i,p=0,l=!!s&&lm(s,a);p<n;)p in r&&(u=l?l(r[p],p,e):r[p],o>0&&cm(u)?(c=fm(u),f=hm(t,e,u,c,f,o-1)-1):(pm(f+1),t[f]=u),f++),p++;return f},dm=hm,vm=dm,ym=Hn,mm=ys,gm=us,Em=Wv;oa({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=ym(this),r=mm(e),n=Em(e,0);return n.length=vm(n,e,e,r,0,void 0===t?1:gm(t)),n}});var wm=dm,Tm=_n,Nm=Hn,Om=ys,Im=Wv;oa({target:"Array",proto:!0},{flatMap:function(t){var e,r=Nm(this),n=Om(r);return Tm(t),(e=Im(r,0)).length=wm(e,r,r,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var _m=ky.forEach,bm=Py("forEach")?[].forEach:function(t){return _m(this,t,arguments.length>1?arguments[1]:void 0)};oa({target:"Array",proto:!0,forced:[].forEach!=bm},{forEach:bm});var Am=Ts.includes,Rm=_c;oa({target:"Array",proto:!0,forced:vr((function(){return!Array(1).includes()}))},{includes:function(t){return Am(this,t,arguments.length>1?arguments[1]:void 0)}}),Rm("includes");var Sm=oa,Mm=Ts.indexOf,Cm=Py,xm=kr([].indexOf),km=!!xm&&1/xm([1],1,-0)<0,Um=Cm("indexOf");Sm({target:"Array",proto:!0,forced:km||!Um},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return km?xm(this,t,e)||0:Mm(this,t,e)}});var Pm=oa,Dm=Hr,Lm=Yr,Fm=Py,Vm=kr([].join),jm=Dm!=Object,Gm=Fm("join",",");Pm({target:"Array",proto:!0,forced:jm||!Gm},{join:function(t){return Vm(Lm(this),void 0===t?",":t)}});var Hm=cp,Bm=Yr,Km=us,zm=ys,qm=Py,Ym=Math.min,Jm=[].lastIndexOf,Xm=!!Jm&&1/[1].lastIndexOf(1,-0)<0,Wm=qm("lastIndexOf"),$m=Xm||!Wm?function(t){if(Xm)return Hm(Jm,this,arguments)||0;var e=Bm(this),r=zm(e),n=r-1;for(arguments.length>1&&(n=Ym(n,Km(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:Jm;oa({target:"Array",proto:!0,forced:$m!==[].lastIndexOf},{lastIndexOf:$m});var Qm=ky.map;oa({target:"Array",proto:!0,forced:!ty("map")},{map:function(t){return Qm(this,t,arguments.length>1?arguments[1]:void 0)}});var Zm=oa,tg=Hn,eg=ys,rg=Bv,ng=vr((function(){return 4294967297!==[].push.call({length:4294967296},1)})),ig=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();Zm({target:"Array",proto:!0,arity:1,forced:ng||ig},{push:function(t){var e=tg(this),r=eg(e),n=arguments.length;rg(r+n);for(var i=0;i<n;i++)e[r]=arguments[i],r++;return e.length=r,r}});var og=_n,sg=Hn,ag=Hr,ug=ys,cg=TypeError,fg=function(t){return function(e,r,n,i){og(r);var o=sg(e),s=ag(o),a=ug(o),u=t?a-1:0,c=t?-1:1;if(n<2)for(;;){if(u in s){i=s[u],u+=c;break}if(u+=c,t?u<0:a<=u)throw cg("Reduce of empty array with no initial value")}for(;t?u>=0:a>u;u+=c)u in s&&(i=r(i,s[u],u,o));return i}},pg={left:fg(!1),right:fg(!0)},lg=pg.left,hg=fn,dg=_f;oa({target:"Array",proto:!0,forced:!Py("reduce")||!dg&&hg>79&&hg<83},{reduce:function(t){var e=arguments.length;return lg(this,t,e,e>1?arguments[1]:void 0)}});var vg=pg.right,yg=fn,mg=_f;oa({target:"Array",proto:!0,forced:!Py("reduceRight")||!mg&&yg>79&&yg<83},{reduceRight:function(t){return vg(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var gg=oa,Eg=Uv,wg=kr([].reverse),Tg=[1,2];gg({target:"Array",proto:!0,forced:String(Tg)===String(Tg.reverse())},{reverse:function(){return Eg(this)&&(this.length=this.length),wg(this)}});var Ng=oa,Og=Uv,Ig=$f,_g=Wr,bg=ls,Ag=ys,Rg=Yr,Sg=wv,Mg=ai,Cg=fp,xg=ty("slice"),kg=Mg("species"),Ug=Array,Pg=Math.max;Ng({target:"Array",proto:!0,forced:!xg},{slice:function(t,e){var r,n,i,o=Rg(this),s=Ag(o),a=bg(t,s),u=bg(void 0===e?s:e,s);if(Og(o)&&(r=o.constructor,(Ig(r)&&(r===Ug||Og(r.prototype))||_g(r)&&null===(r=r[kg]))&&(r=void 0),r===Ug||void 0===r))return Cg(o,a,u);for(n=new(void 0===r?Ug:r)(Pg(u-a,0)),i=0;a<u;a++,i++)a in o&&Sg(n,i,o[a]);return n.length=i,n}});var Dg=ky.some;oa({target:"Array",proto:!0,forced:!Py("some")},{some:function(t){return Dg(this,t,arguments.length>1?arguments[1]:void 0)}});var Lg=ls,Fg=ys,Vg=wv,jg=Array,Gg=Math.max,Hg=function(t,e,r){for(var n=Fg(t),i=Lg(e,n),o=Lg(void 0===r?n:r,n),s=jg(Gg(o-i,0)),a=0;i<o;i++,a++)Vg(s,a,t[i]);return s.length=a,s},Bg=Hg,Kg=Math.floor,zg=function(t,e){var r=t.length,n=Kg(r/2);return r<8?qg(t,e):Yg(t,zg(Bg(t,0,n),e),zg(Bg(t,n),e),e)},qg=function(t,e){for(var r,n,i=t.length,o=1;o<i;){for(n=o,r=t[o];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==o++&&(t[n]=r)}return t},Yg=function(t,e,r,n){for(var i=e.length,o=r.length,s=0,a=0;s<i||a<o;)t[s+a]=s<i&&a<o?n(e[s],r[a])<=0?e[s++]:r[a++]:s<i?e[s++]:r[a++];return t},Jg=zg,Xg=rn.match(/firefox\/(\d+)/i),Wg=!!Xg&&+Xg[1],$g=/MSIE|Trident/.test(rn),Qg=rn.match(/AppleWebKit\/(\d+)\./),Zg=!!Qg&&+Qg[1],tE=oa,eE=kr,rE=_n,nE=Hn,iE=ys,oE=gy,sE=Xu,aE=vr,uE=Jg,cE=Py,fE=Wg,pE=$g,lE=fn,hE=Zg,dE=[],vE=eE(dE.sort),yE=eE(dE.push),mE=aE((function(){dE.sort(void 0)})),gE=aE((function(){dE.sort(null)})),EE=cE("sort"),wE=!aE((function(){if(lE)return lE<70;if(!(fE&&fE>3)){if(pE)return!0;if(hE)return hE<603;var t,e,r,n,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)dE.push({k:e+n,v:r})}for(dE.sort((function(t,e){return e.v-t.v})),n=0;n<dE.length;n++)e=dE[n].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));tE({target:"Array",proto:!0,forced:mE||!gE||!EE||!wE},{sort:function(t){void 0!==t&&rE(t);var e=nE(this);if(wE)return void 0===t?vE(e):vE(e,t);var r,n,i=[],o=iE(e);for(n=0;n<o;n++)n in e&&yE(i,e[n]);for(uE(i,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:sE(e)>sE(r)?1:-1}}(t)),r=i.length,n=0;n<r;)e[n]=i[n++];for(;n<o;)oE(e,n++);return e}}),Mf("Array");var TE=oa,NE=Hn,OE=ls,IE=us,_E=ys,bE=Bv,AE=Wv,RE=wv,SE=gy,ME=ty("splice"),CE=Math.max,xE=Math.min;TE({target:"Array",proto:!0,forced:!ME},{splice:function(t,e){var r,n,i,o,s,a,u=NE(this),c=_E(u),f=OE(t,c),p=arguments.length;for(0===p?r=n=0:1===p?(r=0,n=c-f):(r=p-2,n=xE(CE(IE(e),0),c-f)),bE(c+r-n),i=AE(u,n),o=0;o<n;o++)(s=f+o)in u&&RE(i,o,u[s]);if(i.length=n,r<n){for(o=f;o<c-n;o++)a=o+r,(s=o+n)in u?u[a]=u[s]:SE(u,a);for(o=c;o>c-n+r;o--)SE(u,o-1)}else if(r>n)for(o=c-n;o>f;o--)a=o+r-1,(s=o+n-1)in u?u[a]=u[s]:SE(u,a);for(o=0;o<r;o++)u[o+f]=arguments[o+2];return u.length=c-n+r,i}}),_c("flat"),_c("flatMap");var kE=oa,UE=Hn,PE=ys,DE=gy,LE=Bv,FE=1!==[].unshift(0),VE=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();kE({target:"Array",proto:!0,arity:1,forced:FE||VE},{unshift:function(t){var e=UE(this),r=PE(e),n=arguments.length;if(n){LE(r+n);for(var i=r;i--;){var o=i+n;i in e?e[o]=e[i]:DE(e,o)}for(var s=0;s<n;s++)e[s]=arguments[s]}return e.length=r+n}});var jE=Xd.Array,GE={exports:{}},HE={},BE=Lr,KE=Yr,zE=is.f,qE=Hg,YE="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];HE.f=function(t){return YE&&"Window"==BE(t)?function(t){try{return zE(t)}catch(t){return qE(YE)}}(t):zE(KE(t))};var JE=vr((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),XE=vr,WE=Wr,$E=Lr,QE=JE,ZE=Object.isExtensible,tw=XE((function(){ZE(1)}))||QE?function(t){return!!WE(t)&&((!QE||"ArrayBuffer"!=$E(t))&&(!ZE||ZE(t)))}:ZE,ew=!vr((function(){return Object.isExtensible(Object.preventExtensions({}))})),rw=oa,nw=kr,iw=No,ow=Wr,sw=zn,aw=ki.f,uw=is,cw=HE,fw=tw,pw=ew,lw=!1,hw=Wn("meta"),dw=0,vw=function(t){aw(t,hw,{value:{objectID:"O"+dw++,weakData:{}}})},yw=GE.exports={enable:function(){yw.enable=function(){},lw=!0;var t=uw.f,e=nw([].splice),r={};r[hw]=1,t(r).length&&(uw.f=function(r){for(var n=t(r),i=0,o=n.length;i<o;i++)if(n[i]===hw){e(n,i,1);break}return n},rw({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:cw.f}))},fastKey:function(t,e){if(!ow(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!sw(t,hw)){if(!fw(t))return"F";if(!e)return"E";vw(t)}return t[hw].objectID},getWeakData:function(t,e){if(!sw(t,hw)){if(!fw(t))return!0;if(!e)return!1;vw(t)}return t[hw].weakData},onFreeze:function(t){return pw&&lw&&fw(t)&&!sw(t,hw)&&vw(t),t}};iw[hw]=!0;var mw=Jr,gw=Wr,Ew=Ta,ww=oa,Tw=hr,Nw=kr,Ow=$s,Iw=ns,_w=GE.exports,bw=qu,Aw=kf,Rw=Jr,Sw=Wr,Mw=vr,Cw=Dh,xw=Lc,kw=function(t,e,r){var n,i;return Ew&&mw(n=e.constructor)&&n!==r&&gw(i=n.prototype)&&i!==r.prototype&&Ew(t,i),t},Uw=ns,Pw=function(t,e,r){for(var n in e)Uw(t,n,e[n],r);return t},Dw=ki.f,Lw=za,Fw=Pw,Vw=ru,jw=kf,Gw=qu,Hw=ff,Bw=Mf,Kw=yr,zw=GE.exports.fastKey,qw=jo.set,Yw=jo.getterFor,Jw={getConstructor:function(t,e,r,n){var i=t((function(t,i){jw(t,o),qw(t,{type:e,index:Lw(null),first:void 0,last:void 0,size:0}),Kw||(t.size=0),null!=i&&Gw(i,t[n],{that:t,AS_ENTRIES:r})})),o=i.prototype,s=Yw(e),a=function(t,e,r){var n,i,o=s(t),a=u(t,e);return a?a.value=r:(o.last=a={index:i=zw(e,!0),key:e,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=a),n&&(n.next=a),Kw?o.size++:t.size++,"F"!==i&&(o.index[i]=a)),t},u=function(t,e){var r,n=s(t),i=zw(e);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==e)return r};return Fw(o,{clear:function(){for(var t=s(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,Kw?t.size=0:this.size=0},delete:function(t){var e=this,r=s(e),n=u(e,t);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),Kw?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=s(this),n=Vw(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!u(this,t)}}),Fw(o,r?{get:function(t){var e=u(this,t);return e&&e.value},set:function(t,e){return a(this,0===t?0:t,e)}}:{add:function(t){return a(this,t=0===t?0:t,t)}}),Kw&&Dw(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=Yw(e),o=Yw(n);Hw(t,e,(function(t,e){qw(this,{type:n,target:t,state:i(t),kind:e,last:void 0})}),(function(){for(var t=o(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),Bw(e)}};(function(t,e,r){var n=-1!==t.indexOf("Map"),i=-1!==t.indexOf("Weak"),o=n?"set":"add",s=Tw[t],a=s&&s.prototype,u=s,c={},f=function(t){var e=Nw(a[t]);Iw(a,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(i&&!Sw(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return i&&!Sw(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!Sw(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if(Ow(t,!Rw(s)||!(i||a.forEach&&!Mw((function(){(new s).entries().next()})))))u=r.getConstructor(e,t,n,o),_w.enable();else if(Ow(t,!0)){var p=new u,l=p[o](i?{}:-0,1)!=p,h=Mw((function(){p.has(1)})),d=Cw((function(t){new s(t)})),v=!i&&Mw((function(){for(var t=new s,e=5;e--;)t[o](e,e);return!t.has(-0)}));d||((u=e((function(t,e){Aw(t,a);var r=kw(new s,t,u);return null!=e&&bw(e,r[o],{that:r,AS_ENTRIES:n}),r}))).prototype=a,a.constructor=u),(h||v)&&(f("delete"),f("has"),n&&f("get")),(v||l)&&f(o),i&&a.clear&&delete a.clear}c[t]=u,ww({global:!0,constructor:!0,forced:u!=s},c),xw(u,t),i||r.setStrong(u,t,n)})("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),Jw);var Xw=ys,Ww=function(t,e){for(var r=0,n=Xw(e),i=new t(n);n>r;)i[r]=e[r++];return i},$w=ru,Qw=Hr,Zw=Hn,tT=mi,eT=ys,rT=za,nT=Ww,iT=Array,oT=kr([].push),sT=function(t,e,r,n){for(var i,o,s,a=Zw(t),u=Qw(a),c=$w(e,r),f=rT(null),p=eT(u),l=0;p>l;l++)s=u[l],(o=tT(c(s,l,a)))in f?oT(f[o],s):f[o]=[s];if(n&&(i=n(a))!==iT)for(o in f)f[o]=nT(i,f[o]);return f},aT=sT,uT=_c;oa({target:"Array",proto:!0},{group:function(t){var e=arguments.length>1?arguments[1]:void 0;return aT(this,t,e)}}),uT("group");var cT=sT,fT=_c;oa({target:"Array",proto:!0,forced:!Py("groupBy")},{groupBy:function(t){var e=arguments.length>1?arguments[1]:void 0;return cT(this,t,e)}}),fT("groupBy");var pT=ru,lT=kr,hT=Hr,dT=Hn,vT=ys,yT=tn("Map"),mT=yT.prototype,gT=lT(mT.get),ET=lT(mT.has),wT=lT(mT.set),TT=lT([].push),NT=function(t){for(var e,r,n=dT(this),i=hT(n),o=pT(t,arguments.length>1?arguments[1]:void 0),s=new yT,a=vT(i),u=0;a>u;u++)e=o(r=i[u],u,n),ET(s,e)?TT(gT(s,e),r):wT(s,e,[r]);return s},OT=_c,IT=NT;oa({target:"Array",proto:!0,name:"groupToMap",forced:!Py("groupByToMap")},{groupByToMap:IT}),OT("groupByToMap");var _T=_c;oa({target:"Array",proto:!0},{groupToMap:NT}),_T("groupToMap");var bT=ys,AT=function(t,e){for(var r=bT(t),n=new e(r),i=0;i<r;i++)n[i]=t[r-i-1];return n},RT=Yr,ST=_c,MT=Array;oa({target:"Array",proto:!0},{toReversed:function(){return AT(RT(this),MT)}}),ST("toReversed");var CT=hr,xT=function(t){return CT[t].prototype},kT=oa,UT=_n,PT=Yr,DT=Ww,LT=_c,FT=Array,VT=kr(xT("Array").sort);kT({target:"Array",proto:!0},{toSorted:function(t){void 0!==t&&UT(t);var e=PT(this),r=DT(FT,e);return VT(r,t)}}),LT("toSorted");var jT=oa,GT=_c,HT=Bv,BT=ys,KT=ls,zT=Yr,qT=us,YT=Array,JT=Math.max,XT=Math.min;jT({target:"Array",proto:!0},{toSpliced:function(t,e){var r,n,i,o,s=zT(this),a=BT(s),u=KT(t,a),c=arguments.length,f=0;for(0===c?r=n=0:1===c?(r=0,n=a-u):(r=c-2,n=XT(JT(qT(e),0),a-u)),i=HT(a+r-n),o=YT(i);f<u;f++)o[f]=s[f];for(;f<u+r;f++)o[f]=arguments[f-u+2];for(;f<i;f++)o[f]=s[f+n-r];return o}}),GT("toSpliced");var WT=ys,$T=us,QT=RangeError,ZT=function(t,e,r,n){var i=WT(t),o=$T(r),s=o<0?i+o:o;if(s>=i||s<0)throw QT("Incorrect index");for(var a=new e(i),u=0;u<i;u++)a[u]=u===s?n:t[u];return a},tN=Yr,eN=Array;oa({target:"Array",proto:!0},{with:function(t,e){return ZT(tN(this),eN,t,e)}});var rN,nN,iN=jE,oN=hr,sN=Fn,aN=Jr,uN=da,cN=ns,fN=ai("asyncIterator"),pN=oN.AsyncIterator,lN=sN.AsyncIteratorPrototype;if(lN)rN=lN;else if(aN(pN))rN=pN.prototype;else if(sN.USE_FUNCTION_CONSTRUCTOR||oN.USE_FUNCTION_CONSTRUCTOR)try{nN=uN(uN(uN(Function("return async function*(){}()")()))),uN(nN)===Object.prototype&&(rN=nN)}catch(t){}rN||(rN={}),aN(rN[fN])||cN(rN,fN,(function(){return this}));var hN=wr,dN=Fi,vN=za,yN=An,mN=Pw,gN=jo,EN=rN,wN=tn("Promise"),TN="AsyncFromSyncIterator",NN=gN.set,ON=gN.getterFor(TN),IN=function(t,e,r){var n=t.done;wN.resolve(t.value).then((function(t){e({done:n,value:t})}),r)},_N=function(t){NN(this,{type:TN,iterator:dN(t),next:t.next})};_N.prototype=mN(vN(EN),{next:function(){var t=ON(this);return new wN((function(e,r){var n=dN(hN(t.next,t.iterator));IN(n,e,r)}))},return:function(){var t=ON(this).iterator;return new wN((function(e,r){var n=yN(t,"return");if(void 0===n)return e({done:!0,value:void 0});var i=dN(hN(n,t));IN(i,e,r)}))}});var bN=_N,AN=wr,RN=bN,SN=Fi,MN=Ru,CN=An,xN=ai("asyncIterator"),kN=_n,UN=Fi,PN=wr,DN=tn,LN=An,FN=wr,VN=_n,jN=Fi,GN=Bv,HN=tn,BN=function(t){return{iterator:t,next:kN(UN(t).next)}},KN=function(t,e,r,n){try{var i=LN(t,"return");if(i)return DN("Promise").resolve(PN(i,t)).then((function(){e(r)}),(function(t){n(t)}))}catch(t){return n(t)}e(r)},zN=function(t){var e=0==t,r=1==t,n=2==t,i=3==t;return function(t,o,s){var a=BN(t),u=HN("Promise"),c=a.iterator,f=a.next,p=0,l=void 0!==o;return!l&&e||VN(o),new u((function(t,a){var h=function(t){KN(c,a,t,a)},d=function(){try{if(e&&l)try{GN(p)}catch(t){h(t)}u.resolve(jN(FN(f,c))).then((function(f){try{if(jN(f).done)e?(s.length=p,t(s)):t(!i&&(n||void 0));else{var v=f.value;try{l?u.resolve(e?o(v,p):o(v)).then((function(o){if(r)d();else if(n)o?d():KN(c,t,!1,a);else if(e)try{s[p++]=o,d()}catch(t){h(t)}else o?KN(c,t,i||v,a):d()}),h):(s[p++]=v,d())}catch(t){h(t)}}}catch(t){a(t)}}),a)}catch(t){a(t)}};d()}))}},qN={toArray:zN(0),forEach:zN(1),every:zN(2),some:zN(3),find:zN(4)},YN=ru,JN=Hn,XN=$f,WN=function(t,e){var r=arguments.length<2?CN(t,xN):e;return r?SN(AN(r,t)):new RN(MN(t))},$N=Ru,QN=Tu,ZN=An,tO=xT,eO=tn,rO=bN,nO=qN.toArray,iO=ai("asyncIterator"),oO=tO("Array").values,sO=function(t){var e=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(eO("Promise"))((function(r){var o=JN(t);void 0!==n&&(n=YN(n,i));var s=ZN(o,iO),a=s?void 0:QN(o)||oO,u=XN(e)?new e:[],c=s?WN(o,s):new rO($N(o,a));r(nO(c,n,u))}))};oa({target:"Array",stat:!0,forced:!0},{fromAsync:sO});var aO=ky.filterReject,uO=_c;oa({target:"Array",proto:!0,forced:!0},{filterOut:function(t){return aO(this,t,arguments.length>1?arguments[1]:void 0)}}),uO("filterOut");var cO=ky.filterReject,fO=_c;oa({target:"Array",proto:!0,forced:!0},{filterReject:function(t){return cO(this,t,arguments.length>1?arguments[1]:void 0)}}),fO("filterReject");var pO=oa,lO=Uv,hO=Object.isFrozen,dO=function(t,e){if(!hO||!lO(t)||!hO(t))return!1;for(var r,n=0,i=t.length;n<i;)if(!("string"==typeof(r=t[n++])||e&&void 0===r))return!1;return 0!==i};pO({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(t){if(!dO(t,!0))return!1;var e=t.raw;return e.length===t.length&&dO(e,!1)}});var vO=Zi.exports,yO=ki,mO=function(t,e,r){return r.get&&vO(r.get,e,{getter:!0}),r.set&&vO(r.set,e,{setter:!0}),yO.f(t,e,r)},gO=_c,EO=Hn,wO=ys;yr&&(mO(Array.prototype,"lastItem",{configurable:!0,get:function(){var t=EO(this),e=wO(t);return 0==e?void 0:t[e-1]},set:function(t){var e=EO(this),r=wO(e);return e[0==r?0:r-1]=t}}),gO("lastItem"));var TO=_c,NO=Hn,OO=ys;yr&&(mO(Array.prototype,"lastIndex",{configurable:!0,get:function(){var t=NO(this),e=OO(t);return 0==e?0:e-1}}),TO("lastIndex"));var IO=kr,_O=_n,bO=ys,AO=Hn,RO=Wv,SO=tn("Map"),MO=SO.prototype,CO=IO(MO.forEach),xO=IO(MO.has),kO=IO(MO.set),UO=IO([].push),PO=_c;oa({target:"Array",proto:!0,forced:!0},{uniqueBy:function(t){var e,r,n,i=AO(this),o=bO(i),s=RO(i,0),a=new SO,u=null!=t?_O(t):function(t){return t};for(e=0;e<o;e++)n=u(r=i[e]),xO(a,n)||kO(a,n,r);return CO(a,(function(t){UO(s,t)})),s}}),PO("uniqueBy");var DO=iN;!function(t){t.exports=DO}({exports:{}});var LO,FO=function(){function t(t){var e=t.timeout,r=t.callback;this.timeout=Math.max(e,0),this.callback=r}return t.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},t.prototype.refresh=function(){this.stop(),this.start()},t.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},t}(),VO=function(){function t(t,e,r){this.buffer=[],this.sink=t,this.maxQueueSize=e,this.timer=new FO({callback:this.flush.bind(this),timeout:r}),this.started=!1}return t.prototype.start=function(){this.started=!0},t.prototype.stop=function(){this.started=!1;var t=this.sink(this.buffer,!0);return this.buffer=[],this.timer.stop(),t},t.prototype.enqueue=function(t){this.started&&(0===this.buffer.length&&this.timer.refresh(),this.buffer.push(t),this.buffer.length>=this.maxQueueSize&&this.flush())},t.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},t.prototype.close=function(){this.stop()},t}(),jO=function(){function t(){this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]=(this.listeners[t]||[]).concat(e)},t.prototype.off=function(t,e){this.listeners[t]=(this.listeners[t]||[]).filter((function(t){return t!==e}))},t.prototype.emit=function(t,e){(this.listeners[t]||[]).forEach((function(t){t(e)}))},t}(),GO=function(t){function e(e,r,n,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.eventDispatcher=e,o.flushInterval=n,o.queue=new VO(o.drainQueue.bind(o),r,n),o.repository=i,o}return r(e,t),e.prototype.isClientError=function(t){return!!(t&&t.statusCode>=400&&t.statusCode<500)},e.prototype.drainRepository=function(t){var e=this;return new Promise((function(r){return i(e,void 0,void 0,(function(){var e,n,i=this;return o(this,(function(o){switch(o.label){case 0:return[4,null===(n=this.repository)||void 0===n?void 0:n.read()];case 1:return(e=o.sent())&&0!==e.length?(t?this.eventDispatcher.dispatchXhrOrBeacon(e,(function(){var t;r(null===(t=i.repository)||void 0===t?void 0:t.delete(e))}),(function(t){var n;i.isClientError(t)?r(null===(n=i.repository)||void 0===n?void 0:n.delete(e)):r()})):this.eventDispatcher.dispatch(e,(function(){var t;r(null===(t=i.repository)||void 0===t?void 0:t.delete(e))}),(function(t){var n;i.isClientError(t)?r(null===(n=i.repository)||void 0===n?void 0:n.delete(e)):r()})),[2]):(r(),[2])}}))}))}))},e.prototype.drainQueue=function(t,e){var r=this,n=t.map((function(t){return t.toDto()})),s=new Promise((function(s){return i(r,void 0,void 0,(function(){var r,i=this;return o(this,(function(o){return 0===t.length?(s(),[2]):(e?(null===(r=this.repository)||void 0===r||r.add(n),this.eventDispatcher.dispatchXhrOrBeacon(t,(function(){var t;s(null===(t=i.repository)||void 0===t?void 0:t.delete(n))}),(function(t){var e;i.isClientError(t)?s(null===(e=i.repository)||void 0===e?void 0:e.delete(n)):s()}))):this.eventDispatcher.dispatch(t,(function(){s()}),(function(t){var e;i.isClientError(t)?s():s(null===(e=i.repository)||void 0===e?void 0:e.add(n))})),[2])}))}))}));return s},e.prototype.process=function(t){this.emit("queue",t),this.queue.enqueue(t)},e.prototype.start=function(){return i(this,void 0,void 0,(function(){return o(this,(function(t){return this.queue.start(),[2]}))}))},e.prototype.stop=function(){try{this.queue.close()}catch(t){}return Promise.resolve()},e.prototype.flush=function(){this.queue.flush()},e.prototype.close=function(){this.stop()},e}(jO),HO=function(){function t(t,e){this.hackleUserResolver=t,this.core=e}return t.isSessionEvent=function(e){return!!Ue.isTrack(e)&&(e.event.key===t.SESSION_START_EVENT_NAME||e.event.key===t.SESSION_END_EVENT_NAME)},t.prototype.onSessionStarted=function(e,r,n){this.track(t.SESSION_START_EVENT_NAME,e,r,n)},t.prototype.onSessionEnded=function(e,r,n){this.track(t.SESSION_END_EVENT_NAME,e,r,n)},t.prototype.track=function(t,e,r,n){var i={key:t,properties:{sessionId:e}},o=this.hackleUserResolver.resolve(r),s=this.decorateSession(o,e);this.core.track(i,s,n)},t.prototype.decorateSession=function(t,e){var r=(new q).add(z.SESSION,e).addIdentifiers(t.identifiers).build();return n(n({},t),{identifiers:r})},t.SESSION_START_EVENT_NAME="$session_start",t.SESSION_END_EVENT_NAME="$session_end",t}(),BO=function(t){function e(e,r,n,i,o,s,a){void 0===i&&(i=null);var u=t.call(this,e,r,n,i)||this;return u.exposureEventDedupDeterminer=o,u.sessionManager=s,u.userManager=a,u}return r(e,t),e.prototype.process=function(e){if(HO.isSessionEvent(e)||this.sessionManager.startNewSessionIfNeeded(this.userManager.currentUser,e.timestamp),!this.exposureEventDedupDeterminer.isDedupTarget(e)){var r=function(t,e){var r;return null===e.currentSessionId||t.user.identifiers[z.SESSION]?t:t.copyWithUser(n(n({},t.user),{identifiers:n(n({},t.user.identifiers),(r={},r[z.SESSION]=e.sessionId,r))}))}(e,this.sessionManager);t.prototype.process.call(this,r)}},e}(GO),KO=function(){function t(t){this.cache=new Map,this.exposureEventDedupIntervalMillis=t}return t.prototype.isDedupTarget=function(t){var e;if(-1===this.exposureEventDedupIntervalMillis)return!1;if(!Ue.isExposure(t))return!1;R.isEquals(t.user.identifiers,null===(e=this.currentUser)||void 0===e?void 0:e.identifiers)||(this.currentUser=t.user,this.cache=new Map);var r=[t.experiment.id,t.variationId,t.variationKey,t.decisionReason].join("-"),n=(new Date).getTime(),i=this.cache.get(r);return void 0!==i&&n-i<=this.exposureEventDedupIntervalMillis||(this.cache.set(r,n),!1)},t}(),zO=function(){function t(){}return t.toEvent=function(e){var r;return{key:t.EVENT_KEY,properties:{level:t.LEVEL_ERROR,type:e.name,message:null!==(r=e.message)&&void 0!==r?r:"",$stacktrace:t._stacktrace(e)}}},t._stacktrace=function(e){return a.isNullOrUndefined(e.stack)?"":e.stack.split("\n").slice(0,t.STACK_TRACK_LIMIT).join("\n")},t.EVENT_KEY="$trace",t.LEVEL_ERROR="error",t.STACK_TRACK_LIMIT=30,t}(),qO=function(){function t(){}return t.prototype.evaluate=function(t,e){if(!this.supports(t))throw new Error("Unsupported EvaluatorRequest ".concat(t.toString()));if(e.contains(t)){var r=e.stack.map((function(t){return t.toString()})).join(" - ");throw new Error("Circular evaluation has occurred [".concat(r," - ").concat(t.toString(),"]"))}e.addRequest(t);try{return this.evaluateInternal(t,e)}finally{e.removeRequest(t)}},t}(),YO=function(t){function e(e){var r=t.call(this)||this;return r.evaluationFlowFactory=e,r}return r(e,t),e.prototype.supports=function(t){return void 0!==t.experiment},e.prototype.evaluateInternal=function(t,e){return this.evaluationFlowFactory.getFlow(t.experiment.type).evaluate(t,e)},e}(qO),JO=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.parameter=r,this.valueId=n,this.value=i,this.properties=o}return t.of=function(e,r,n,i,o,s){return s.returnValue=i,new t(o,r.targetEvaluations,e.parameter,n,i,s)},t.ofDefault=function(t,e,r,n){return this.of(t,e,void 0,t.defaultValue,r,n)},t}(),XO=function(t){function e(e){var r=t.call(this)||this;return r.targetRuleDeterminer=e,r}return r(e,t),e.prototype.supports=function(t){return void 0!==t.parameter},e.prototype.evaluateInternal=function(t,e){var r={};if(r.requestValueType=t.requiredType,r.requestDefaultValue=t.defaultValue,a.isNullOrUndefined(t.user.identifiers[t.parameter.identifierType]))return JO.ofDefault(t,e,V.IDENTIFIER_NOT_FOUND,r);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);return a.isNotNullOrUndefined(n)?(r.targetRuleKey=n.key,r.targetRuleName=n.name,this.evaluation(t,e,n.value,V.TARGET_RULE_MATCH,r)):this.evaluation(t,e,t.parameter.defaultValue,V.DEFAULT_RULE,r)},e.prototype.evaluation=function(t,e,r,n,i){return"UNKNOWN"===t.requiredType||"NULL"!==t.requiredType&&typeof t.defaultValue!=typeof r.rawValue?JO.ofDefault(t,e,V.TYPE_MISMATCH,i):JO.of(t,e,r.id,r.rawValue,n,i)},e}(qO),WO=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.experiment=r,this.variationId=n,this.variationKey=i,this.config=o}return t.prototype.with=function(e){return new t(e,this.targetEvaluations,this.experiment,this.variationId,this.variationKey,this.config)},t.of=function(e,r,n,i){var o=this.config(e.workspace,n);return new t(i,r.targetEvaluations,e.experiment,n.id,n.key,o)},t.ofDefault=function(e,r,n){var i=e.experiment._getVariationByKeyOrNull(e.defaultVariationKey);return a.isNotNullOrUndefined(i)?this.of(e,r,i,n):new t(n,r.targetEvaluations,e.experiment,void 0,e.defaultVariationKey,void 0)},t.config=function(t,e){if(!a.isNullOrUndefined(e.parameterConfigurationId))return a.requiredNotNullOrUndefined(t.getParameterConfigurationOrNull(e.parameterConfigurationId),(function(){return"ParameterConfiguration[".concat(e.parameterConfigurationId,"]")}))},t}(),$O=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isEquals=function(t){return this.type===t.type&&this.id===t.id},t}(),QO=function(){function t(){this._stack=[],this._targetEvaluations=[]}return t.create=function(){return new t},Object.defineProperty(t.prototype,"stack",{get:function(){return Array.from(this._stack)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetEvaluations",{get:function(){return Array.from(this._targetEvaluations)},enumerable:!1,configurable:!0}),t.prototype.contains=function(t){return this._stack.some((function(e){return e.key.isEquals(t.key)}))},t.prototype.addRequest=function(t){this._stack.push(t)},t.prototype.removeRequest=function(t){var e=this._stack.indexOf(t,0);e>-1&&this._stack.splice(e,1)},t.prototype.get=function(t){return this._targetEvaluations.find((function(e){return e instanceof WO&&e.experiment.id===t.id}))},t.prototype.addEvaluation=function(t){this._targetEvaluations.push(t)},t}(),ZO=function(){function t(t,e,r,n){this.key=new $O("EXPERIMENT",r.id),this.workspace=t,this.user=e,this.experiment=r,this.defaultVariationKey=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.by=function(e,r){return new t(e.workspace,e.user,r,"A")},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.experiment.type,", key=").concat(this.experiment.key,")")},t}(),tI=function(){function t(t,e,r,n,i){this.key=new $O("REMOTE_CONFIG",r.id),this.workspace=t,this.user=e,this.parameter=r,this.requiredType=n,this.defaultValue=i}return t.of=function(e,r,n,i,o){return new t(e,r,n,i,o)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.parameter.key,")")},t}(),eI=function(){function t(){}return t.asString=function(t){switch(typeof t){case"string":return t;case"number":return t.toString();default:return}},t.asNumber=function(t){switch(typeof t){case"number":return this.asActualNumber(t);case"string":return this.asActualNumber(Number(t));default:return}},t.asActualNumber=function(t){return!isNaN(t)&&isFinite(t)?t:void 0},t}(),rI=function(){function t(t){this.storages=t}return t.prototype.getVariation=function(t,e){if(0!==this.storages.length)for(var r=0,n=this.storages;r<n.length;r++){var i=n[r].getVariation(t,e);if(void 0!==i)return i}},t}(),nI=function(){function t(t){this.listStorage=t}return t.prototype.getVariation=function(t,e){var r=this.get(t);if(r)return t._getVariationByIdOrNull(r)},t.prototype.get=function(t){var e=this.listStorage.getItem(t.id.toString());return eI.asNumber(e)},t.prototype.getAll=function(){var t=new Map;return this.listStorage.entries().forEach((function(e){var r=e[0],n=e[1],i=eI.asNumber(r),o=eI.asNumber(n);a.isNullOrUndefined(i)||i<0||a.isNullOrUndefined(o)||i<0||t.set(i,o)})),t},t.prototype.set=function(t,e){this.listStorage.setItem(t.id.toString(),e.toString())},t.prototype.remove=function(t){this.listStorage.removeItem(t.id.toString())},t.prototype.clear=function(){this.listStorage.clear()},t}(),iI=function(){function t(){this.evaluators=new Array}return t.prototype.add=function(t){this.evaluators.push(t)},t.prototype.evaluate=function(t,e){var r=this.evaluators.find((function(e){return e.supports(t)}));if(a.isNullOrUndefined(r))throw new Error("Unsupported EvaluatorRequest [".concat(t.toString(),"]"));return r.evaluate(t,e)},t}(),oI=function(){function t(t){this.conditionMatcherFactory=t}return t.prototype.matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n._matches(t,e,r)}))},t.prototype._matches=function(t,e,r){return this.conditionMatcherFactory.getMatcher(r.key.type).matches(t,e,r)},t}(),sI=function(){function t(t,e){this.valueMatcherFactory=t,this.operatorMatcherFactory=e}return t.prototype.matches=function(t,e){var r=this.valueMatcherFactory.getMatcher(e.valueType),n=this.operatorMatcherFactory.getMatcher(e.operator),i=this.userValueMatches(t,e,r,n);return this.typeMatches(e.type,i)},t.prototype.userValueMatches=function(t,e,r,n){return Array.isArray(t)?this.arrayMatches(t,e,r,n):this.singleMatches(t,e,r,n)},t.prototype.singleMatches=function(t,e,r,n){return e.values.some((function(e){return r.matches(n,t,e)}))},t.prototype.arrayMatches=function(t,e,r,n){var i=this;return t.some((function(t){return i.singleMatches(t,e,r,n)}))},t.prototype.typeMatches=function(t,e){switch(t){case"MATCH":return e;case"NOT_MATCH":return!e}},t}(),aI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return t===e},t.prototype.numberMatches=function(t,e){return t===e},t.prototype.stringMatches=function(t,e){return t===e},t.prototype.versionMatches=function(t,e){return t.isEqualTo(e)},t}(),uI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.includes(e)},t.prototype.versionMatches=function(t,e){return!1},t}(),cI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.startsWith(e)},t.prototype.versionMatches=function(t,e){return!1},t}(),fI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return!1},t.prototype.stringMatches=function(t,e){return t.endsWith(e)},t.prototype.versionMatches=function(t,e){return!1},t}(),pI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t>e},t.prototype.stringMatches=function(t,e){return t>e},t.prototype.versionMatches=function(t,e){return t.isGreaterThan(e)},t}(),lI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t>=e},t.prototype.stringMatches=function(t,e){return t>=e},t.prototype.versionMatches=function(t,e){return t.isGreaterThanOrEqualTo(e)},t}(),hI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t<e},t.prototype.stringMatches=function(t,e){return t<e},t.prototype.versionMatches=function(t,e){return t.isLessThan(e)},t}(),dI=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return!1},t.prototype.numberMatches=function(t,e){return t<=e},t.prototype.stringMatches=function(t,e){return t<=e},t.prototype.versionMatches=function(t,e){return t.isLessThanOrEqualTo(e)},t}(),vI=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"IN":return t.IN_MATCHER;case"CONTAINS":return t.CONTAINS_MATCHER;case"STARTS_WITH":return t.STARTS_WITH_MATCHER;case"ENDS_WITH":return t.ENDS_WITH_MATCHER;case"GT":return t.GT_MATCHER;case"GTE":return t.GTE_MATCHER;case"LT":return t.LT_MATCHER;case"LTE":return t.LTE_MATCHER}},t.IN_MATCHER=new aI,t.CONTAINS_MATCHER=new uI,t.STARTS_WITH_MATCHER=new cI,t.ENDS_WITH_MATCHER=new fI,t.GT_MATCHER=new pI,t.GTE_MATCHER=new lI,t.LT_MATCHER=new hI,t.LTE_MATCHER=new dI,t}(),yI=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=eI.asString(e),i=eI.asString(r);return!a.isNullOrUndefined(n)&&!a.isNullOrUndefined(i)&&t.stringMatches(n,i)},t}(),mI=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=eI.asNumber(e),i=eI.asNumber(r);return!a.isNullOrUndefined(n)&&!a.isNullOrUndefined(i)&&t.numberMatches(n,i)},t}(),gI=function(){function t(){}return t.prototype.matches=function(t,e,r){return"boolean"==typeof e&&"boolean"==typeof r&&t.booleanMatches(e,r)},t}(),EI=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=ut.tryParse(e),i=ut.tryParse(r);return!(!n||!i)&&t.versionMatches(n,i)},t}(),wI=function(){function t(){}return t.prototype.matches=function(t,e,r){return!1},t}(),TI=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"STRING":case"JSON":return t.STRING_MATCHER;case"NUMBER":return t.NUMBER_MATCHER;case"BOOLEAN":return t.BOOLEAN_MATCHER;case"VERSION":return t.VERSION_MATCHER;case"NULL":case"UNKNOWN":return t.NULL_MATCHER}},t.STRING_MATCHER=new yI,t.NUMBER_MATCHER=new mI,t.BOOLEAN_MATCHER=new gI,t.VERSION_MATCHER=new EI,t.NULL_MATCHER=new wI,t}(),NI=function(){function t(t,e){this.userValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){var n=this.userValueResolver.resolveOrNull(t.user,r.key);return!a.isNullOrUndefined(n)&&this.valueOperatorMatcher.matches(n,r.match)},t}(),OI=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){switch(e.type){case"USER_ID":return t.identifiers[e.name];case"USER_PROPERTY":return t.properties[e.name];case"HACKLE_PROPERTY":return t.hackleProperties[e.name];case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":case"EVENT_PROPERTY":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t}(),II=function(){function t(t){this.segmentMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;if("SEGMENT"!=r.key.type)throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"));var i=r.match.values.some((function(r){return n._matches(t,e,r)}));switch(r.match.type){case"MATCH":return i;case"NOT_MATCH":return!i}},t.prototype._matches=function(t,e,r){if("string"!=typeof r)throw new Error("SegmentKey[".concat(r,"]"));var n=t.workspace.getSegmentOrNull(r);if(!n)throw new Error("Segment[".concat(r,"]"));return this.segmentMatcher.matches(t,e,n)},t}(),_I=function(){function t(t){this.userConditionMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;return r.targets.some((function(r){return n._matches(t,e,r)}))},t.prototype._matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n.userConditionMatcher.matches(t,e,r)}))},t}(),bI=function(){function t(t,e){this.abTestMatcher=t,this.featureFlagMatcher=e}return t.prototype.matches=function(t,e,r){switch(r.key.type){case"AB_TEST":return this.abTestMatcher.matches(t,e,r);case"FEATURE_FLAG":return this.featureFlagMatcher.matches(t,e,r);case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"EVENT_PROPERTY":case"SEGMENT":throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"))}},t}(),AI=function(){function t(t,e){this.evaluator=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){var n,i=a.requiredNotNullOrUndefined(eI.asNumber(r.key.name),(function(){return"Invalid key [".concat(r.key.type,", ").concat(r.key.name,"]")})),o=this.experiment(t,i);if(a.isNullOrUndefined(o))return!1;var s=null!==(n=e.get(o))&&void 0!==n?n:this.evaluate(t,e,o);return this.evaluationMatches(s,r)},t.prototype.evaluate=function(t,e,r){var n=ZO.by(t,r),i=this.evaluator.evaluate(n,e),o=this.resolve(t,i);return e.addEvaluation(o),o},t}(),RI=function(t){function e(e,r){return t.call(this,e,r)||this}return r(e,t),e.prototype.experiment=function(t,e){return t.workspace.getExperimentOrNull(e)},e.prototype.resolve=function(t,e){return t instanceof ZO&&e.reason===V.TRAFFIC_ALLOCATED?e.with(V.TRAFFIC_ALLOCATED_BY_TARGETING):e},e.prototype.evaluationMatches=function(t,r){return!!e.AB_TEST_MATCHED_REASONS.includes(t.reason)&&this.valueOperatorMatcher.matches(t.variationKey,r.match)},e.AB_TEST_MATCHED_REASONS=[V.OVERRIDDEN,V.TRAFFIC_ALLOCATED,V.EXPERIMENT_COMPLETED,V.TRAFFIC_ALLOCATED_BY_TARGETING],e}(AI),SI=function(t){function e(e,r){return t.call(this,e,r)||this}return r(e,t),e.prototype.experiment=function(t,e){return t.workspace.getFeatureFlagOrNull(e)},e.prototype.resolve=function(t,e){return e},e.prototype.evaluationMatches=function(t,e){var r="A"!==t.variationKey;return this.valueOperatorMatcher.matches(r,e.match)},e}(AI),MI=function(){function t(t){var e=new sI(new TI,new vI),r=new NI(new OI,e);this.userConditionMatcher=r,this.segmentConditionMatcher=new II(new _I(r)),this.experimentConditionMatcher=new bI(new RI(t,e),new SI(t,e))}return t.prototype.getMatcher=function(t){switch(t){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return this.userConditionMatcher;case"SEGMENT":return this.segmentConditionMatcher;case"AB_TEST":case"FEATURE_FLAG":return this.experimentConditionMatcher;case"EVENT_PROPERTY":throw new Error("Unsupported TargetKeyType [".concat(t,"]"))}},t}(),CI=function(){function t(t){this.bucketer=t}return t.prototype.resolveOrNull=function(t,e,r){switch(r.type){case"VARIATION":return this.resolveVariation(t,r);case"BUCKET":return this.resolveBucket(t,r)}},t.prototype.resolveVariation=function(t,e){return t.experiment._getVariationByIdOrNull(e.variationId)},t.prototype.resolveBucket=function(t,e){var r=t.workspace.getBucketOrNull(e.bucketId),n=t.user.identifiers[t.experiment.identifierType];if(n){var i=this.bucketer.bucketing(r,n);if(i)return t.experiment._getVariationByIdOrNull(i.variationId)}},t}(),xI={murmurhash3_x86_32:function(t,e,r,n){void 0===n&&(n=t.length);for(var i,o=3432918353,s=461845907,a=-4&n,u=e,c=0;c<a;c+=4)i=255&t.charCodeAt(c)|(255&t.charCodeAt(c+1))<<8|(255&t.charCodeAt(c+2))<<16|(255&t.charCodeAt(c+3))<<24,i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,u=5*(u=(524287&(u^=i=this.mul32(i,s)))<<13|u>>>19)+3864292196|0;switch(i=0,n%4){case 3:i=(255&t.charCodeAt(a+2))<<16;case 2:i|=(255&t.charCodeAt(a+1))<<8;case 1:i|=255&t.charCodeAt(a),i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,u^=i=this.mul32(i,s)}return u^=n,u^=u>>>16,u=this.mul32(u,2246822507),u^=u>>>13,u=this.mul32(u,3266489909),u^=u>>>16},mul32:function(t,e){var r=65535&e;return((e-r)*t|0)+(r*t|0)|0}},kI=function(){function t(){}return t.prototype.bucketing=function(t,e){var r=this.calculateSlotNumber(t.seed,t.slotSize,e);return t.slots.find((function(t){return t.contains(r)}))},t.prototype.calculateSlotNumber=function(t,e,r){var n=xI.murmurhash3_x86_32(r,t);return Math.abs(n)%Math.abs(e)},t}(),UI=function(){function t(t,e){void 0===t&&(t=void 0),void 0===e&&(e=void 0),this.flowEvaluator=t,this.nextFlow=e}return t.prototype.evaluate=function(t,e){return this.flowEvaluator&&this.nextFlow?this.flowEvaluator.evaluate(t,e,this.nextFlow):WO.ofDefault(t,e,V.TRAFFIC_NOT_ALLOCATED)},t.of=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=new t,i=0,o=e.reverse();i<o.length;i++){var s=o[i];n=new t(s,n)}return n},t}(),PI=function(){function t(t){this.overrideResolver=t}return t.prototype.evaluate=function(t,e,r){var n=this.overrideResolver.resolveOrNull(t,e);if(!n)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return WO.of(t,e,n,V.OVERRIDDEN);case"FEATURE_FLAG":return WO.of(t,e,n,V.INDIVIDUAL_TARGET_MATCH)}},t}(),DI=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.experiment.status?WO.ofDefault(t,e,V.EXPERIMENT_DRAFT):r.evaluate(t,e)},t}(),LI=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("PAUSED"!==t.experiment.status)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return WO.ofDefault(t,e,V.EXPERIMENT_PAUSED);case"FEATURE_FLAG":return WO.ofDefault(t,e,V.FEATURE_FLAG_INACTIVE)}},t}(),FI=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("COMPLETED"===t.experiment.status){var n=t.experiment._winnerVariationOrNull();if(!n)throw new Error("winner variation [".concat(t.experiment.id,"]"));return WO.of(t,e,n,V.EXPERIMENT_COMPLETED)}return r.evaluate(t,e)},t}(),VI=function(){function t(t){this.experimentTargetDeterminer=t}return t.prototype.evaluate=function(t,e,r){if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));return this.experimentTargetDeterminer.isUserInExperimentTarget(t,e)?r.evaluate(t,e):WO.ofDefault(t,e,V.NOT_IN_EXPERIMENT_TARGET)},t}(),jI=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));var n=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);return n?n.isDropped?WO.ofDefault(t,e,V.VARIATION_DROPPED):WO.of(t,e,n,V.TRAFFIC_ALLOCATED):WO.ofDefault(t,e,V.TRAFFIC_NOT_ALLOCATED)},t}(),GI=function(){function t(t,e){this.targetRuleDeterminer=t,this.actionResolver=e}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return r.evaluate(t,e);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);if(!n)return r.evaluate(t,e);var i=this.actionResolver.resolveOrNull(t,e,n.action);if(!i)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return WO.of(t,e,i,V.TARGET_RULE_MATCH)},t}(),HI=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return WO.ofDefault(t,e,V.DEFAULT_RULE);var n=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);if(!n)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return WO.of(t,e,n,V.DEFAULT_RULE)},t}(),BI=function(){function t(t){this.containerResolver=t}return t.prototype.evaluate=function(t,e,r){var n=t.experiment.containerId;if(!n)return r.evaluate(t,e);var i=t.workspace.getContainerOrNull(n);if(!i)throw new Error("container[".concat(n,"]"));return this.containerResolver.isUserInContainerGroup(t,e,i)?r.evaluate(t,e):WO.ofDefault(t,e,V.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT)},t}(),KI=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.user.identifiers[t.experiment.identifierType]?r.evaluate(t,e):WO.ofDefault(t,e,V.IDENTIFIER_NOT_FOUND)},t}(),zI=function(){function t(t){this.targetMatcher=t}return t.prototype.isUserInExperimentTarget=function(t,e){var r=this;return 0===t.experiment.targetAudiences.length||t.experiment.targetAudiences.some((function(n){return r.targetMatcher.matches(t,e,n)}))},t}(),qI=function(){function t(t){this.targetMatcher=t}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.experiment.targetRules.find((function(n){return r.targetMatcher.matches(t,e,n.target)}))},t}(),YI=function(){function t(t,e,r){this.manualOverrideStorage=t,this.targetMatcher=e,this.actionResolver=r}return t.prototype.resolveOrNull=function(t,e){var r,n;return null!==(n=null!==(r=this.resolveManualOverride(t))&&void 0!==r?r:this._resolveUserOverride(t))&&void 0!==n?n:this._resolveSegmentOverride(t,e)},t.prototype.resolveManualOverride=function(t){return this.manualOverrideStorage.getVariation(t.experiment,t.user)},t.prototype._resolveUserOverride=function(t){var e=t.experiment,r=t.user.identifiers[e.identifierType];if(r){var n=e.userOverrides.get(r);if(n)return e._getVariationByIdOrNull(n)}},t.prototype._resolveSegmentOverride=function(t,e){var r=this,n=t.experiment.segmentOverrides.find((function(n){return r.targetMatcher.matches(t,e,n.target)}));if(n)return this.actionResolver.resolveOrNull(t,e,n.action)},t}(),JI=function(){function t(t){this.bucketer=t}return t.prototype.isUserInContainerGroup=function(t,e,r){var n=t.user.identifiers[t.experiment.identifierType];if(a.isNullOrUndefined(n))return!1;var i=t.workspace.getBucketOrNull(r.bucketId);if(a.isNullOrUndefined(i))throw new Error("Bucket[".concat(r.bucketId,"]"));var o=this.bucketer.bucketing(i,n);if(a.isNullOrUndefined(o))return!1;var s=r.getGroupOrNull(o.variationId);if(a.isNullOrUndefined(s))throw new Error("ContainerGroup[".concat(o.variationId,"]"));return s.experiments.includes(t.experiment.id)},t}(),XI=function(){function t(t,e){this.targetMatcher=t,this.bucketer=e}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.parameter.targetRules.find((function(n){return r.matches(t,e,n)}))},t.prototype.matches=function(t,e,r){if(!this.targetMatcher.matches(t,e,r.target))return!1;var n=t.user.identifiers[t.parameter.identifierType];if(a.isNullOrUndefined(n))return!1;var i=t.workspace.getBucketOrNull(r.bucketId);if(a.isNullOrUndefined(i))throw new Error("bucket[".concat(r.bucketId,"]"));return a.isNotNullOrUndefined(this.bucketer.bucketing(i,n))},t}(),WI=function(){function t(t){this.targetMatcher=t}return t.prototype.determineInAppMessageTargetRule=function(t,e){return this.matches(t,e,t.message)?t.message:void 0},t.prototype.matches=function(t,e,r){var n=this;return!!r.supportsWeb()&&(!!r.targetContext.overrides.some((function(r){return n.targetMatcher.matches(t,e,r.toTarget())}))||!!r.isActive()&&(!!r.dateRange.within(t.timestamp)&&(0===r.targetContext.targets.length||r.targetContext.targets.some((function(r){return n.targetMatcher.matches(t,e,r)})))))},t}(),$I=function(){function t(t){this.targetMather=t}return t.prototype.determineInAppMessage=function(t,e){var r=this,n=t.workspace.getInAppMessages().reduce((function(n,i){var o=r.matches(t,e,i);return o?n&&n.priority>=o.priority?n:o:n}),null);return null==n?void 0:n.message},t.prototype.matches=function(t,e,r){var n=this;return r.eventTriggerRules.reduce((function(i,o){return o.eventKey!==t.track.event.key?i:0===o.targets.length||o.targets.some((function(r){return n.targetMather.matches(t,e,r)}))?i&&i.priority>=o.priority?i:{message:r,priority:o.priority}:i}),null)},t}(),QI=function(){function t(t){this.conditionMatcherFactory=t}return t.prototype.matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n._matches(t,e,r)}))},t.prototype._matches=function(t,e,r){return this.conditionMatcherFactory.getMatcher(r.key.type).matches(t,e,r)},t}(),ZI=function(){function t(t,e){this.eventValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){if(a.isNullOrUndefined(t.event))return!1;var n=this.eventValueResolver.resolveOrNull(t.event,r.key);return!a.isNullOrUndefined(n)&&this.valueOperatorMatcher.matches(n,r.match)},t}(),t_=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){var r;switch(e.type){case"EVENT_PROPERTY":return null===(r=null==t?void 0:t.properties)||void 0===r?void 0:r[e.name];case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t}(),e_=function(){function t(){var t=new sI(new TI,new vI),e=new NI(new OI,t);this.userConditionMatcher=e,this.segmentConditionMatcher=new II(new _I(e)),this.eventConditionMatcher=new ZI(new t_,t)}return t.prototype.getMatcher=function(t){switch(t){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return this.userConditionMatcher;case"SEGMENT":return this.segmentConditionMatcher;case"AB_TEST":case"FEATURE_FLAG":throw new Error("Unsupported TargetKeyType [".concat(t,"]"));case"EVENT_PROPERTY":return this.eventConditionMatcher}},t}(),r_=function(){function t(t,e){var r=new kI,n=new oI(new MI(t)),i=new CI(r),o=new YI(e,n,i),s=new JI(r);this.abTestFlow=UI.of(new PI(o),new KI,new BI(s),new VI(new zI(n)),new DI,new LI,new FI,new jI(i)),this.featureFlagFlow=UI.of(new DI,new LI,new FI,new PI(o),new KI,new GI(new qI(n),i),new HI(i)),this.remoteConfigParameterTargetRuleDeterminer=new XI(n,r);var a=new QI(new e_);this.inAppMessageDeterminer=new WI(a),this.trackInAppMessageDeterminer=new $I(a)}return t.prototype.getFlow=function(t){switch(t){case"AB_TEST":return this.abTestFlow;case"FEATURE_FLAG":return this.featureFlagFlow}},t}(),n_=function(){function t(t){this.clock=t}return t.prototype.create=function(e,r){var n=this,i=this.clock.currentMillis(),o=new Array,s=this.createEvent(e,r,i,{});return o.push(s),r.targetEvaluations.forEach((function(r){var s,a=((s={})[t.ROOT_TYPE]=e.key.type,s[t.ROOT_ID]=e.key.id,s),u=n.createEvent(e,r,i,a);o.push(u)})),o},t.prototype.createEvent=function(e,r,i,o){var s;if(r instanceof WO)return o[t.CONFIG_ID_PROPERTY_KEY]=null===(s=r.config)||void 0===s?void 0:s.id,Ue.exposure(e.user,r,o,i);if(r instanceof JO)return Ue.remoteConfig(e.user,r,n(n({},o),r.properties),i);throw new Error("Unsupported Evaluation [".concat(typeof r,"]"))},t.ROOT_TYPE="$targetingRootType",t.ROOT_ID="$targetingRootId",t.CONFIG_ID_PROPERTY_KEY="$parameterConfigurationId",t}(),i_=function(t,e,r){this.reason=t,this.targetEvaluations=e,this.message=r},o_=function(t){function e(e){var r=t.call(this)||this;return r.determiner=e,r}return r(e,t),e.prototype.supports=function(t){return!!("message"in t&&t.message instanceof Ot)},e.prototype.evaluateInternal=function(t,e){var r=this.determiner.determineInAppMessageTargetRule(t,e);return new i_(r?V.TARGET_RULE_MATCH:V.DEFAULT_RULE,e.targetEvaluations,r)},e}(qO),s_=function(){function t(t,e,r,n){this.key=new $O("IN_APP_MESSAGE",e.key),this.workspace=t,this.user=r,this.message=e,this.timestamp=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.message.key,")")},t}(),a_=function(t,e,r){this.reason=t,this.targetEvaluations=e,this.message=r},u_=function(t){function e(e){var r=t.call(this)||this;return r.determiner=e,r}return r(e,t),e.prototype.supports=function(t){return!!("track"in t&&t.track instanceof De)},e.prototype.evaluateInternal=function(t,e){var r=this.determiner.determineInAppMessage(t,e);return new a_(r?V.TARGET_RULE_MATCH:V.DEFAULT_RULE,e.targetEvaluations,r)},e}(qO),c_=function(){function t(t,e){this.key=new $O("IN_APP_MESSAGE",e.insertId),this.workspace=t,this.track=e,this.user=e.user,this.event=e.event}return t.of=function(e,r){return new t(e,r)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.track.insertId,")")},t}(),f_=f.log,p_=function(){function t(t,e,r,n,i,o,s,a){this.experimentEvaluator=t,this.remoteConfigEvaluator=e,this.trackInAppMessageEvaluator=n,this.inAppMessageEvaluator=r,this.workspaceFetcher=i,this.eventFactory=o,this.eventProcessor=s,this.errorDedupDeterminer=a,this.workspaceFetcher.start(),this.eventProcessor.start(),this.readyPromise=this.workspaceFetcher.onReady().then((function(){return{success:!0}}),(function(t){return{success:!1,error:t}}))}return t.create=function(e,r,n){var i=new iI,o=new rI(n),s=new r_(i,o),a=new YO(s),u=new XO(s.remoteConfigParameterTargetRuleDeterminer),c=new u_(s.trackInAppMessageDeterminer),f=new o_(s.inAppMessageDeterminer);return i.add(a),i.add(u),new t(a,u,f,c,e,new n_(_t.instance),r,new l_)},t.prototype.experiment=function(t,e,r){var n=this;if(!t)return f_.error("experimentKey must not be empty"),P.of(r,V.INVALID_INPUT);var i=this.workspaceFetcher.get();if(!i)return f_.warn("SDK not ready."),P.of(r,V.SDK_NOT_READY);var o=i.getExperimentOrNull(t);if(!o)return f_.warn("Experiment does not exist."),P.of(r,V.EXPERIMENT_NOT_FOUND);var s=ZO.of(i,e,o,r),a=this.experimentInternal(s),u=a[0],c=a[1];return this.eventFactory.create(s,u).forEach((function(t){return n.eventProcessor.process(t)})),c},t.prototype.experiments=function(t){var e=this,r=new Qt((function(t,e){return t.id===e.id})),n=this.workspaceFetcher.get();return n?(n.getExperiments().forEach((function(i){var o=ZO.of(n,t,i,"A"),s=e.experimentInternal(o);s[0];var a=s[1];r.add(i,a)})),r):r},t.prototype.experimentInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,QO.create()),n=null!==(e=r.config)&&void 0!==e?e:new F;return[r,P.of(r.variationKey,r.reason,n)]},t.prototype.featureFlag=function(t,e){var r=this;if(!t)return f_.error("featureKey must not be empty"),D.off(V.INVALID_INPUT);var n=this.workspaceFetcher.get();if(!n)return f_.warn("SDK not ready."),D.off(V.SDK_NOT_READY);var i=n.getFeatureFlagOrNull(t);if(!i)return f_.warn("FeatureFlag does not exist."),D.off(V.FEATURE_FLAG_NOT_FOUND);var o=ZO.of(n,e,i,"A"),s=this.featureFlagInternal(o),a=s[0],u=s[1];return this.eventFactory.create(o,a).forEach((function(t){return r.eventProcessor.process(t)})),u},t.prototype.featureFlags=function(t){var e=this,r=new Qt((function(t,e){return t.id===e.id})),n=this.workspaceFetcher.get();return n?(n.getFeatureFlags().forEach((function(i){var o=ZO.of(n,t,i,"A"),s=e.featureFlagInternal(o);s[0];var a=s[1];r.add(i,a)})),r):r},t.prototype.featureFlagInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,QO.create()),n=null!==(e=r.config)&&void 0!==e?e:new F;return[r,"A"===r.variationKey?D.off(r.reason,n):D.on(r.reason,n)]},t.prototype.trackInAppMessage=function(t){var e=this.workspaceFetcher.get();if(!e)return f_.warn("SDK not ready."),new U(void 0,V.SDK_NOT_READY);var r=new c_(e,t),n=this.trackInAppMessageEvaluator.evaluate(r,QO.create());return new U(n.message,n.reason)},t.prototype.inAppMessage=function(t,e,r){void 0===r&&(r=Date.now());var n=this.workspaceFetcher.get();if(!n)return f_.warn("SDK not ready."),new U(void 0,V.SDK_NOT_READY);var i=n.getInAppMessageOrNull(t);if(!i)return f_.warn("In app message does not exist."),new U(void 0,V.IN_APP_MESSAGE_NOT_FOUND);var o=s_.of(n,i,e,r),s=this.inAppMessageEvaluator.evaluate(o,QO.create());return new U(s.message,s.reason)},t.prototype.track=function(t,e,r){var n;if(void 0===r&&(r=(new Date).getTime()),t)if("object"==typeof t)if("object"!=typeof t||t.key&&"string"==typeof t.key){var i=(null===(n=this.workspaceFetcher.get())||void 0===n?void 0:n.getEventTypeOrNull(t.key))||new K(0,t.key);this.eventProcessor.process(Ue.track(i,t,e,r))}else f_.warn("Event key must be not null. or event key must be string type.");else f_.warn("Event must be event type.");else f_.warn("event must not be null.")},t.prototype.trackException=function(t,e){if(!this.errorDedupDeterminer.isDedupTarget(t)){var r=zO.toEvent(t);this.flush(),this.track(r,e),this.flush()}},t.prototype.flush=function(){this.eventProcessor.flush()},t.prototype.remoteConfig=function(t,e,r,n){var i=this,o=this.workspaceFetcher.get();if(a.isNullOrUndefined(o))return f_.warn("SDK not ready."),k.of(n,V.SDK_NOT_READY);var s=o.getRemoteConfigParameterOrNull(t);if(a.isNullOrUndefined(s))return f_.warn("Remote config parameter does not exist."),k.of(n,V.REMOTE_CONFIG_PARAMETER_NOT_FOUND);var u=tI.of(o,e,s,r,n),c=this.remoteConfigEvaluator.evaluate(u,QO.create());return this.eventFactory.create(u,c).forEach((function(t){return i.eventProcessor.process(t)})),k.of(c.value,c.reason)},t.prototype.onReady=function(t,e){void 0===e&&(e=y),this.onInitialized({timeout:e}).then((function(){return t()}))},t.prototype.onInitialized=function(t){var e,r=t.timeout,n=void 0===r?y:r;f_.debug("Start HackleClient initializing");var i=new Promise((function(t){e=t})),o=setTimeout((function(){e({success:!1})}),n);return this.readyPromise.then((function(){clearTimeout(o),e({success:!0})}),(function(t){clearTimeout(o),e({success:!1,error:t})})),Promise.race([this.readyPromise,i]).then((function(t){return t.success?f_.debug("HackleClient onInitialized Success"):t.error instanceof Error?f_.error("HackleClient onInitialized Failed. ".concat(t.error.message)):f_.error("HackleClient onInitialized Failed. ".concat(t.error)),Promise.resolve({success:t.success})}))},t.prototype.close=function(){this.workspaceFetcher.close(),this.eventProcessor.close()},t}(),l_=function(){function t(){}return t.prototype.isDedupTarget=function(t){return!!this._isSameError(t,this.previous)||(this.previous=t,!1)},t.prototype._isSameError=function(t,e){return!a.isNullOrUndefined(e)&&(t.name===e.name&&t.message===e.message&&t.stack===e.stack)},t}(),h_=function(){function t(){this._installed=[],this._installations={onerror:v_,onunhandledrejection:y_}}return t.prototype.install=function(t,e){this._install("onerror",t,e),this._install("onunhandledrejection",t,e)},t.prototype._install=function(t,e,r){t in this._installed||((0,this._installations[t])(e,r),this._installed.push(t))},t}(),d_=null;function v_(t,e){d_=window.onerror,window.onerror=function(r,n,i,o,s){a.isNotNullOrUndefined(s)&&t.trackException(s,e.resolveCurrentUser()),d_&&d_.apply(this,arguments)}}function y_(t,e){LO=window.onunhandledrejection,window.onunhandledrejection=function(r){var n;try{"reason"in r?n=r.reason:"detail"in r&&"reason"in r.detail&&(n=r.detail.reason)}catch(t){}n instanceof Error&&t.trackException(n,e.resolveCurrentUser()),LO&&LO.apply(this,arguments)}}var m_=function(){function t(t,e,r){this.storage=t,this.storageKey=e,this.maxSize=r}return t.prototype.read=function(){var t=this;return new Promise((function(e){var r=t.storage.getItem(t.storageKey);r&&e(JSON.parse(r));e([])}))},t.prototype.save=function(t){var e=this;return 0===t.length?this.clear():new Promise((function(r){var n=JSON.stringify(t.slice(-e.maxSize));e.storage.setItem(e.storageKey,n),r()}))},t.prototype.add=function(t){var e=this;return this.read().then((function(r){return e.save(r.concat(t).slice(-e.maxSize))}))},t.prototype.delete=function(t){var e=this;return this.read().then((function(r){var n=r.filter((function(e){return t.findIndex((function(t){return t.insertId===e.insertId}))<0}));return e.save(n)}))},t.prototype.clear=function(){var t=this;return new Promise((function(e){localStorage.removeItem(t.storageKey),e()}))},t}(),g_=function(t,e){return null!==t&&(t.userId===e.userId&&t.deviceId===e.deviceId)},E_=function(){function t(t,e,r,n){var i;void 0===r&&(r=null),void 0===n&&(n=null),this.storage=t,this.hackleDeviceId=e,this.userListeners=[],this.defaultUser={deviceId:this.hackleDeviceId},this._currentUser=null!==(i=null!=n?n:r)&&void 0!==i?i:this.defaultUser,this.storage.saveUser(this._currentUser)}return t.prototype.addListener=function(t){this.userListeners.push(t)},Object.defineProperty(t.prototype,"currentUser",{get:function(){return this._currentUser},enumerable:!1,configurable:!0}),t.prototype.resolveCurrentOrNull=function(t){if(void 0===t)return this.currentUser;if("string"==typeof t)return this.setUser({id:t});var e=Y(t);return e?this.setUser(e):null},t.prototype.setUser=function(t){return this.updateUser(t)},t.prototype.setUserId=function(t){var e=n(n({},this._currentUser),{userId:t});return this.setUser(e)},t.prototype.setDeviceId=function(t){var e=n(n({},this._currentUser),{deviceId:t});return this.setUser(e)},t.prototype.updateUserProperties=function(t){return this.operateProperties(t)},t.prototype.resetUser=function(){return this.setUser(this.defaultUser)},t.prototype.changeUser=function(t,e,r){this.userListeners.forEach((function(n){n.onUserUpdated(t,e,r)}))},t.prototype.saveUser=function(t){this.storage.saveUser(t)},t.prototype.update=function(t){var e=this._currentUser,r=t(e);return this._currentUser=r,g_(e,r)||(this.changeUser(e,r,(new Date).getTime()),this.saveUser(r)),r},t.prototype.updateUser=function(t){return this.update((function(e){return g_(r=e,i=t)?n(n({},i),{properties:n(n({},r.properties),i.properties)}):i;var r,i}))},t.prototype.operateProperties=function(t){return this.update((function(e){var r,i=null!==(r=null==e?void 0:e.properties)&&void 0!==r?r:{},o=t.operate(new Map(Object.entries(i)));return n(n({},e),{properties:a.fromMap(o)})}))},t}(),w_=function(){function t(t){this.storage=t}return t.prototype.getUser=function(){var t=this.deviceId||void 0,e=this.userId||void 0;return void 0!==t||void 0!==e?{deviceId:t,userId:e}:null},t.prototype.saveUser=function(t){this.setDeviceId(t.deviceId||null),this.setUserId(t.userId||null)},Object.defineProperty(t.prototype,"deviceId",{get:function(){return this.storage.getItem(O)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this.storage.getItem(N)},enumerable:!1,configurable:!0}),t.prototype.setDeviceId=function(t){this.setId(O,t)},t.prototype.setUserId=function(t){this.setId(N,t)},t.prototype.setId=function(t,e){a.isNotNullOrUndefined(e)?this.storage.setItem(t,e):this.storage.removeItem(t)},t}(),T_=function(){function t(t,e){this.sessionTimeoutMillis=t,this.storage=e,this.sessionListeners=[],this._currentSessionId=null,this._lastEventTime=null,this.loadSession(),this.loadLastEventTime()}return Object.defineProperty(t.prototype,"currentSessionId",{get:function(){return this._currentSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){var e;return null!==(e=this._currentSessionId)&&void 0!==e?e:t.EMPTY_SESSION_ID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},enumerable:!1,configurable:!0}),t.prototype.addListener=function(t){this.sessionListeners.push(t)},t.prototype.startNewSession=function(t,e,r){return t&&this.endSession(t),this.newSession(e,r)},t.prototype.startNewSessionIfNeeded=function(t,e){var r=this._lastEventTime;return null===r?this.startNewSession(t,t,e):null!==this._currentSessionId&&e-r<this.sessionTimeoutMillis?(this.updateLastEventTime(e),this._currentSessionId):this.startNewSession(t,t,e)},t.prototype.updateLastEventTime=function(t){this._lastEventTime=t,this.storage.setItem(T,"".concat(t))},t.prototype.endSession=function(t){var e=this._currentSessionId,r=this._lastEventTime;null!==e&&null!==r&&this.sessionListeners.forEach((function(n){return n.onSessionEnded(e,t,r)}))},t.prototype.newSession=function(t,e){var r=function(t){return"".concat(t,".").concat(Xt().slice(0,8))}(e);return this.saveSession(r),this.updateLastEventTime(e),this.sessionListeners.forEach((function(n){n.onSessionStarted(r,t,e)})),r},t.prototype.saveSession=function(t){this._currentSessionId=t,this.storage.setItem(w,t)},t.prototype.loadSession=function(){this._currentSessionId=this.storage.getItem(w)},t.prototype.loadLastEventTime=function(){var t=this.storage.getItem(T);if(null!==t){var e=Number.parseFloat(t);e>0&&(this._lastEventTime=e)}},t.prototype.onUserUpdated=function(t,e,r){this.endSession(t),this.newSession(e,r)},t.EMPTY_SESSION_ID="0.ffffffff",t}(),N_=function(){function t(t,e){this.delegate=t,this.transform=e}return t.postfix=function(e,r){return new t(e,(function(t){return"".concat(t).concat(r)}))},t.prototype.getItem=function(t){return this.delegate.getItem(this.transform(t))},t.prototype.removeItem=function(t){this.delegate.removeItem(this.transform(t))},t.prototype.setItem=function(t,e){this.delegate.setItem(this.transform(t),e)},t}(),O_=function(){function t(t,e,r){void 0===r&&(r=4096);var n=this;this.delegate=t,this.listKey=e,this.encodedListCharLen=6,this.resolveMaxLength=function(t){var e=t-n.encodedListCharLen;return e<0?0:e},this.maxLength=this.resolveMaxLength(r)}return t.prototype.isEqualItem=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.prototype.getRemainListSize=function(){try{return this.maxLength-JSON.stringify(this.getList()).length}catch(t){return 0}},t.prototype.isAddableItem=function(t){try{return this.getRemainListSize()>JSON.stringify(t).length}catch(t){return!1}},t.prototype.getVictimIndex=function(t){var e=this.getRemainListSize();try{var r=JSON.stringify(t),n=this.getList(),i=0;return n.findIndex((function(t){return(i+=JSON.stringify(t).length)+e>=r.length}))}catch(t){return-1}},t.prototype.getList=function(){try{var t=this.delegate.getItem(this.listKey);if(!t)return[];var e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(t){return[]}},t.prototype.entries=function(){return this.getList().flatMap(Object.entries)},t.prototype.setItem=function(t,e){var r;try{this.removeItem(t);var n=this.getList(),i=((r={})[t]=e,r);if(!this.isAddableItem(i)){var o=this.getVictimIndex(i);if(o<0)return;n=n.slice(o+1)}var s=JSON.stringify(n.concat(i));this.delegate.setItem(this.listKey,s)}catch(t){}},t.prototype.getItem=function(t){var e=this,r=this.getList().find((function(r){return e.isEqualItem(r,t)}));if(r&&r[t])return r[t]},t.prototype.removeItem=function(t){var e=this,r=this.getList();try{var n=r.filter((function(r){return!e.isEqualItem(r,t)})),i=JSON.stringify(n);this.delegate.setItem(this.listKey,i)}catch(t){}},t.prototype.clear=function(){this.delegate.removeItem(this.listKey)},t}(),I_=function(){function t(t,e,r,n,i){this.core=t,this.userManager=e,this.userResolver=r,this.abOverrideStorage=n,this.ffOverrideStorage=i}return t.prototype.currentUser=function(){var t=this.userManager.currentUser;return this.userResolver.resolve(t)},t.prototype.getAbTestDecisions=function(){return this.core.experiments(this.currentUser()).entries()},t.prototype.getAbTestOverrides=function(){return this.abOverrideStorage.getAll()},t.prototype.setAbTestOverride=function(t,e){this.abOverrideStorage.set(t,e),this.increment("AB_TEST","set")},t.prototype.resetAbTestOverride=function(t){this.abOverrideStorage.remove(t),this.increment("AB_TEST","reset")},t.prototype.resetAllAbTestOverride=function(){this.abOverrideStorage.clear(),this.increment("AB_TEST","reset.all")},t.prototype.getFeatureFlagDecisions=function(){return this.core.featureFlags(this.currentUser()).entries()},t.prototype.getFeatureFlagOverrides=function(){return this.ffOverrideStorage.getAll()},t.prototype.setFeatureFlagOverride=function(t,e){this.ffOverrideStorage.set(t,e),this.increment("FEATURE_FLAG","set")},t.prototype.resetFeatureFlagOverride=function(t){this.ffOverrideStorage.remove(t),this.increment("FEATURE_FLAG","reset")},t.prototype.resetAllFeatureFlagOverride=function(){this.ffOverrideStorage.clear(),this.increment("FEATURE_FLAG","reset.all")},t.prototype.increment=function(t,e){fe.counter("experiment.manual.override",{"experiment.type":t,operation:e}).increment()},t}(),__=function(){function t(){}return t.serverFetch=function(t){return"".concat(t,"/api/v2/workspaces")},t.clientFetch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/w")},t.serverDispatch=function(t){return"".concat(t,"/api/v2/events")},t.clientDispatch=function(t){return"".concat(t,"/api/v2/w/events")},t.beaconDispatch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/events")},t}(),b_=function(t){function e(e){var r=t.call(this)||this;return r.core=e,r.handleTrackEventTrigger=function(t){if(Ue.isTrack(t)){var e=r.core.trackInAppMessage(t);if(e.value){var n=r.core.inAppMessage(e.value.key,t.user,t.timestamp);n.value&&r.emit("campaign",{message:n.value,timestamp:t.timestamp})}}},r.initialize(),r}return r(e,t),e.prototype.initialize=function(){this.core.eventProcessor.on("queue",this.handleTrackEventTrigger),this.core.workspaceFetcher.start()},e.prototype.destroy=function(){this.core.eventProcessor.off("queue",this.handleTrackEventTrigger)},e}(jO),A_=function(){function t(e,r,n,s,a){void 0===a&&(a={rendererScriptUrl:t.RENDERER_SCRIPT});var u=this;this.triggerManager=e,this.storage=r,this.expirationStorageKey=n,this.client=s,this.options=a,this.opening=!1,this.container=null,this.active=null,this.handleIAMEvent=function(e){if(e instanceof CustomEvent&&e.type===t.HACKLE_IAM_EVENT_TYPE){var r=e.detail;if(u.client.track(r),"$in_app_close"===r.key||"$in_app_hidden"===r.key||"$in_app_action"===r.key&&("CLOSE"===r.properties.action_type||"HIDDEN"===r.properties.action_type)){if("$in_app_hidden"===r.key||"$in_app_action"===r.key&&"HIDDEN"===r.properties.action_type){var n=t.HIDE_EXPIRATION;if("$in_app_action"===r.key&&"HIDDEN"===r.properties.action_type){var i=r.properties.action_value;if("number"==typeof i)n=i*t.HOUR_IN_MS;else if("string"==typeof i){var o=Number.parseInt(i,10);Number.isNaN(o)||(n=o*t.HOUR_IN_MS)}}u.markMessageHidden(r.properties.in_app_message_key,Date.now()+n)}u.destroyActive()}}},this.handleTriggerMessage=function(e){var r=e.message,n=e.timestamp;return i(u,void 0,void 0,(function(){var e,i,s,a,u;return o(this,(function(o){switch(o.label){case 0:if(this.active)return[2];if(this.opening)return[2];if(this.checkMessageHidden(r,n))return[2];this.opening=!0,e=null,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,t.waitForRendererScript(this.options.rendererScriptUrl)];case 2:return o.sent(),(i=this.addContainer()).style.display="none",i.classList.add("".concat(t.CONTAINER_CLASS_NAME,"--loading")),s=t.getBrowserLang(),a=r.messageContext.getMessageForLang(s)||r.messageContext.getDefaultMessage(),u=window.HackleIAMRenderer,[4,(e=new u.HackleIAMRenderer(i)).render({message:r.toJSON(),contextMessage:a})];case 3:return o.sent(),this.active={message:r,renderer:e},i.classList.remove("".concat(t.CONTAINER_CLASS_NAME,"--loading")),i.style.display="block",[3,5];case 4:return o.sent(),null==e||e.destroy(),this.destroyActive(),[3,5];case 5:return this.opening=!1,[2]}}))}))},this.initialize()}return t.createRendererScript=function(t){var e=document.createElement("script");return e.type="text/javascript",e.async=!0,e.src=t,e},t.waitForLoad=function(t){return new Promise((function(e,r){var n=function(){o(),e(t)},i=function(t){o(),r(t.message)},o=function(){t.removeEventListener("error",i),t.removeEventListener("load",n)};t.addEventListener("load",n),t.addEventListener("error",i)}))},t.waitForRendererScript=function(e){return i(this,void 0,void 0,(function(){var r;return o(this,(function(n){return window.HackleIAMRenderer?[2]:(r=t.createRendererScript(e),document.head.appendChild(r),[2,t.waitForLoad(r)])}))}))},t.getBrowserLang=function(){return(window.navigator.language||window.navigator.languages[0]).split("-")[0]},t.prototype.initialize=function(){this.addListeners()},t.prototype.destroy=function(){this.removeListeners(),this.destroyActive()},t.prototype.addListeners=function(){this.triggerManager.on("campaign",this.handleTriggerMessage),window.addEventListener(t.HACKLE_IAM_EVENT_TYPE,this.handleIAMEvent)},t.prototype.removeListeners=function(){this.triggerManager.off("campaign",this.handleTriggerMessage),window.removeEventListener(t.HACKLE_IAM_EVENT_TYPE,this.handleIAMEvent)},t.prototype.addContainer=function(){if(!this.container){var e=document.createElement("div");e.classList.add(t.CONTAINER_CLASS_NAME),this.container=e}return this.container.parentNode||document.body.appendChild(this.container),this.container},t.prototype.removeContainer=function(){var t;this.container&&(null===(t=this.container.parentNode)||void 0===t||t.removeChild(this.container),this.container=null)},t.prototype.destroyActive=function(){var t;null===(t=this.active)||void 0===t||t.renderer.destroy(),this.active=null,this.removeContainer()},t.prototype.markMessageHidden=function(t,e){this.storage.setItem("".concat(this.expirationStorageKey).concat(t),"".concat(e))},t.prototype.checkMessageHidden=function(t,e){var r=this.storage.getItem("".concat(this.expirationStorageKey).concat(t.key));if(r){var n=Number.parseInt(r,10);if(!Number.isNaN(n))return n>=e}return!1},t.HOUR_IN_MS=36e5,t.HIDE_EXPIRATION=24*t.HOUR_IN_MS,t.RENDERER_SCRIPT="https://static.hackle.io/sdk/iam-renderer/latest/iam-renderer.js",t.NAMESPACE="hackle-iam",t.HACKLE_IAM_EVENT_TYPE=t.NAMESPACE,t.CONTAINER_CLASS_NAME=t.NAMESPACE,t}(),R_=f.log,S_=null,M_={user:void 0,debug:!1,log_disabled:!1,auto_track_page_view:!0,pollingIntervalMillis:-1,exposureEventDedupIntervalMillis:-1,sessionTimeoutMillis:18e5,autoOpenDevTool:!1,sdkUrl:"https://client-sdk.hackle.io",eventUrl:"https://event.hackle.io",monitoringUrl:"https://monitoring.hackle.io",rendererScriptUrl:A_.RENDERER_SCRIPT,SDK_NAME_HEADER:"javascript-sdk_browser",SDK_VERSION_HEADER:"11.16.3"};function C_(t,e){var r,i,o,s,a,u=n(n({},M_),e);if(f.initCounter((function(t){return fe.counter("log",{level:t})})),u.log_disabled?f.setLogLevel(c.DISABLE):u.debug&&f.setLogLevel(c.DEBUG),R_.debug("sdkKey : "+t),t||R_.error("SDK Key must not be null"),S_)return R_.debug("use already exists hackleClient"),S_;var p=!1;"undefined"!=typeof window&&(p=window&&window.navigator&&window.navigator.sendBeacon&&!0)&&R_.debug("support sendBeacon API");var v=new Ve(t,b,{dispatchUrl:__.clientDispatch(u.eventUrl),beaconDispatchUrl:__.beaconDispatch(u.eventUrl,t),useBeacon:p,headers:(r={},r[h]=u.SDK_NAME_HEADER,r[d]=u.SDK_VERSION_HEADER,r)}),y=-1;void 0!==u.pollingIntervalMillis&&"number"==typeof u.pollingIntervalMillis&&u.pollingIntervalMillis>0&&(y=Math.max(u.pollingIntervalMillis,3e4));var m=new Ge(t,b,{fetchUrl:__.clientFetch(u.sdkUrl,t),updateInterval:y,headers:(i={},i[h]=u.SDK_NAME_HEADER,i[d]=u.SDK_VERSION_HEADER,i)}),g=-1;void 0!==u.exposureEventDedupIntervalMillis&&"number"==typeof u.exposureEventDedupIntervalMillis&&-1!==u.exposureEventDedupIntervalMillis&&(u.exposureEventDedupIntervalMillis<1e3||u.exposureEventDedupIntervalMillis>36e5?(R_.warn("Exposure event dedup interval is outside allowed range[1_000ms..3_600_000ms]. Setting to default value[no dedup]."),g=-1):g=u.exposureEventDedupIntervalMillis);var E=new m_(window.localStorage,"".concat("hackle-repository-storage","_").concat(t),100),w=new w_(N_.postfix(nr,"_".concat(t))),T=w.getUser(),N=u.user||null,O=new E_(w,ar(),T,N),I=new T_(u.sessionTimeoutMillis,N_.postfix(nr,"_".concat(t.slice(8))));O.addListener(I);var _=new KO(g),A=new BO(v,100,500,E,_,I,O),R=new nI(new O_(nr,"".concat("hackle-manual-override_ab","_").concat(t.slice(0,8)))),S=new nI(new O_(nr,"".concat("hackle-manual-override_ff","_").concat(t.slice(0,8)))),M=p_.create(m,A,[R,S]),C=new b_(M),x=new or(O),k=new I_(M,O,x,R,S),U=(null===(s=u.devTool)||void 0===s?void 0:s.userExplorer)&&"function"==typeof(null===(a=u.devTool)||void 0===a?void 0:a.userExplorer),P=u.devTool&&U?{manager:u.devTool,userExplorer:k}:void 0,D=new ke(M,x,I,O,P);new A_(C,window.localStorage,"hackle-iam-hide:",D,{rendererScriptUrl:u.rendererScriptUrl});var L=new HO(x,M);I.addListener(L),S_=D,u.autoOpenDevTool&&(u.devTool?D.showUserExplorer():R_.error("DevTool is not provided"));var F=function(){A.drainRepository()},V=new pe(u.monitoringUrl,6e4,b,((o={})[h]=u.SDK_NAME_HEADER,o[d]=u.SDK_VERSION_HEADER,o[l]=t,o),p);return document.addEventListener("visibilitychange",(function(){document.hidden||F()})),window.addEventListener("pageshow",F),window.addEventListener("onpagehide"in window?"pagehide":"unload",(function(){cr(),I.updateLastEventTime((new Date).getTime()),D.close(),fe.globalRegistry.close()})),fe.addRegistry(V),D.onReady((function(){!function(t,e,r){var n=e.currentUser;g_(t,n)?r.startNewSessionIfNeeded(n,Date.now()):r.startNewSession(t,n,Date.now())}(T,O,I),(new h_).install(M,x),function(t,e){if(!e.auto_track_page_view)return;function r(t){if("function"==typeof window.Event)return new Event(t);var e={bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}t.trackPageView();try{history.pushState=function(t){return function(){try{var e=t.apply(this,arguments);return window.dispatchEvent(r("locationchange")),e}catch(t){if(t instanceof Error)R_.error(t);else try{R_.error(t)}catch(t){}}}}(history.pushState),history.replaceState=function(t){return function(){try{var e=t.apply(this,arguments);return window.dispatchEvent(r("locationchange")),e}catch(t){if(t instanceof Error)R_.error(t);else try{R_.error(t)}catch(t){}}}}(history.replaceState),window.addEventListener("popstate",(function(){try{window.dispatchEvent(r("locationchange"))}catch(t){if(t instanceof Error)R_.error(t);else try{R_.error(t)}catch(t){}}})),window.addEventListener("locationchange",(function(){try{t.trackPageView()}catch(t){if(t instanceof Error)R_.error(t);else try{R_.error(t)}catch(t){}}}))}catch(t){if(t instanceof Error)R_.error(t);else try{R_.error(t)}catch(t){}}}(D,u)})),D}var x_={createInstance:C_,getUserId:ar,setUserId:ur,removeUserId:cr,Logger:f};t.Bucket=H,t.Container=et,t.ContainerGroup=rt,t.CoreVersion=ct,t.Decision=P,t.DecisionReason=V,t.EmptyHackleRemoteConfig=L,t.EmptyParameterConfig=F,t.EventType=K,t.Experiment=j,t.FeatureFlagDecision=D,t.IAM=Ot,t.IAMContext=Nt,t.IAMDateRange=gt,t.IAMEventTriggerRule=Et,t.IAMTargetContext=Tt,t.IAMTargetRuleOverride=wt,t.IdentifierType=z,t.IdentifiersBuilder=q,t.InAppMessageDecision=U,t.Logger=f,t.MATCH_OPERATORS=ht,t.MATCH_TYPES=pt,t.MATCH_VALUE_TYPES=lt,t.MetaVersion=ft,t.ParameterConfiguration=nt,t.PropertyOperations=Ce,t.PropertyOperationsBuilder=Me,t.RemoteConfigDecision=k,t.RemoteConfigParameter=it,t.RemoteConfigParameterValue=st,t.RemoteConfigTargetRule=ot,t.SEGMENT_TYPES=yt,t.Segment=tt,t.Slot=B,t.TARGET_ACTION_TYPES=dt,t.TARGET_KEY_TYPES=vt,t.Target=J,t.TargetAction=Q,t.TargetCondition=X,t.TargetKey=W,t.TargetMatch=$,t.TargetRule=Z,t.TargetingType=mt,t.Variation=G,t.Version=ut,t.createInstance=C_,t.default=x_,t.getUserId=ar,t.removeUserId=cr,t.sanitizeUser=Y,t.setUserId=ur,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=index.browser.umd.min.js.map
